function Ho(a,s){for(var c=0;c<s.length;c++){const f=s[c];if(typeof f!="string"&&!Array.isArray(f)){for(const h in f)if(h!=="default"&&!(h in a)){const d=Object.getOwnPropertyDescriptor(f,h);d&&Object.defineProperty(a,h,d.get?d:{enumerable:!0,get:()=>f[h]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))f(h);new MutationObserver(h=>{for(const d of h)if(d.type==="childList")for(const w of d.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&f(w)}).observe(document,{childList:!0,subtree:!0});function c(h){const d={};return h.integrity&&(d.integrity=h.integrity),h.referrerpolicy&&(d.referrerPolicy=h.referrerpolicy),h.crossorigin==="use-credentials"?d.credentials="include":h.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function f(h){if(h.ep)return;h.ep=!0;const d=c(h);fetch(h.href,d)}})();function _e(){}function Rs(a,s){for(const c in s)a[c]=s[c];return a}function Go(a){return a&&typeof a=="object"&&typeof a.then=="function"}function Os(a){return a()}function is(){return Object.create(null)}function Pt(a){a.forEach(Os)}function Zr(a){return typeof a=="function"}function Et(a,s){return a!=a?s==s:a!==s||a&&typeof a=="object"||typeof a=="function"}let Pr;function yi(a,s){return Pr||(Pr=document.createElement("a")),Pr.href=s,a===Pr.href}function Xo(a){return Object.keys(a).length===0}function Wo(a,...s){if(a==null)return _e;const c=a.subscribe(...s);return c.unsubscribe?()=>c.unsubscribe():c}function R(a,s){a.appendChild(s)}function ie(a,s,c){a.insertBefore(s,c||null)}function re(a){a.parentNode.removeChild(a)}function Bs(a,s){for(let c=0;c<a.length;c+=1)a[c]&&a[c].d(s)}function G(a){return document.createElement(a)}function zn(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function me(a){return document.createTextNode(a)}function le(){return me(" ")}function Ft(){return me("")}function Te(a,s,c,f){return a.addEventListener(s,c,f),()=>a.removeEventListener(s,c,f)}function D(a,s,c){c==null?a.removeAttribute(s):a.getAttribute(s)!==c&&a.setAttribute(s,c)}function Yo(a){return Array.from(a.childNodes)}function Je(a,s){s=""+s,a.wholeText!==s&&(a.data=s)}function Ze(a,s){a.value=s==null?"":s}function dr(a,s,c,f){c===null?a.style.removeProperty(s):a.style.setProperty(s,c,f?"important":"")}function Xr(a,s){for(let c=0;c<a.options.length;c+=1){const f=a.options[c];if(f.__value===s){f.selected=!0;return}}a.selectedIndex=-1}function Ms(a){const s=a.querySelector(":checked")||a.options[0];return s&&s.__value}function zo(a,s,{bubbles:c=!1,cancelable:f=!1}={}){const h=document.createEvent("CustomEvent");return h.initCustomEvent(a,c,f,s),h}let pr;function pn(a){pr=a}function br(){if(!pr)throw new Error("Function called outside component initialization");return pr}function er(a){br().$$.on_mount.push(a)}function jo(a){br().$$.after_update.push(a)}function Zo(a){br().$$.on_destroy.push(a)}function Ko(){const a=br();return(s,c,{cancelable:f=!1}={})=>{const h=a.$$.callbacks[s];if(h){const d=zo(s,c,{cancelable:f});return h.slice().forEach(w=>{w.call(a,d)}),!d.defaultPrevented}return!0}}function ss(a,s){const c=a.$$.callbacks[s.type];c&&c.slice().forEach(f=>f.call(this,s))}const gr=[],os=[],Hr=[],ls=[],Ds=Promise.resolve();let Si=!1;function vs(){Si||(Si=!0,Ds.then(Mi))}function qo(){return vs(),Ds}function mr(a){Hr.push(a)}const pi=new Set;let Fr=0;function Mi(){const a=pr;do{for(;Fr<gr.length;){const s=gr[Fr];Fr++,pn(s),Qo(s.$$)}for(pn(null),gr.length=0,Fr=0;os.length;)os.pop()();for(let s=0;s<Hr.length;s+=1){const c=Hr[s];pi.has(c)||(pi.add(c),c())}Hr.length=0}while(gr.length);for(;ls.length;)ls.pop()();Si=!1,pi.clear(),pn(a)}function Qo(a){if(a.fragment!==null){a.update(),Pt(a.before_update);const s=a.dirty;a.dirty=[-1],a.fragment&&a.fragment.p(a.ctx,s),a.after_update.forEach(mr)}}const Gr=new Set;let Dn;function vn(){Dn={r:0,c:[],p:Dn}}function kn(){Dn.r||Pt(Dn.c),Dn=Dn.p}function He(a,s){a&&a.i&&(Gr.delete(a),a.i(s))}function Ye(a,s,c,f){if(a&&a.o){if(Gr.has(a))return;Gr.add(a),Dn.c.push(()=>{Gr.delete(a),f&&(c&&a.d(1),f())}),a.o(s)}else f&&f()}function Er(a,s){const c=s.token={};function f(h,d,w,x){if(s.token!==c)return;s.resolved=x;let m=s.ctx;w!==void 0&&(m=m.slice(),m[w]=x);const C=h&&(s.current=h)(m);let _=!1;s.block&&(s.blocks?s.blocks.forEach((B,v)=>{v!==d&&B&&(vn(),Ye(B,1,1,()=>{s.blocks[v]===B&&(s.blocks[v]=null)}),kn())}):s.block.d(1),C.c(),He(C,1),C.m(s.mount(),s.anchor),_=!0),s.block=C,s.blocks&&(s.blocks[d]=C),_&&Mi()}if(Go(a)){const h=br();if(a.then(d=>{pn(h),f(s.then,1,s.value,d),pn(null)},d=>{if(pn(h),f(s.catch,2,s.error,d),pn(null),!s.hasCatch)throw d}),s.current!==s.pending)return f(s.pending,0),!0}else{if(s.current!==s.then)return f(s.then,1,s.value,a),!0;s.resolved=a}}function Di(a,s,c){const f=s.slice(),{resolved:h}=a;a.current===a.then&&(f[a.value]=h),a.current===a.catch&&(f[a.error]=h),a.block.p(f,c)}function ks(a,s){const c={},f={},h={$$scope:1};let d=a.length;for(;d--;){const w=a[d],x=s[d];if(x){for(const m in w)m in x||(f[m]=1);for(const m in x)h[m]||(c[m]=x[m],h[m]=1);a[d]=x}else for(const m in w)h[m]=1}for(const w in f)w in c||(c[w]=void 0);return c}function Ls(a){return typeof a=="object"&&a!==null?a:{}}function Rt(a){a&&a.c()}function Ct(a,s,c,f){const{fragment:h,on_mount:d,on_destroy:w,after_update:x}=a.$$;h&&h.m(s,c),f||mr(()=>{const m=d.map(Os).filter(Zr);w?w.push(...m):Pt(m),a.$$.on_mount=[]}),x.forEach(mr)}function bt(a,s){const c=a.$$;c.fragment!==null&&(Pt(c.on_destroy),c.fragment&&c.fragment.d(s),c.on_destroy=c.fragment=null,c.ctx=[])}function $o(a,s){a.$$.dirty[0]===-1&&(gr.push(a),vs(),a.$$.dirty.fill(0)),a.$$.dirty[s/31|0]|=1<<s%31}function It(a,s,c,f,h,d,w,x=[-1]){const m=pr;pn(a);const C=a.$$={fragment:null,ctx:null,props:d,update:_e,not_equal:h,bound:is(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(m?m.$$.context:[])),callbacks:is(),dirty:x,skip_bound:!1,root:s.target||m.$$.root};w&&w(C.root);let _=!1;if(C.ctx=c?c(a,s.props||{},(B,v,...P)=>{const M=P.length?P[0]:v;return C.ctx&&h(C.ctx[B],C.ctx[B]=M)&&(!C.skip_bound&&C.bound[B]&&C.bound[B](M),_&&$o(a,B)),v}):[],C.update(),_=!0,Pt(C.before_update),C.fragment=f?f(C.ctx):!1,s.target){if(s.hydrate){const B=Yo(s.target);C.fragment&&C.fragment.l(B),B.forEach(re)}else C.fragment&&C.fragment.c();s.intro&&He(a.$$.fragment),Ct(a,s.target,s.anchor,s.customElement),Mi()}pn(m)}class _t{$destroy(){bt(this,1),this.$destroy=_e}$on(s,c){const f=this.$$.callbacks[s]||(this.$$.callbacks[s]=[]);return f.push(c),()=>{const h=f.indexOf(c);h!==-1&&f.splice(h,1)}}$set(s){this.$$set&&!Xo(s)&&(this.$$.skip_bound=!0,this.$$set(s),this.$$.skip_bound=!1)}}const jn=[];function Ps(a,s){return{subscribe:Fs(a,s).subscribe}}function Fs(a,s=_e){let c;const f=new Set;function h(x){if(Et(a,x)&&(a=x,c)){const m=!jn.length;for(const C of f)C[1](),jn.push(C,a);if(m){for(let C=0;C<jn.length;C+=2)jn[C][0](jn[C+1]);jn.length=0}}}function d(x){h(x(a))}function w(x,m=_e){const C=[x,m];return f.add(C),f.size===1&&(c=s(h)||_e),x(a),()=>{f.delete(C),f.size===0&&(c(),c=null)}}return{set:h,update:d,subscribe:w}}function Us(a,s,c){const f=!Array.isArray(a),h=f?[a]:a,d=s.length<2;return Ps(c,w=>{let x=!1;const m=[];let C=0,_=_e;const B=()=>{if(C)return;_();const P=s(f?m[0]:m,w);d?w(P):_=Zr(P)?P:_e},v=h.map((P,M)=>Wo(P,F=>{m[M]=F,C&=~(1<<M),x&&B()},()=>{C|=1<<M}));return x=!0,B(),function(){Pt(v),_()}})}function Jo(a,s){if(a instanceof RegExp)return{keys:!1,pattern:a};var c,f,h,d,w=[],x="",m=a.split("/");for(m[0]||m.shift();h=m.shift();)c=h[0],c==="*"?(w.push("wild"),x+="/(.*)"):c===":"?(f=h.indexOf("?",1),d=h.indexOf(".",1),w.push(h.substring(1,~f?f:~d?d:h.length)),x+=!!~f&&!~d?"(?:/([^/]+?))?":"/([^/]+?)",~d&&(x+=(~f?"?":"")+"\\"+h.substring(d))):x+="/"+h;return{keys:w,pattern:new RegExp("^"+x+(s?"(?=$|/)":"/?$"),"i")}}function el(a){let s,c,f;const h=[a[2]];var d=a[0];function w(x){let m={};for(let C=0;C<h.length;C+=1)m=Rs(m,h[C]);return{props:m}}return d&&(s=new d(w()),s.$on("routeEvent",a[7])),{c(){s&&Rt(s.$$.fragment),c=Ft()},m(x,m){s&&Ct(s,x,m),ie(x,c,m),f=!0},p(x,m){const C=m&4?ks(h,[Ls(x[2])]):{};if(d!==(d=x[0])){if(s){vn();const _=s;Ye(_.$$.fragment,1,0,()=>{bt(_,1)}),kn()}d?(s=new d(w()),s.$on("routeEvent",x[7]),Rt(s.$$.fragment),He(s.$$.fragment,1),Ct(s,c.parentNode,c)):s=null}else d&&s.$set(C)},i(x){f||(s&&He(s.$$.fragment,x),f=!0)},o(x){s&&Ye(s.$$.fragment,x),f=!1},d(x){x&&re(c),s&&bt(s,x)}}}function tl(a){let s,c,f;const h=[{params:a[1]},a[2]];var d=a[0];function w(x){let m={};for(let C=0;C<h.length;C+=1)m=Rs(m,h[C]);return{props:m}}return d&&(s=new d(w()),s.$on("routeEvent",a[6])),{c(){s&&Rt(s.$$.fragment),c=Ft()},m(x,m){s&&Ct(s,x,m),ie(x,c,m),f=!0},p(x,m){const C=m&6?ks(h,[m&2&&{params:x[1]},m&4&&Ls(x[2])]):{};if(d!==(d=x[0])){if(s){vn();const _=s;Ye(_.$$.fragment,1,0,()=>{bt(_,1)}),kn()}d?(s=new d(w()),s.$on("routeEvent",x[6]),Rt(s.$$.fragment),He(s.$$.fragment,1),Ct(s,c.parentNode,c)):s=null}else d&&s.$set(C)},i(x){f||(s&&He(s.$$.fragment,x),f=!0)},o(x){s&&Ye(s.$$.fragment,x),f=!1},d(x){x&&re(c),s&&bt(s,x)}}}function nl(a){let s,c,f,h;const d=[tl,el],w=[];function x(m,C){return m[1]?0:1}return s=x(a),c=w[s]=d[s](a),{c(){c.c(),f=Ft()},m(m,C){w[s].m(m,C),ie(m,f,C),h=!0},p(m,[C]){let _=s;s=x(m),s===_?w[s].p(m,C):(vn(),Ye(w[_],1,1,()=>{w[_]=null}),kn(),c=w[s],c?c.p(m,C):(c=w[s]=d[s](m),c.c()),He(c,1),c.m(f.parentNode,f))},i(m){h||(He(c),h=!0)},o(m){Ye(c),h=!1},d(m){w[s].d(m),m&&re(f)}}}function as(){const a=window.location.href.indexOf("#/");let s=a>-1?window.location.href.substr(a+1):"/";const c=s.indexOf("?");let f="";return c>-1&&(f=s.substr(c+1),s=s.substr(0,c)),{location:s,querystring:f}}const vi=Ps(null,function(s){s(as());const c=()=>{s(as())};return window.addEventListener("hashchange",c,!1),function(){window.removeEventListener("hashchange",c,!1)}});Us(vi,a=>a.location);Us(vi,a=>a.querystring);const cs=Fs(void 0);function rl(a){a?window.scrollTo(a.__svelte_spa_router_scrollX,a.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function il(a,s,c){let{routes:f={}}=s,{prefix:h=""}=s,{restoreScrollState:d=!1}=s;class w{constructor($,U){if(!U||typeof U!="function"&&(typeof U!="object"||U._sveltesparouter!==!0))throw Error("Invalid component object");if(!$||typeof $=="string"&&($.length<1||$.charAt(0)!="/"&&$.charAt(0)!="*")||typeof $=="object"&&!($ instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:se,keys:k}=Jo($);this.path=$,typeof U=="object"&&U._sveltesparouter===!0?(this.component=U.component,this.conditions=U.conditions||[],this.userData=U.userData,this.props=U.props||{}):(this.component=()=>Promise.resolve(U),this.conditions=[],this.props={}),this._pattern=se,this._keys=k}match($){if(h){if(typeof h=="string")if($.startsWith(h))$=$.substr(h.length)||"/";else return null;else if(h instanceof RegExp){const xe=$.match(h);if(xe&&xe[0])$=$.substr(xe[0].length)||"/";else return null}}const U=this._pattern.exec($);if(U===null)return null;if(this._keys===!1)return U;const se={};let k=0;for(;k<this._keys.length;){try{se[this._keys[k]]=decodeURIComponent(U[k+1]||"")||null}catch{se[this._keys[k]]=null}k++}return se}async checkConditions($){for(let U=0;U<this.conditions.length;U++)if(!await this.conditions[U]($))return!1;return!0}}const x=[];f instanceof Map?f.forEach((Q,$)=>{x.push(new w($,Q))}):Object.keys(f).forEach(Q=>{x.push(new w(Q,f[Q]))});let m=null,C=null,_={};const B=Ko();async function v(Q,$){await qo(),B(Q,$)}let P=null,M=null;d&&(M=Q=>{Q.state&&(Q.state.__svelte_spa_router_scrollY||Q.state.__svelte_spa_router_scrollX)?P=Q.state:P=null},window.addEventListener("popstate",M),jo(()=>{rl(P)}));let F=null,W=null;const z=vi.subscribe(async Q=>{F=Q;let $=0;for(;$<x.length;){const U=x[$].match(Q.location);if(!U){$++;continue}const se={route:x[$].path,location:Q.location,querystring:Q.querystring,userData:x[$].userData,params:U&&typeof U=="object"&&Object.keys(U).length?U:null};if(!await x[$].checkConditions(se)){c(0,m=null),W=null,v("conditionsFailed",se);return}v("routeLoading",Object.assign({},se));const k=x[$].component;if(W!=k){k.loading?(c(0,m=k.loading),W=k,c(1,C=k.loadingParams),c(2,_={}),v("routeLoaded",Object.assign({},se,{component:m,name:m.name,params:C}))):(c(0,m=null),W=null);const xe=await k();if(Q!=F)return;c(0,m=xe&&xe.default||xe),W=k}U&&typeof U=="object"&&Object.keys(U).length?c(1,C=U):c(1,C=null),c(2,_=x[$].props),v("routeLoaded",Object.assign({},se,{component:m,name:m.name,params:C})).then(()=>{cs.set(C)});return}c(0,m=null),W=null,cs.set(void 0)});Zo(()=>{z(),M&&window.removeEventListener("popstate",M)});function J(Q){ss.call(this,a,Q)}function Y(Q){ss.call(this,a,Q)}return a.$$set=Q=>{"routes"in Q&&c(3,f=Q.routes),"prefix"in Q&&c(4,h=Q.prefix),"restoreScrollState"in Q&&c(5,d=Q.restoreScrollState)},a.$$.update=()=>{a.$$.dirty&32&&(history.scrollRestoration=d?"manual":"auto")},[m,C,_,f,h,d,J,Y]}class sl extends _t{constructor(s){super(),It(this,s,il,nl,Et,{routes:3,prefix:4,restoreScrollState:5})}}function us(a,s,c){const f=a.slice();return f[33]=s[c],f}function fs(a){let s,c,f,h,d=Object.keys(localStorage).filter(xs),w=[];for(let x=0;x<d.length;x+=1)w[x]=hs(us(a,d,x));return{c(){s=G("select"),c=G("option"),c.textContent="new user";for(let x=0;x<w.length;x+=1)w[x].c();c.__value="",c.value=c.__value,D(s,"class","row-start-4 col-start-1 col-span-8 w-3/4 h-8 rounded-xl bg-bitcoin"),a[7]===void 0&&mr(()=>a[16].call(s))},m(x,m){ie(x,s,m),R(s,c);for(let C=0;C<w.length;C+=1)w[C].m(s,null);Xr(s,a[7]),f||(h=Te(s,"change",a[16]),f=!0)},p(x,m){if(m&0){d=Object.keys(localStorage).filter(xs);let C;for(C=0;C<d.length;C+=1){const _=us(x,d,C);w[C]?w[C].p(_,m):(w[C]=hs(_),w[C].c(),w[C].m(s,null))}for(;C<w.length;C+=1)w[C].d(1);w.length=d.length}m[0]&128&&Xr(s,x[7])},d(x){x&&re(s),Bs(w,x),f=!1,h()}}}function hs(a){let s,c=JSON.parse(localStorage.getItem(a[33])).title+"",f,h,d=JSON.parse(localStorage.getItem(a[33])).data.wallets[0].adminkey+"",w;return{c(){s=G("option"),f=me(c),h=me(" - "),w=me(d),s.__value=JSON.parse(localStorage.getItem(a[33])).data.wallets[0].adminkey,s.value=s.__value},m(x,m){ie(x,s,m),R(s,f),R(s,h),R(s,w)},p:_e,d(x){x&&re(s)}}}function ds(a){let s,c,f;return{c(){s=G("input"),D(s,"placeholder","lnbits server url"),D(s,"class","row-start-4 col-span-8 w-3/4 h-16 rounded-xl")},m(h,d){ie(h,s,d),Ze(s,a[1]),c||(f=Te(s,"input",a[17]),c=!0)},p(h,d){d[0]&2&&s.value!==h[1]&&Ze(s,h[1])},d(h){h&&re(s),c=!1,f()}}}function ol(a){let s,c,f;return{c(){s=G("input"),D(s,"placeholder","max comment length"),D(s,"class","row-start-7 col-span-8 w-3/4 h-16 rounded-xl")},m(h,d){ie(h,s,d),Ze(s,a[8]),c||(f=Te(s,"input",a[23]),c=!0)},p(h,d){d[0]&256&&s.value!==h[8]&&Ze(s,h[8])},d(h){h&&re(s),c=!1,f()}}}function ll(a){let s,c,f,h,d;return{c(){s=G("input"),c=le(),f=G("input"),D(s,"placeholder","uses"),D(s,"class","row-start-7 col-span-4 w-3/4 h-16 rounded-xl"),D(f,"placeholder","wait time"),D(f,"class","row-start-7 col-span-4 w-3/4 h-16 rounded-xl")},m(w,x){ie(w,s,x),Ze(s,a[5]),ie(w,c,x),ie(w,f,x),Ze(f,a[6]),h||(d=[Te(s,"input",a[21]),Te(f,"input",a[22])],h=!0)},p(w,x){x[0]&32&&s.value!==w[5]&&Ze(s,w[5]),x[0]&64&&f.value!==w[6]&&Ze(f,w[6])},d(w){w&&re(s),w&&re(c),w&&re(f),h=!1,Pt(d)}}}function gs(a){let s,c,f;return{c(){s=G("input"),D(s,"placeholder","API key"),D(s,"class","row-start-8 col-span-8 w-3/4 h-16 rounded-xl")},m(h,d){ie(h,s,d),Ze(s,a[7]),c||(f=Te(s,"input",a[24]),c=!0)},p(h,d){d[0]&128&&s.value!==h[7]&&Ze(s,h[7])},d(h){h&&re(s),c=!1,f()}}}function al(a){let s,c,f;return{c(){s=G("button"),s.textContent="DONE",D(s,"class","row-start-9 col-span-8 w-full h-full bg-bitcoin")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[30]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function cl(a){let s,c,f;return{c(){s=G("button"),s.textContent="DONE",D(s,"class","row-start-9 col-span-8 w-full h-full bg-bitcoin")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[29]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function ul(a){let s;function c(d,w){return d[7]?dl:hl}let f=c(a),h=f(a);return{c(){h.c(),s=Ft()},m(d,w){h.m(d,w),ie(d,s,w)},p(d,w){f===(f=c(d))&&h?h.p(d,w):(h.d(1),h=f(d),h&&(h.c(),h.m(s.parentNode,s)))},d(d){h.d(d),d&&re(s)}}}function fl(a){let s;function c(d,w){return d[0].lnurl==="lnurlw"?xl:gl}let f=c(a),h=f(a);return{c(){h.c(),s=Ft()},m(d,w){h.m(d,w),ie(d,s,w)},p(d,w){f===(f=c(d))&&h?h.p(d,w):(h.d(1),h=f(d),h&&(h.c(),h.m(s.parentNode,s)))},d(d){h.d(d),d&&re(s)}}}function hl(a){let s,c,f;return{c(){s=G("button"),s.textContent="NEXT",D(s,"class","row-start-9 col-span-8 w-full h-full bg-bitcoin")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[28]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function dl(a){let s,c,f;return{c(){s=G("button"),s.textContent="NEXT",D(s,"class","row-start-9 col-span-8 w-full h-full bg-bitcoin")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[27]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function gl(a){let s,c,f;return{c(){s=G("button"),s.textContent="DONE",D(s,"class","row-start-9 col-span-8 w-full h-full bg-bitcoin")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[26]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function xl(a){let s,c,f;return{c(){s=G("button"),s.textContent="NEXT",D(s,"class","row-start-9 col-span-8 w-full h-full bg-bitcoin")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[25]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function wl(a){let s,c,f,h,d,w,x,m,C,_,B,v,P,M,F,W,z,J,Y,Q,$,U,se,k,xe,pe,ae=a[0].where==="trusted"&&fs(a),ne=a[0].where==="self"&&ds(a);function Ae(ye,he){return ye[0].lnurl==="lnurlw"?ll:ol}let q=Ae(a),Ne=q(a),oe=a[0].where==="self"&&gs(a);function De(ye,he){return ye[0].where==="self"?fl:ye[0].lnurl==="lnurlw"?ul:ye[7]?cl:al}let et=De(a),ze=et(a);return{c(){s=G("main"),c=G("div"),f=G("a"),f.innerHTML='<img alt="back" src="paste.svg" class="row-start-1 col-start-1 w-8 h-8 rotate-90"/>',h=le(),d=G("div"),w=G("button"),w.textContent="TRUSTED",x=le(),m=G("button"),m.textContent="SELF HOSTED",C=le(),_=G("div"),B=G("button"),B.textContent="LNURLW",v=le(),P=G("button"),P.textContent="LNURLP",M=le(),ae&&ae.c(),F=le(),ne&&ne.c(),W=le(),z=G("input"),J=le(),Y=G("input"),Q=le(),$=G("input"),U=le(),Ne.c(),se=le(),oe&&oe.c(),k=le(),ze.c(),D(f,"href","/#/home"),D(w,"id","trusted"),D(w,"class","bg-bitcoin w-1/2 rounded-l-xl h-12 float-left"),D(m,"id","hosted"),D(m,"class","bg-bitcoin w-1/2 rounded-r-xl h-12 opacity-60"),D(d,"class","col-start-1 col-span-8 row-start-2 w-3/4 text-center"),D(B,"id","lnurlw"),D(B,"class","bg-bitcoin w-1/2 rounded-l-xl h-12 float-left"),D(P,"id","lnurlp"),D(P,"class","bg-bitcoin w-1/2 rounded-r-xl h-12 opacity-60"),D(_,"class","col-start-1 col-span-8 row-start-3 w-3/4 text-center"),D(z,"placeholder","title / description"),D(z,"class","row-start-5 col-span-8 w-3/4 h-16 rounded-xl"),D(Y,"placeholder","min"),D(Y,"class","row-start-6 col-span-4 w-3/4 h-16 rounded-xl"),D($,"placeholder","max"),D($,"class","row-start-6 col-span-4 w-3/4 h-16 rounded-xl"),D(c,"class","grid grid-cols-8 grid-rows-9 justify-center justify-items-center items-center w-full h-full"),D(s,"class","w-screen")},m(ye,he){ie(ye,s,he),R(s,c),R(c,f),R(c,h),R(c,d),R(d,w),R(d,x),R(d,m),R(c,C),R(c,_),R(_,B),R(_,v),R(_,P),R(c,M),ae&&ae.m(c,null),R(c,F),ne&&ne.m(c,null),R(c,W),R(c,z),Ze(z,a[2]),R(c,J),R(c,Y),Ze(Y,a[3]),R(c,Q),R(c,$),Ze($,a[4]),R(c,U),Ne.m(c,null),R(c,se),oe&&oe.m(c,null),R(c,k),ze.m(c,null),xe||(pe=[Te(w,"click",a[9]),Te(m,"click",a[10]),Te(B,"click",a[11]),Te(P,"click",a[12]),Te(z,"input",a[18]),Te(Y,"input",a[19]),Te($,"input",a[20])],xe=!0)},p(ye,he){ye[0].where==="trusted"?ae?ae.p(ye,he):(ae=fs(ye),ae.c(),ae.m(c,F)):ae&&(ae.d(1),ae=null),ye[0].where==="self"?ne?ne.p(ye,he):(ne=ds(ye),ne.c(),ne.m(c,W)):ne&&(ne.d(1),ne=null),he[0]&4&&z.value!==ye[2]&&Ze(z,ye[2]),he[0]&8&&Y.value!==ye[3]&&Ze(Y,ye[3]),he[0]&16&&$.value!==ye[4]&&Ze($,ye[4]),q===(q=Ae(ye))&&Ne?Ne.p(ye,he):(Ne.d(1),Ne=q(ye),Ne&&(Ne.c(),Ne.m(c,se))),ye[0].where==="self"?oe?oe.p(ye,he):(oe=gs(ye),oe.c(),oe.m(c,k)):oe&&(oe.d(1),oe=null),et===(et=De(ye))&&ze?ze.p(ye,he):(ze.d(1),ze=et(ye),ze&&(ze.c(),ze.m(c,null)))},i:_e,o:_e,d(ye){ye&&re(s),ae&&ae.d(),ne&&ne.d(),Ne.d(),oe&&oe.d(),ze.d(),xe=!1,Pt(pe)}}}const pl="https://qnjqpt.deta.dev/user",ml="https://legend.lnbits.com",xs=a=>a.startsWith("user");function El(a,s,c){let{params:f={where:"trusted",lnurl:"lnurlw"}}=s;const h=()=>{document.getElementById("trusted").style.opacity="1",document.getElementById("hosted").style.opacity="0.6",window.location.href=`/#/new/trusted/${f.lnurl}`},d=()=>{document.getElementById("trusted").style.opacity="0.6",document.getElementById("hosted").style.opacity="1",window.location.href=`/#/new/self/${f.lnurl}`},w=()=>{document.getElementById("lnurlw").style.opacity="1",document.getElementById("lnurlp").style.opacity="0.6",window.location.href=`/#/new/${f.where}/lnurlw`},x=()=>{document.getElementById("lnurlp").style.opacity="1",document.getElementById("lnurlw").style.opacity="0.6",window.location.href=`/#/new/${f.where}/lnurlp`};let m,C,_,B,v,P,M,F;f.where==="trusted"&&(m=ml);let W="";const z=async()=>{const ye=await(await fetch(pl,{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({wallet_name:C,user_name:C})})).json();W=JSON.stringify({data:ye,server:m,title:C}),c(7,M=ye.wallets[0].adminkey),f.lnurl==="lnurlw"?await J(!0):await Q(!0)},J=async ye=>{const he=await(await fetch(`${m}/api/v1/payments`,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":M},body:JSON.stringify({out:!1,amount:B*v+5,memo:"lnurl",unit:"sat"})})).json();await Y(he.payment_request,B*v+5,ye)},Y=async(ye,he,fe)=>{const we=await(await fetch(`${m}/withdraw/api/v1/links`,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":M},body:JSON.stringify({title:encodeURIComponent(C),min_withdrawable:_,max_withdrawable:B,uses:v,wait_time:P,is_unique:!1})})).json();ye?(localStorage.setItem(`lnrecord${encodeURIComponent(we.lnurl)}`,we.lnurl),localStorage.setItem(`info${encodeURIComponent(we.lnurl)}`,JSON.stringify({data:we,key:M,invoice:ye,title:C,server:m,type:"lnurlw",prefix:"lnurlw://"})),f.where==="trusted"&&fe&&localStorage.setItem(`user${encodeURIComponent(we.lnurl)}`,W),document.location.href=`/#/payment/${encodeURIComponent(ye)}/${he}/${encodeURIComponent(we.lnurl)}`):window.history.back()},Q=async ye=>{const he=await(await fetch(`${m}/lnurlp/api/v1/links`,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Key":M},body:JSON.stringify({description:encodeURIComponent(C),min:_,max:B,wait_time:P,comment_chars:F})})).json();he.lnurl?(localStorage.setItem(`lnrecord${encodeURIComponent(he.lnurl)}`,he.lnurl),localStorage.setItem(`info${encodeURIComponent(he.lnurl)}`,JSON.stringify({data:he,key:M,title:C,server:m,type:"lnurlp",prefix:"lnurlp://"})),f.where==="trusted"&&ye&&localStorage.setItem(`user${encodeURIComponent(he.lnurl)}`,W),document.location.href=`/#/manage/${encodeURIComponent(he.lnurl)}`):window.history.back()};function $(){M=Ms(this),c(7,M)}function U(){m=this.value,c(1,m)}function se(){C=this.value,c(2,C)}function k(){_=this.value,c(3,_)}function xe(){B=this.value,c(4,B)}function pe(){v=this.value,c(5,v)}function ae(){P=this.value,c(6,P)}function ne(){F=this.value,c(8,F)}function Ae(){M=this.value,c(7,M)}const q=()=>{m&&C&&_&&B&&v&&P&&M&&J()},Ne=()=>{m&&C&&_&&B&&F&&M&&Q()},oe=()=>{m&&C&&_&&B&&v&&P&&J(!1)},De=()=>{m&&C&&_&&B&&v&&P&&z()},et=()=>{m&&C&&_&&B&&F&&Q(!1)},ze=()=>{m&&C&&_&&B&&F&&z()};return a.$$set=ye=>{"params"in ye&&c(0,f=ye.params)},[f,m,C,_,B,v,P,M,F,h,d,w,x,z,J,Q,$,U,se,k,xe,pe,ae,ne,Ae,q,Ne,oe,De,et,ze]}class Al extends _t{constructor(s){super(),It(this,s,El,wl,Et,{params:0},null,[-1,-1])}}function Cl(a){let s,c,f,h,d,w,x,m,C,_,B,v,P,M,F,W;return{c(){s=G("div"),c=G("button"),c.innerHTML='<img alt="copy" src="copy.svg"/>',f=le(),h=G("button"),h.innerHTML='<img alt="share" src="share.svg"/>',d=le(),w=G("a"),x=G("img"),_=le(),B=G("a"),v=G("img"),D(c,"class","w-6"),D(h,"class","w-6"),D(x,"alt","qr"),yi(x.src,m="qr.svg")||D(x,"src",m),D(w,"href",C="/#/qrout/"+encodeURIComponent(a[0])),D(w,"class","w-6"),D(v,"alt","nfc"),yi(v.src,P="nfc.svg")||D(v,"src",P),D(B,"href",M="/#/nfcout/"+encodeURIComponent(a[0])),D(B,"class","w-6"),D(s,"class","bg-none inline-grid grid-cols-4 w-full h-full gap-4 items-center justify-items-center")},m(z,J){ie(z,s,J),R(s,c),R(s,f),R(s,h),R(s,d),R(s,w),R(w,x),R(s,_),R(s,B),R(B,v),F||(W=[Te(c,"click",a[1]),Te(h,"click",a[2])],F=!0)},p(z,[J]){J&1&&C!==(C="/#/qrout/"+encodeURIComponent(z[0]))&&D(w,"href",C),J&1&&M!==(M="/#/nfcout/"+encodeURIComponent(z[0]))&&D(B,"href",M)},i:_e,o:_e,d(z){z&&re(s),F=!1,Pt(W)}}}function bl(a,s,c){let{value:f}=s;const h=()=>{navigator.clipboard.writeText(decodeURIComponent(f))},d=()=>{navigator.canShare&&navigator.share({title:"Lightning record",text:decodeURIComponent(f)})};return a.$$set=w=>{"value"in w&&c(0,f=w.value)},[f,h,d]}class Ir extends _t{constructor(s){super(),It(this,s,bl,Cl,Et,{value:0})}}var fr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Il(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});Ar.bech32m=Lt=Ar.bech32=void 0;const Wr="qpzry9x8gf2tvdw0s3jn54khce6mua7l",Vs={};for(let a=0;a<Wr.length;a++){const s=Wr.charAt(a);Vs[s]=a}function Kn(a){const s=a>>25;return(a&33554431)<<5^-(s>>0&1)&996825010^-(s>>1&1)&642813549^-(s>>2&1)&513874426^-(s>>3&1)&1027748829^-(s>>4&1)&705979059}function ws(a){let s=1;for(let c=0;c<a.length;++c){const f=a.charCodeAt(c);if(f<33||f>126)return"Invalid prefix ("+a+")";s=Kn(s)^f>>5}s=Kn(s);for(let c=0;c<a.length;++c){const f=a.charCodeAt(c);s=Kn(s)^f&31}return s}function ki(a,s,c,f){let h=0,d=0;const w=(1<<c)-1,x=[];for(let m=0;m<a.length;++m)for(h=h<<s|a[m],d+=s;d>=c;)d-=c,x.push(h>>d&w);if(f)d>0&&x.push(h<<c-d&w);else{if(d>=s)return"Excess padding";if(h<<c-d&w)return"Non-zero padding"}return x}function _l(a){return ki(a,8,5,!0)}function yl(a){const s=ki(a,5,8,!1);if(Array.isArray(s))return s}function Sl(a){const s=ki(a,5,8,!1);if(Array.isArray(s))return s;throw new Error(s)}function Hs(a){let s;a==="bech32"?s=1:s=734539939;function c(w,x,m){if(m=m||90,w.length+7+x.length>m)throw new TypeError("Exceeds length limit");w=w.toLowerCase();let C=ws(w);if(typeof C=="string")throw new Error(C);let _=w+"1";for(let B=0;B<x.length;++B){const v=x[B];if(v>>5!==0)throw new Error("Non 5-bit word");C=Kn(C)^v,_+=Wr.charAt(v)}for(let B=0;B<6;++B)C=Kn(C);C^=s;for(let B=0;B<6;++B){const v=C>>(5-B)*5&31;_+=Wr.charAt(v)}return _}function f(w,x){if(x=x||90,w.length<8)return w+" too short";if(w.length>x)return"Exceeds length limit";const m=w.toLowerCase(),C=w.toUpperCase();if(w!==m&&w!==C)return"Mixed-case string "+w;w=m;const _=w.lastIndexOf("1");if(_===-1)return"No separator character for "+w;if(_===0)return"Missing prefix for "+w;const B=w.slice(0,_),v=w.slice(_+1);if(v.length<6)return"Data too short";let P=ws(B);if(typeof P=="string")return P;const M=[];for(let F=0;F<v.length;++F){const W=v.charAt(F),z=Vs[W];if(z===void 0)return"Unknown character "+W;P=Kn(P)^z,!(F+6>=v.length)&&M.push(z)}return P!==s?"Invalid checksum for "+w:{prefix:B,words:M}}function h(w,x){const m=f(w,x);if(typeof m=="object")return m}function d(w,x){const m=f(w,x);if(typeof m=="object")return m;throw new Error(m)}return{decodeUnsafe:h,decode:d,encode:c,toWords:_l,fromWordsUnsafe:yl,fromWords:Sl}}var Lt=Ar.bech32=Hs("bech32");Ar.bech32m=Hs("bech32m");var _r={},Kr={};Kr.byteLength=Rl;Kr.toByteArray=Bl;Kr.fromByteArray=vl;var dn=[],rn=[],Tl=typeof Uint8Array<"u"?Uint8Array:Array,mi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Zn=0,Nl=mi.length;Zn<Nl;++Zn)dn[Zn]=mi[Zn],rn[mi.charCodeAt(Zn)]=Zn;rn["-".charCodeAt(0)]=62;rn["_".charCodeAt(0)]=63;function Gs(a){var s=a.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");c===-1&&(c=s);var f=c===s?0:4-c%4;return[c,f]}function Rl(a){var s=Gs(a),c=s[0],f=s[1];return(c+f)*3/4-f}function Ol(a,s,c){return(s+c)*3/4-c}function Bl(a){var s,c=Gs(a),f=c[0],h=c[1],d=new Tl(Ol(a,f,h)),w=0,x=h>0?f-4:f,m;for(m=0;m<x;m+=4)s=rn[a.charCodeAt(m)]<<18|rn[a.charCodeAt(m+1)]<<12|rn[a.charCodeAt(m+2)]<<6|rn[a.charCodeAt(m+3)],d[w++]=s>>16&255,d[w++]=s>>8&255,d[w++]=s&255;return h===2&&(s=rn[a.charCodeAt(m)]<<2|rn[a.charCodeAt(m+1)]>>4,d[w++]=s&255),h===1&&(s=rn[a.charCodeAt(m)]<<10|rn[a.charCodeAt(m+1)]<<4|rn[a.charCodeAt(m+2)]>>2,d[w++]=s>>8&255,d[w++]=s&255),d}function Ml(a){return dn[a>>18&63]+dn[a>>12&63]+dn[a>>6&63]+dn[a&63]}function Dl(a,s,c){for(var f,h=[],d=s;d<c;d+=3)f=(a[d]<<16&16711680)+(a[d+1]<<8&65280)+(a[d+2]&255),h.push(Ml(f));return h.join("")}function vl(a){for(var s,c=a.length,f=c%3,h=[],d=16383,w=0,x=c-f;w<x;w+=d)h.push(Dl(a,w,w+d>x?x:w+d));return f===1?(s=a[c-1],h.push(dn[s>>2]+dn[s<<4&63]+"==")):f===2&&(s=(a[c-2]<<8)+a[c-1],h.push(dn[s>>10]+dn[s>>4&63]+dn[s<<2&63]+"=")),h.join("")}var Li={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Li.read=function(a,s,c,f,h){var d,w,x=h*8-f-1,m=(1<<x)-1,C=m>>1,_=-7,B=c?h-1:0,v=c?-1:1,P=a[s+B];for(B+=v,d=P&(1<<-_)-1,P>>=-_,_+=x;_>0;d=d*256+a[s+B],B+=v,_-=8);for(w=d&(1<<-_)-1,d>>=-_,_+=f;_>0;w=w*256+a[s+B],B+=v,_-=8);if(d===0)d=1-C;else{if(d===m)return w?NaN:(P?-1:1)*(1/0);w=w+Math.pow(2,f),d=d-C}return(P?-1:1)*w*Math.pow(2,d-f)};Li.write=function(a,s,c,f,h,d){var w,x,m,C=d*8-h-1,_=(1<<C)-1,B=_>>1,v=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=f?0:d-1,M=f?1:-1,F=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(x=isNaN(s)?1:0,w=_):(w=Math.floor(Math.log(s)/Math.LN2),s*(m=Math.pow(2,-w))<1&&(w--,m*=2),w+B>=1?s+=v/m:s+=v*Math.pow(2,1-B),s*m>=2&&(w++,m/=2),w+B>=_?(x=0,w=_):w+B>=1?(x=(s*m-1)*Math.pow(2,h),w=w+B):(x=s*Math.pow(2,B-1)*Math.pow(2,h),w=0));h>=8;a[c+P]=x&255,P+=M,x/=256,h-=8);for(w=w<<h|x,C+=h;C>0;a[c+P]=w&255,P+=M,w/=256,C-=8);a[c+P-M]|=F*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(a){const s=Kr,c=Li,f=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;a.Buffer=x,a.SlowBuffer=J,a.INSPECT_MAX_BYTES=50;const h=2147483647;a.kMaxLength=h,x.TYPED_ARRAY_SUPPORT=d(),!x.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function d(){try{const S=new Uint8Array(1),p={foo:function(){return 42}};return Object.setPrototypeOf(p,Uint8Array.prototype),Object.setPrototypeOf(S,p),S.foo()===42}catch{return!1}}Object.defineProperty(x.prototype,"parent",{enumerable:!0,get:function(){if(!!x.isBuffer(this))return this.buffer}}),Object.defineProperty(x.prototype,"offset",{enumerable:!0,get:function(){if(!!x.isBuffer(this))return this.byteOffset}});function w(S){if(S>h)throw new RangeError('The value "'+S+'" is invalid for option "size"');const p=new Uint8Array(S);return Object.setPrototypeOf(p,x.prototype),p}function x(S,p,E){if(typeof S=="number"){if(typeof p=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return B(S)}return m(S,p,E)}x.poolSize=8192;function m(S,p,E){if(typeof S=="string")return v(S,p);if(ArrayBuffer.isView(S))return M(S);if(S==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof S);if(jt(S,ArrayBuffer)||S&&jt(S.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(jt(S,SharedArrayBuffer)||S&&jt(S.buffer,SharedArrayBuffer)))return F(S,p,E);if(typeof S=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const O=S.valueOf&&S.valueOf();if(O!=null&&O!==S)return x.from(O,p,E);const X=W(S);if(X)return X;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof S[Symbol.toPrimitive]=="function")return x.from(S[Symbol.toPrimitive]("string"),p,E);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof S)}x.from=function(S,p,E){return m(S,p,E)},Object.setPrototypeOf(x.prototype,Uint8Array.prototype),Object.setPrototypeOf(x,Uint8Array);function C(S){if(typeof S!="number")throw new TypeError('"size" argument must be of type number');if(S<0)throw new RangeError('The value "'+S+'" is invalid for option "size"')}function _(S,p,E){return C(S),S<=0?w(S):p!==void 0?typeof E=="string"?w(S).fill(p,E):w(S).fill(p):w(S)}x.alloc=function(S,p,E){return _(S,p,E)};function B(S){return C(S),w(S<0?0:z(S)|0)}x.allocUnsafe=function(S){return B(S)},x.allocUnsafeSlow=function(S){return B(S)};function v(S,p){if((typeof p!="string"||p==="")&&(p="utf8"),!x.isEncoding(p))throw new TypeError("Unknown encoding: "+p);const E=Y(S,p)|0;let O=w(E);const X=O.write(S,p);return X!==E&&(O=O.slice(0,X)),O}function P(S){const p=S.length<0?0:z(S.length)|0,E=w(p);for(let O=0;O<p;O+=1)E[O]=S[O]&255;return E}function M(S){if(jt(S,Uint8Array)){const p=new Uint8Array(S);return F(p.buffer,p.byteOffset,p.byteLength)}return P(S)}function F(S,p,E){if(p<0||S.byteLength<p)throw new RangeError('"offset" is outside of buffer bounds');if(S.byteLength<p+(E||0))throw new RangeError('"length" is outside of buffer bounds');let O;return p===void 0&&E===void 0?O=new Uint8Array(S):E===void 0?O=new Uint8Array(S,p):O=new Uint8Array(S,p,E),Object.setPrototypeOf(O,x.prototype),O}function W(S){if(x.isBuffer(S)){const p=z(S.length)|0,E=w(p);return E.length===0||S.copy(E,0,0,p),E}if(S.length!==void 0)return typeof S.length!="number"||Zt(S.length)?w(0):P(S);if(S.type==="Buffer"&&Array.isArray(S.data))return P(S.data)}function z(S){if(S>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return S|0}function J(S){return+S!=S&&(S=0),x.alloc(+S)}x.isBuffer=function(p){return p!=null&&p._isBuffer===!0&&p!==x.prototype},x.compare=function(p,E){if(jt(p,Uint8Array)&&(p=x.from(p,p.offset,p.byteLength)),jt(E,Uint8Array)&&(E=x.from(E,E.offset,E.byteLength)),!x.isBuffer(p)||!x.isBuffer(E))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(p===E)return 0;let O=p.length,X=E.length;for(let j=0,H=Math.min(O,X);j<H;++j)if(p[j]!==E[j]){O=p[j],X=E[j];break}return O<X?-1:X<O?1:0},x.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},x.concat=function(p,E){if(!Array.isArray(p))throw new TypeError('"list" argument must be an Array of Buffers');if(p.length===0)return x.alloc(0);let O;if(E===void 0)for(E=0,O=0;O<p.length;++O)E+=p[O].length;const X=x.allocUnsafe(E);let j=0;for(O=0;O<p.length;++O){let H=p[O];if(jt(H,Uint8Array))j+H.length>X.length?(x.isBuffer(H)||(H=x.from(H)),H.copy(X,j)):Uint8Array.prototype.set.call(X,H,j);else if(x.isBuffer(H))H.copy(X,j);else throw new TypeError('"list" argument must be an Array of Buffers');j+=H.length}return X};function Y(S,p){if(x.isBuffer(S))return S.length;if(ArrayBuffer.isView(S)||jt(S,ArrayBuffer))return S.byteLength;if(typeof S!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof S);const E=S.length,O=arguments.length>2&&arguments[2]===!0;if(!O&&E===0)return 0;let X=!1;for(;;)switch(p){case"ascii":case"latin1":case"binary":return E;case"utf8":case"utf-8":return tt(S).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E*2;case"hex":return E>>>1;case"base64":return Se(S).length;default:if(X)return O?-1:tt(S).length;p=(""+p).toLowerCase(),X=!0}}x.byteLength=Y;function Q(S,p,E){let O=!1;if((p===void 0||p<0)&&(p=0),p>this.length||((E===void 0||E>this.length)&&(E=this.length),E<=0)||(E>>>=0,p>>>=0,E<=p))return"";for(S||(S="utf8");;)switch(S){case"hex":return ze(this,p,E);case"utf8":case"utf-8":return q(this,p,E);case"ascii":return De(this,p,E);case"latin1":case"binary":return et(this,p,E);case"base64":return Ae(this,p,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ye(this,p,E);default:if(O)throw new TypeError("Unknown encoding: "+S);S=(S+"").toLowerCase(),O=!0}}x.prototype._isBuffer=!0;function $(S,p,E){const O=S[p];S[p]=S[E],S[E]=O}x.prototype.swap16=function(){const p=this.length;if(p%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let E=0;E<p;E+=2)$(this,E,E+1);return this},x.prototype.swap32=function(){const p=this.length;if(p%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let E=0;E<p;E+=4)$(this,E,E+3),$(this,E+1,E+2);return this},x.prototype.swap64=function(){const p=this.length;if(p%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let E=0;E<p;E+=8)$(this,E,E+7),$(this,E+1,E+6),$(this,E+2,E+5),$(this,E+3,E+4);return this},x.prototype.toString=function(){const p=this.length;return p===0?"":arguments.length===0?q(this,0,p):Q.apply(this,arguments)},x.prototype.toLocaleString=x.prototype.toString,x.prototype.equals=function(p){if(!x.isBuffer(p))throw new TypeError("Argument must be a Buffer");return this===p?!0:x.compare(this,p)===0},x.prototype.inspect=function(){let p="";const E=a.INSPECT_MAX_BYTES;return p=this.toString("hex",0,E).replace(/(.{2})/g,"$1 ").trim(),this.length>E&&(p+=" ... "),"<Buffer "+p+">"},f&&(x.prototype[f]=x.prototype.inspect),x.prototype.compare=function(p,E,O,X,j){if(jt(p,Uint8Array)&&(p=x.from(p,p.offset,p.byteLength)),!x.isBuffer(p))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof p);if(E===void 0&&(E=0),O===void 0&&(O=p?p.length:0),X===void 0&&(X=0),j===void 0&&(j=this.length),E<0||O>p.length||X<0||j>this.length)throw new RangeError("out of range index");if(X>=j&&E>=O)return 0;if(X>=j)return-1;if(E>=O)return 1;if(E>>>=0,O>>>=0,X>>>=0,j>>>=0,this===p)return 0;let H=j-X,Re=O-E;const ve=Math.min(H,Re),Le=this.slice(X,j),rt=p.slice(E,O);for(let Qe=0;Qe<ve;++Qe)if(Le[Qe]!==rt[Qe]){H=Le[Qe],Re=rt[Qe];break}return H<Re?-1:Re<H?1:0};function U(S,p,E,O,X){if(S.length===0)return-1;if(typeof E=="string"?(O=E,E=0):E>2147483647?E=2147483647:E<-2147483648&&(E=-2147483648),E=+E,Zt(E)&&(E=X?0:S.length-1),E<0&&(E=S.length+E),E>=S.length){if(X)return-1;E=S.length-1}else if(E<0)if(X)E=0;else return-1;if(typeof p=="string"&&(p=x.from(p,O)),x.isBuffer(p))return p.length===0?-1:se(S,p,E,O,X);if(typeof p=="number")return p=p&255,typeof Uint8Array.prototype.indexOf=="function"?X?Uint8Array.prototype.indexOf.call(S,p,E):Uint8Array.prototype.lastIndexOf.call(S,p,E):se(S,[p],E,O,X);throw new TypeError("val must be string, number or Buffer")}function se(S,p,E,O,X){let j=1,H=S.length,Re=p.length;if(O!==void 0&&(O=String(O).toLowerCase(),O==="ucs2"||O==="ucs-2"||O==="utf16le"||O==="utf-16le")){if(S.length<2||p.length<2)return-1;j=2,H/=2,Re/=2,E/=2}function ve(rt,Qe){return j===1?rt[Qe]:rt.readUInt16BE(Qe*j)}let Le;if(X){let rt=-1;for(Le=E;Le<H;Le++)if(ve(S,Le)===ve(p,rt===-1?0:Le-rt)){if(rt===-1&&(rt=Le),Le-rt+1===Re)return rt*j}else rt!==-1&&(Le-=Le-rt),rt=-1}else for(E+Re>H&&(E=H-Re),Le=E;Le>=0;Le--){let rt=!0;for(let Qe=0;Qe<Re;Qe++)if(ve(S,Le+Qe)!==ve(p,Qe)){rt=!1;break}if(rt)return Le}return-1}x.prototype.includes=function(p,E,O){return this.indexOf(p,E,O)!==-1},x.prototype.indexOf=function(p,E,O){return U(this,p,E,O,!0)},x.prototype.lastIndexOf=function(p,E,O){return U(this,p,E,O,!1)};function k(S,p,E,O){E=Number(E)||0;const X=S.length-E;O?(O=Number(O),O>X&&(O=X)):O=X;const j=p.length;O>j/2&&(O=j/2);let H;for(H=0;H<O;++H){const Re=parseInt(p.substr(H*2,2),16);if(Zt(Re))return H;S[E+H]=Re}return H}function xe(S,p,E,O){return wn(tt(p,S.length-E),S,E,O)}function pe(S,p,E,O){return wn(Xe(p),S,E,O)}function ae(S,p,E,O){return wn(Se(p),S,E,O)}function ne(S,p,E,O){return wn(Ln(p,S.length-E),S,E,O)}x.prototype.write=function(p,E,O,X){if(E===void 0)X="utf8",O=this.length,E=0;else if(O===void 0&&typeof E=="string")X=E,O=this.length,E=0;else if(isFinite(E))E=E>>>0,isFinite(O)?(O=O>>>0,X===void 0&&(X="utf8")):(X=O,O=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const j=this.length-E;if((O===void 0||O>j)&&(O=j),p.length>0&&(O<0||E<0)||E>this.length)throw new RangeError("Attempt to write outside buffer bounds");X||(X="utf8");let H=!1;for(;;)switch(X){case"hex":return k(this,p,E,O);case"utf8":case"utf-8":return xe(this,p,E,O);case"ascii":case"latin1":case"binary":return pe(this,p,E,O);case"base64":return ae(this,p,E,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,p,E,O);default:if(H)throw new TypeError("Unknown encoding: "+X);X=(""+X).toLowerCase(),H=!0}},x.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ae(S,p,E){return p===0&&E===S.length?s.fromByteArray(S):s.fromByteArray(S.slice(p,E))}function q(S,p,E){E=Math.min(S.length,E);const O=[];let X=p;for(;X<E;){const j=S[X];let H=null,Re=j>239?4:j>223?3:j>191?2:1;if(X+Re<=E){let ve,Le,rt,Qe;switch(Re){case 1:j<128&&(H=j);break;case 2:ve=S[X+1],(ve&192)===128&&(Qe=(j&31)<<6|ve&63,Qe>127&&(H=Qe));break;case 3:ve=S[X+1],Le=S[X+2],(ve&192)===128&&(Le&192)===128&&(Qe=(j&15)<<12|(ve&63)<<6|Le&63,Qe>2047&&(Qe<55296||Qe>57343)&&(H=Qe));break;case 4:ve=S[X+1],Le=S[X+2],rt=S[X+3],(ve&192)===128&&(Le&192)===128&&(rt&192)===128&&(Qe=(j&15)<<18|(ve&63)<<12|(Le&63)<<6|rt&63,Qe>65535&&Qe<1114112&&(H=Qe))}}H===null?(H=65533,Re=1):H>65535&&(H-=65536,O.push(H>>>10&1023|55296),H=56320|H&1023),O.push(H),X+=Re}return oe(O)}const Ne=4096;function oe(S){const p=S.length;if(p<=Ne)return String.fromCharCode.apply(String,S);let E="",O=0;for(;O<p;)E+=String.fromCharCode.apply(String,S.slice(O,O+=Ne));return E}function De(S,p,E){let O="";E=Math.min(S.length,E);for(let X=p;X<E;++X)O+=String.fromCharCode(S[X]&127);return O}function et(S,p,E){let O="";E=Math.min(S.length,E);for(let X=p;X<E;++X)O+=String.fromCharCode(S[X]);return O}function ze(S,p,E){const O=S.length;(!p||p<0)&&(p=0),(!E||E<0||E>O)&&(E=O);let X="";for(let j=p;j<E;++j)X+=nr[S[j]];return X}function ye(S,p,E){const O=S.slice(p,E);let X="";for(let j=0;j<O.length-1;j+=2)X+=String.fromCharCode(O[j]+O[j+1]*256);return X}x.prototype.slice=function(p,E){const O=this.length;p=~~p,E=E===void 0?O:~~E,p<0?(p+=O,p<0&&(p=0)):p>O&&(p=O),E<0?(E+=O,E<0&&(E=0)):E>O&&(E=O),E<p&&(E=p);const X=this.subarray(p,E);return Object.setPrototypeOf(X,x.prototype),X};function he(S,p,E){if(S%1!==0||S<0)throw new RangeError("offset is not uint");if(S+p>E)throw new RangeError("Trying to access beyond buffer length")}x.prototype.readUintLE=x.prototype.readUIntLE=function(p,E,O){p=p>>>0,E=E>>>0,O||he(p,E,this.length);let X=this[p],j=1,H=0;for(;++H<E&&(j*=256);)X+=this[p+H]*j;return X},x.prototype.readUintBE=x.prototype.readUIntBE=function(p,E,O){p=p>>>0,E=E>>>0,O||he(p,E,this.length);let X=this[p+--E],j=1;for(;E>0&&(j*=256);)X+=this[p+--E]*j;return X},x.prototype.readUint8=x.prototype.readUInt8=function(p,E){return p=p>>>0,E||he(p,1,this.length),this[p]},x.prototype.readUint16LE=x.prototype.readUInt16LE=function(p,E){return p=p>>>0,E||he(p,2,this.length),this[p]|this[p+1]<<8},x.prototype.readUint16BE=x.prototype.readUInt16BE=function(p,E){return p=p>>>0,E||he(p,2,this.length),this[p]<<8|this[p+1]},x.prototype.readUint32LE=x.prototype.readUInt32LE=function(p,E){return p=p>>>0,E||he(p,4,this.length),(this[p]|this[p+1]<<8|this[p+2]<<16)+this[p+3]*16777216},x.prototype.readUint32BE=x.prototype.readUInt32BE=function(p,E){return p=p>>>0,E||he(p,4,this.length),this[p]*16777216+(this[p+1]<<16|this[p+2]<<8|this[p+3])},x.prototype.readBigUInt64LE=At(function(p){p=p>>>0,je(p,"offset");const E=this[p],O=this[p+7];(E===void 0||O===void 0)&&yt(p,this.length-8);const X=E+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24,j=this[++p]+this[++p]*2**8+this[++p]*2**16+O*2**24;return BigInt(X)+(BigInt(j)<<BigInt(32))}),x.prototype.readBigUInt64BE=At(function(p){p=p>>>0,je(p,"offset");const E=this[p],O=this[p+7];(E===void 0||O===void 0)&&yt(p,this.length-8);const X=E*2**24+this[++p]*2**16+this[++p]*2**8+this[++p],j=this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+O;return(BigInt(X)<<BigInt(32))+BigInt(j)}),x.prototype.readIntLE=function(p,E,O){p=p>>>0,E=E>>>0,O||he(p,E,this.length);let X=this[p],j=1,H=0;for(;++H<E&&(j*=256);)X+=this[p+H]*j;return j*=128,X>=j&&(X-=Math.pow(2,8*E)),X},x.prototype.readIntBE=function(p,E,O){p=p>>>0,E=E>>>0,O||he(p,E,this.length);let X=E,j=1,H=this[p+--X];for(;X>0&&(j*=256);)H+=this[p+--X]*j;return j*=128,H>=j&&(H-=Math.pow(2,8*E)),H},x.prototype.readInt8=function(p,E){return p=p>>>0,E||he(p,1,this.length),this[p]&128?(255-this[p]+1)*-1:this[p]},x.prototype.readInt16LE=function(p,E){p=p>>>0,E||he(p,2,this.length);const O=this[p]|this[p+1]<<8;return O&32768?O|4294901760:O},x.prototype.readInt16BE=function(p,E){p=p>>>0,E||he(p,2,this.length);const O=this[p+1]|this[p]<<8;return O&32768?O|4294901760:O},x.prototype.readInt32LE=function(p,E){return p=p>>>0,E||he(p,4,this.length),this[p]|this[p+1]<<8|this[p+2]<<16|this[p+3]<<24},x.prototype.readInt32BE=function(p,E){return p=p>>>0,E||he(p,4,this.length),this[p]<<24|this[p+1]<<16|this[p+2]<<8|this[p+3]},x.prototype.readBigInt64LE=At(function(p){p=p>>>0,je(p,"offset");const E=this[p],O=this[p+7];(E===void 0||O===void 0)&&yt(p,this.length-8);const X=this[p+4]+this[p+5]*2**8+this[p+6]*2**16+(O<<24);return(BigInt(X)<<BigInt(32))+BigInt(E+this[++p]*2**8+this[++p]*2**16+this[++p]*2**24)}),x.prototype.readBigInt64BE=At(function(p){p=p>>>0,je(p,"offset");const E=this[p],O=this[p+7];(E===void 0||O===void 0)&&yt(p,this.length-8);const X=(E<<24)+this[++p]*2**16+this[++p]*2**8+this[++p];return(BigInt(X)<<BigInt(32))+BigInt(this[++p]*2**24+this[++p]*2**16+this[++p]*2**8+O)}),x.prototype.readFloatLE=function(p,E){return p=p>>>0,E||he(p,4,this.length),c.read(this,p,!0,23,4)},x.prototype.readFloatBE=function(p,E){return p=p>>>0,E||he(p,4,this.length),c.read(this,p,!1,23,4)},x.prototype.readDoubleLE=function(p,E){return p=p>>>0,E||he(p,8,this.length),c.read(this,p,!0,52,8)},x.prototype.readDoubleBE=function(p,E){return p=p>>>0,E||he(p,8,this.length),c.read(this,p,!1,52,8)};function fe(S,p,E,O,X,j){if(!x.isBuffer(S))throw new TypeError('"buffer" argument must be a Buffer instance');if(p>X||p<j)throw new RangeError('"value" argument is out of bounds');if(E+O>S.length)throw new RangeError("Index out of range")}x.prototype.writeUintLE=x.prototype.writeUIntLE=function(p,E,O,X){if(p=+p,E=E>>>0,O=O>>>0,!X){const Re=Math.pow(2,8*O)-1;fe(this,p,E,O,Re,0)}let j=1,H=0;for(this[E]=p&255;++H<O&&(j*=256);)this[E+H]=p/j&255;return E+O},x.prototype.writeUintBE=x.prototype.writeUIntBE=function(p,E,O,X){if(p=+p,E=E>>>0,O=O>>>0,!X){const Re=Math.pow(2,8*O)-1;fe(this,p,E,O,Re,0)}let j=O-1,H=1;for(this[E+j]=p&255;--j>=0&&(H*=256);)this[E+j]=p/H&255;return E+O},x.prototype.writeUint8=x.prototype.writeUInt8=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,1,255,0),this[E]=p&255,E+1},x.prototype.writeUint16LE=x.prototype.writeUInt16LE=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,2,65535,0),this[E]=p&255,this[E+1]=p>>>8,E+2},x.prototype.writeUint16BE=x.prototype.writeUInt16BE=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,2,65535,0),this[E]=p>>>8,this[E+1]=p&255,E+2},x.prototype.writeUint32LE=x.prototype.writeUInt32LE=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,4,4294967295,0),this[E+3]=p>>>24,this[E+2]=p>>>16,this[E+1]=p>>>8,this[E]=p&255,E+4},x.prototype.writeUint32BE=x.prototype.writeUInt32BE=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,4,4294967295,0),this[E]=p>>>24,this[E+1]=p>>>16,this[E+2]=p>>>8,this[E+3]=p&255,E+4};function we(S,p,E,O,X){Ee(p,O,X,S,E,7);let j=Number(p&BigInt(4294967295));S[E++]=j,j=j>>8,S[E++]=j,j=j>>8,S[E++]=j,j=j>>8,S[E++]=j;let H=Number(p>>BigInt(32)&BigInt(4294967295));return S[E++]=H,H=H>>8,S[E++]=H,H=H>>8,S[E++]=H,H=H>>8,S[E++]=H,E}function Ve(S,p,E,O,X){Ee(p,O,X,S,E,7);let j=Number(p&BigInt(4294967295));S[E+7]=j,j=j>>8,S[E+6]=j,j=j>>8,S[E+5]=j,j=j>>8,S[E+4]=j;let H=Number(p>>BigInt(32)&BigInt(4294967295));return S[E+3]=H,H=H>>8,S[E+2]=H,H=H>>8,S[E+1]=H,H=H>>8,S[E]=H,E+8}x.prototype.writeBigUInt64LE=At(function(p,E=0){return we(this,p,E,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeBigUInt64BE=At(function(p,E=0){return Ve(this,p,E,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeIntLE=function(p,E,O,X){if(p=+p,E=E>>>0,!X){const ve=Math.pow(2,8*O-1);fe(this,p,E,O,ve-1,-ve)}let j=0,H=1,Re=0;for(this[E]=p&255;++j<O&&(H*=256);)p<0&&Re===0&&this[E+j-1]!==0&&(Re=1),this[E+j]=(p/H>>0)-Re&255;return E+O},x.prototype.writeIntBE=function(p,E,O,X){if(p=+p,E=E>>>0,!X){const ve=Math.pow(2,8*O-1);fe(this,p,E,O,ve-1,-ve)}let j=O-1,H=1,Re=0;for(this[E+j]=p&255;--j>=0&&(H*=256);)p<0&&Re===0&&this[E+j+1]!==0&&(Re=1),this[E+j]=(p/H>>0)-Re&255;return E+O},x.prototype.writeInt8=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,1,127,-128),p<0&&(p=255+p+1),this[E]=p&255,E+1},x.prototype.writeInt16LE=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,2,32767,-32768),this[E]=p&255,this[E+1]=p>>>8,E+2},x.prototype.writeInt16BE=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,2,32767,-32768),this[E]=p>>>8,this[E+1]=p&255,E+2},x.prototype.writeInt32LE=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,4,2147483647,-2147483648),this[E]=p&255,this[E+1]=p>>>8,this[E+2]=p>>>16,this[E+3]=p>>>24,E+4},x.prototype.writeInt32BE=function(p,E,O){return p=+p,E=E>>>0,O||fe(this,p,E,4,2147483647,-2147483648),p<0&&(p=4294967295+p+1),this[E]=p>>>24,this[E+1]=p>>>16,this[E+2]=p>>>8,this[E+3]=p&255,E+4},x.prototype.writeBigInt64LE=At(function(p,E=0){return we(this,p,E,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),x.prototype.writeBigInt64BE=At(function(p,E=0){return Ve(this,p,E,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ce(S,p,E,O,X,j){if(E+O>S.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("Index out of range")}function xn(S,p,E,O,X){return p=+p,E=E>>>0,X||Ce(S,p,E,4),c.write(S,p,E,O,23,4),E+4}x.prototype.writeFloatLE=function(p,E,O){return xn(this,p,E,!0,O)},x.prototype.writeFloatBE=function(p,E,O){return xn(this,p,E,!1,O)};function lt(S,p,E,O,X){return p=+p,E=E>>>0,X||Ce(S,p,E,8),c.write(S,p,E,O,52,8),E+8}x.prototype.writeDoubleLE=function(p,E,O){return lt(this,p,E,!0,O)},x.prototype.writeDoubleBE=function(p,E,O){return lt(this,p,E,!1,O)},x.prototype.copy=function(p,E,O,X){if(!x.isBuffer(p))throw new TypeError("argument should be a Buffer");if(O||(O=0),!X&&X!==0&&(X=this.length),E>=p.length&&(E=p.length),E||(E=0),X>0&&X<O&&(X=O),X===O||p.length===0||this.length===0)return 0;if(E<0)throw new RangeError("targetStart out of bounds");if(O<0||O>=this.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("sourceEnd out of bounds");X>this.length&&(X=this.length),p.length-E<X-O&&(X=p.length-E+O);const j=X-O;return this===p&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(E,O,X):Uint8Array.prototype.set.call(p,this.subarray(O,X),E),j},x.prototype.fill=function(p,E,O,X){if(typeof p=="string"){if(typeof E=="string"?(X=E,E=0,O=this.length):typeof O=="string"&&(X=O,O=this.length),X!==void 0&&typeof X!="string")throw new TypeError("encoding must be a string");if(typeof X=="string"&&!x.isEncoding(X))throw new TypeError("Unknown encoding: "+X);if(p.length===1){const H=p.charCodeAt(0);(X==="utf8"&&H<128||X==="latin1")&&(p=H)}}else typeof p=="number"?p=p&255:typeof p=="boolean"&&(p=Number(p));if(E<0||this.length<E||this.length<O)throw new RangeError("Out of range index");if(O<=E)return this;E=E>>>0,O=O===void 0?this.length:O>>>0,p||(p=0);let j;if(typeof p=="number")for(j=E;j<O;++j)this[j]=p;else{const H=x.isBuffer(p)?p:x.from(p,X),Re=H.length;if(Re===0)throw new TypeError('The value "'+p+'" is invalid for argument "value"');for(j=0;j<O-E;++j)this[j+E]=H[j%Re]}return this};const ht={};function Qt(S,p,E){ht[S]=class extends E{constructor(){super(),Object.defineProperty(this,"message",{value:p.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${S}]`,this.stack,delete this.name}get code(){return S}set code(X){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:X,writable:!0})}toString(){return`${this.name} [${S}]: ${this.message}`}}}Qt("ERR_BUFFER_OUT_OF_BOUNDS",function(S){return S?`${S} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Qt("ERR_INVALID_ARG_TYPE",function(S,p){return`The "${S}" argument must be of type number. Received type ${typeof p}`},TypeError),Qt("ERR_OUT_OF_RANGE",function(S,p,E){let O=`The value of "${S}" is out of range.`,X=E;return Number.isInteger(E)&&Math.abs(E)>2**32?X=gt(String(E)):typeof E=="bigint"&&(X=String(E),(E>BigInt(2)**BigInt(32)||E<-(BigInt(2)**BigInt(32)))&&(X=gt(X)),X+="n"),O+=` It must be ${p}. Received ${X}`,O},RangeError);function gt(S){let p="",E=S.length;const O=S[0]==="-"?1:0;for(;E>=O+4;E-=3)p=`_${S.slice(E-3,E)}${p}`;return`${S.slice(0,E)}${p}`}function Mt(S,p,E){je(p,"offset"),(S[p]===void 0||S[p+E]===void 0)&&yt(p,S.length-(E+1))}function Ee(S,p,E,O,X,j){if(S>E||S<p){const H=typeof p=="bigint"?"n":"";let Re;throw j>3?p===0||p===BigInt(0)?Re=`>= 0${H} and < 2${H} ** ${(j+1)*8}${H}`:Re=`>= -(2${H} ** ${(j+1)*8-1}${H}) and < 2 ** ${(j+1)*8-1}${H}`:Re=`>= ${p}${H} and <= ${E}${H}`,new ht.ERR_OUT_OF_RANGE("value",Re,S)}Mt(O,X,j)}function je(S,p){if(typeof S!="number")throw new ht.ERR_INVALID_ARG_TYPE(p,"number",S)}function yt(S,p,E){throw Math.floor(S)!==S?(je(S,E),new ht.ERR_OUT_OF_RANGE(E||"offset","an integer",S)):p<0?new ht.ERR_BUFFER_OUT_OF_BOUNDS:new ht.ERR_OUT_OF_RANGE(E||"offset",`>= ${E?1:0} and <= ${p}`,S)}const Sn=/[^+/0-9A-Za-z-_]/g;function St(S){if(S=S.split("=")[0],S=S.trim().replace(Sn,""),S.length<2)return"";for(;S.length%4!==0;)S=S+"=";return S}function tt(S,p){p=p||1/0;let E;const O=S.length;let X=null;const j=[];for(let H=0;H<O;++H){if(E=S.charCodeAt(H),E>55295&&E<57344){if(!X){if(E>56319){(p-=3)>-1&&j.push(239,191,189);continue}else if(H+1===O){(p-=3)>-1&&j.push(239,191,189);continue}X=E;continue}if(E<56320){(p-=3)>-1&&j.push(239,191,189),X=E;continue}E=(X-55296<<10|E-56320)+65536}else X&&(p-=3)>-1&&j.push(239,191,189);if(X=null,E<128){if((p-=1)<0)break;j.push(E)}else if(E<2048){if((p-=2)<0)break;j.push(E>>6|192,E&63|128)}else if(E<65536){if((p-=3)<0)break;j.push(E>>12|224,E>>6&63|128,E&63|128)}else if(E<1114112){if((p-=4)<0)break;j.push(E>>18|240,E>>12&63|128,E>>6&63|128,E&63|128)}else throw new Error("Invalid code point")}return j}function Xe(S){const p=[];for(let E=0;E<S.length;++E)p.push(S.charCodeAt(E)&255);return p}function Ln(S,p){let E,O,X;const j=[];for(let H=0;H<S.length&&!((p-=2)<0);++H)E=S.charCodeAt(H),O=E>>8,X=E%256,j.push(X),j.push(O);return j}function Se(S){return s.toByteArray(St(S))}function wn(S,p,E,O){let X;for(X=0;X<O&&!(X+E>=p.length||X>=S.length);++X)p[X+E]=S[X];return X}function jt(S,p){return S instanceof p||S!=null&&S.constructor!=null&&S.constructor.name!=null&&S.constructor.name===p.name}function Zt(S){return S!==S}const nr=function(){const S="0123456789abcdef",p=new Array(256);for(let E=0;E<16;++E){const O=E*16;for(let X=0;X<16;++X)p[O+X]=S[E]+S[X]}return p}();function At(S){return typeof BigInt>"u"?Tr:S}function Tr(){throw new Error("BigInt not supported")}})(_r);function kl(a){let s;return{c(){s=G("div"),D(s,"class","w-2 h-2 rounded-full bg-red-500")},m(c,f){ie(c,s,f)},d(c){c&&re(s)}}}function Ll(a){let s;return{c(){s=G("div"),D(s,"class","w-2 h-2 rounded-full bg-bitcoin")},m(c,f){ie(c,s,f)},d(c){c&&re(s)}}}function Pl(a){let s;return{c(){s=G("div"),D(s,"class","w-2 h-2 rounded-full bg-green-500")},m(c,f){ie(c,s,f)},d(c){c&&re(s)}}}function Fl(a){let s,c,f,h=decodeURIComponent(a[1])+"",d,w,x,m,C,_,B;function v(F,W){return F[2]?Pl:F[3]?Ll:kl}let P=v(a),M=P(a);return _=new Ir({props:{value:a[0]}}),{c(){s=G("div"),c=G("div"),f=G("a"),d=me(h),x=le(),M.c(),m=le(),C=G("div"),Rt(_.$$.fragment),D(f,"href",w="/#/manage/"+encodeURIComponent(a[0])),D(c,"class","col-span-3 overflow-ellipsis w-full whitespace-nowrap overflow-hidden"),D(C,"class","w-full h-full col-span-4"),D(s,"class","inline-grid grid-cols-8 bg-none border border-bitcoin rounded-xl w-full h-16 mt-2 p-2 inline-flex flex-wrap gap-4 items-center justify-items-center")},m(F,W){ie(F,s,W),R(s,c),R(c,f),R(f,d),R(s,x),M.m(s,null),R(s,m),R(s,C),Ct(_,C,null),B=!0},p(F,[W]){(!B||W&2)&&h!==(h=decodeURIComponent(F[1])+"")&&Je(d,h),(!B||W&1&&w!==(w="/#/manage/"+encodeURIComponent(F[0])))&&D(f,"href",w),P!==(P=v(F))&&(M.d(1),M=P(F),M&&(M.c(),M.m(s,m)));const z={};W&1&&(z.value=F[0]),_.$set(z)},i(F){B||(He(_.$$.fragment,F),B=!0)},o(F){Ye(_.$$.fragment,F),B=!1},d(F){F&&re(s),M.d(),bt(_)}}}function Ul(a,s,c){const{Buffer:f}=_r;let{value:h}=s,{title:d}=s;const w=_=>{try{let B=_.split(/[:=]/);_=B.length===2?B[1]:_;let v=Lt.decode(_,1500),P=Lt.fromWords(v.words);return!!f.from(P).toString()}catch{return!1}},x=_=>{if(_.split("@").length!==2)return!1;const B=_.split("@");return!!B[0].trim()&&!!B[1].trim()};let m=w(decodeURIComponent(h))||x(decodeURIComponent(h)),C=!1;return localStorage.getItem(`info${h}`)&&JSON.parse(localStorage.getItem(`info${h}`)).invoice&&(C=!0),a.$$set=_=>{"value"in _&&c(0,h=_.value),"title"in _&&c(1,d=_.title)},[h,d,C,m]}class yr extends _t{constructor(s){super(),It(this,s,Ul,Fl,Et,{value:0,title:1})}}function Vl(a){let s,c,f,h,d,w;return{c(){s=G("div"),c=G("div"),c.innerHTML=`<a href="#/new/trusted/lnurlw" class="w-1/2"><img alt="new" src="add.svg"/></a> 
        <a href="/#/manual" class="w-1/2"><img alt="manual" src="manual.svg"/></a> 
        <a href="/#/qr" class="w-1/2"><img alt="qr" src="qr.svg"/></a> 
        <a href="/#/nfc" class="w-1/2"><img alt="nfc" src="nfc.svg"/></a>`,f=le(),h=G("button"),h.innerHTML='<img class="w-16 h-16" alt="new" src="add.svg"/>',D(c,"id","nav"),dr(c,"display","none"),D(c,"class","text-center flex flex-wrap flex-col items-center gap-4 w-full bg-base pb-2 rounded-xl"),D(h,"class","rounded-full w-16 h-16 bg-base"),D(s,"class","flex flex-wrap flex-col items-center")},m(x,m){ie(x,s,m),R(s,c),R(s,f),R(s,h),d||(w=Te(h,"click",a[0]),d=!0)},p:_e,i:_e,o:_e,d(x){x&&re(s),d=!1,w()}}}function Hl(a){return[()=>{document.getElementById("nav").style.display=document.getElementById("nav").style.display==="flex"?"none":"flex"}]}class Gl extends _t{constructor(s){super(),It(this,s,Hl,Vl,Et,{})}}function Xl(a){let s,c,f,h,d,w,x,m,C,_,B,v,P,M,F,W,z,J,Y,Q,$,U;return{c(){s=G("div"),c=G("button"),c.textContent="\xD7",f=le(),h=G("div"),h.innerHTML='<a href="/#/keys">lnbits api keys</a>',d=le(),w=G("div"),w.innerHTML='<a href="/#/shorter">lnurl shorter</a>',x=le(),m=G("div"),m.innerHTML='<a href="/#/lnurl/">lnurl decoder</a>',C=le(),_=G("a"),B=me("export"),v=le(),P=G("label"),P.textContent="import",M=le(),F=G("input"),W=le(),z=G("span"),z.textContent="version@0.0.1",J=le(),Y=G("img"),D(c,"class","absolute top-5 right-5 text-6xl"),D(h,"class","col-span-2 items-center justify-items-center border border-bitcoin rounded-xl h-12 w-3/4"),D(w,"class","col-span-2 items-center justify-items-center border border-bitcoin rounded-xl h-12 w-3/4"),D(m,"class","col-span-2 items-center justify-items-center border border-bitcoin rounded-xl h-12 w-3/4"),D(_,"class","row-start-5 col-start-1 border border-bitcoin rounded-xl w-3/4"),D(_,"href","data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(localStorage))),D(_,"download","lnnote_export.json"),D(P,"for","import"),D(P,"class","row-start-5 col-start-2 border border-bitcoin rounded-xl w-3/4"),D(F,"id","import"),D(F,"class","invisible"),D(F,"type","file"),D(F,"accept",".json"),D(z,"class","absolute bottom-2"),D(s,"id","sideNav"),D(s,"class","fixed grid grid-cols-2 grid-rows-5 items-center justify-items-center gap-4 z-50 w-0 top-0 right-0 bg-[#1a1a1a] overflow-hidden h-full pt-24 duration-200 text-center"),D(Y,"alt","menu"),yi(Y.src,Q="menu.svg")||D(Y,"src",Q),D(Y,"class","w-10 h-10")},m(se,k){ie(se,s,k),R(s,c),R(s,f),R(s,h),R(s,d),R(s,w),R(s,x),R(s,m),R(s,C),R(s,_),R(_,B),R(s,v),R(s,P),R(s,M),R(s,F),R(s,W),R(s,z),ie(se,J,k),ie(se,Y,k),$||(U=[Te(c,"click",a[2]),Te(F,"change",a[4]),Te(F,"change",a[3]),Te(Y,"click",a[1])],$=!0)},p:_e,i:_e,o:_e,d(se){se&&re(s),se&&re(J),se&&re(Y),$=!1,Pt(U)}}}function Wl(a,s,c){const f=()=>{document.getElementById("sideNav").style.width="250px",document.querySelectorAll("#sideNav *").forEach(m=>m.style.display="inline-grid")},h=()=>{document.getElementById("sideNav").style.width="0",document.querySelectorAll("#sideNav *").forEach(m=>m.style.display="none")};let d={};const w=async()=>{let m=JSON.parse(await d[0].text());Object.keys(m).forEach(C=>{Object.keys(localStorage).includes(C)||localStorage.setItem(C,m[C])}),document.location.reload()};function x(){d=this.files,c(0,d)}return[d,f,h,w,x]}class Yl extends _t{constructor(s){super(),It(this,s,Wl,Xl,Et,{})}}function ps(a,s,c){const f=a.slice();return f[2]=s[c],f}function zl(a){let s,c,f,h;const d=[Ql,ql,Kl,Zl,jl],w=[];function x(m,C){return m[0]==="all"?0:m[0]==="valid"?1:m[0]==="lnAddress"?2:m[0]==="lnurl"?3:m[0]==="refill"?4:-1}return~(s=x(a))&&(c=w[s]=d[s](a)),{c(){c&&c.c(),f=Ft()},m(m,C){~s&&w[s].m(m,C),ie(m,f,C),h=!0},p(m,C){let _=s;s=x(m),s===_?~s&&w[s].p(m,C):(c&&(vn(),Ye(w[_],1,1,()=>{w[_]=null}),kn()),~s?(c=w[s],c?c.p(m,C):(c=w[s]=d[s](m),c.c()),He(c,1),c.m(f.parentNode,f)):c=null)},i(m){h||(He(c),h=!0)},o(m){Ye(c),h=!1},d(m){~s&&w[s].d(m),m&&re(f)}}}function jl(a){let s=JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).invoice,c,f,h=s&&$l(a);return{c(){h&&h.c(),c=Ft()},m(d,w){h&&h.m(d,w),ie(d,c,w),f=!0},p(d,w){s&&h.p(d,w)},i(d){f||(He(h),f=!0)},o(d){Ye(h),f=!1},d(d){h&&h.d(d),d&&re(c)}}}function Zl(a){let s=JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).type==="lnurl"||JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).type==="lnurlw"||JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).type==="lnurlp",c,f,h=s&&Jl(a);return{c(){h&&h.c(),c=Ft()},m(d,w){h&&h.m(d,w),ie(d,c,w),f=!0},p(d,w){s&&h.p(d,w)},i(d){f||(He(h),f=!0)},o(d){Ye(h),f=!1},d(d){h&&h.d(d),d&&re(c)}}}function Kl(a){let s=JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).type==="lnAddress",c,f,h=s&&ea(a);return{c(){h&&h.c(),c=Ft()},m(d,w){h&&h.m(d,w),ie(d,c,w),f=!0},p(d,w){s&&h.p(d,w)},i(d){f||(He(h),f=!0)},o(d){Ye(h),f=!1},d(d){h&&h.d(d),d&&re(c)}}}function ql(a){let s=JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).type==="lnAddress"||JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).type==="lnurl"||JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).type==="lnurlw"||JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).type==="lnurlp",c,f,h=s&&ta(a);return{c(){h&&h.c(),c=Ft()},m(d,w){h&&h.m(d,w),ie(d,c,w),f=!0},p(d,w){s&&h.p(d,w)},i(d){f||(He(h),f=!0)},o(d){Ye(h),f=!1},d(d){h&&h.d(d),d&&re(c)}}}function Ql(a){let s,c;return s=new yr({props:{value:a[2].slice(8,a[2].length),title:JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).title}}),{c(){Rt(s.$$.fragment)},m(f,h){Ct(s,f,h),c=!0},p:_e,i(f){c||(He(s.$$.fragment,f),c=!0)},o(f){Ye(s.$$.fragment,f),c=!1},d(f){bt(s,f)}}}function $l(a){let s,c;return s=new yr({props:{value:a[2].slice(8,a[2].length),title:JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).title}}),{c(){Rt(s.$$.fragment)},m(f,h){Ct(s,f,h),c=!0},p:_e,i(f){c||(He(s.$$.fragment,f),c=!0)},o(f){Ye(s.$$.fragment,f),c=!1},d(f){bt(s,f)}}}function Jl(a){let s,c;return s=new yr({props:{value:a[2].slice(8,a[2].length),title:JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).title}}),{c(){Rt(s.$$.fragment)},m(f,h){Ct(s,f,h),c=!0},p:_e,i(f){c||(He(s.$$.fragment,f),c=!0)},o(f){Ye(s.$$.fragment,f),c=!1},d(f){bt(s,f)}}}function ea(a){let s,c;return s=new yr({props:{value:a[2].slice(8,a[2].length),title:JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).title}}),{c(){Rt(s.$$.fragment)},m(f,h){Ct(s,f,h),c=!0},p:_e,i(f){c||(He(s.$$.fragment,f),c=!0)},o(f){Ye(s.$$.fragment,f),c=!1},d(f){bt(s,f)}}}function ta(a){let s,c;return s=new yr({props:{value:a[2].slice(8,a[2].length),title:JSON.parse(localStorage.getItem(a[2].replace("lnrecord","info"))).title}}),{c(){Rt(s.$$.fragment)},m(f,h){Ct(s,f,h),c=!0},p:_e,i(f){c||(He(s.$$.fragment,f),c=!0)},o(f){Ye(s.$$.fragment,f),c=!1},d(f){bt(s,f)}}}function ms(a){let s=a[2].includes("lnrecord"),c,f,h=s&&zl(a);return{c(){h&&h.c(),c=Ft()},m(d,w){h&&h.m(d,w),ie(d,c,w),f=!0},p(d,w){s&&h.p(d,w)},i(d){f||(He(h),f=!0)},o(d){Ye(h),f=!1},d(d){h&&h.d(d),d&&re(c)}}}function na(a){let s,c,f,h,d,w,x,m,C,_,B,v,P,M,F,W,z,J,Y,Q;d=new Yl({});let $=Object.keys(localStorage),U=[];for(let k=0;k<$.length;k+=1)U[k]=ms(ps(a,$,k));const se=k=>Ye(U[k],1,1,()=>{U[k]=null});return z=new Gl({}),{c(){s=G("main"),c=G("div"),c.innerHTML='<img alt="logo" src="logo.svg" class="w-16 h-16"/>',f=le(),h=G("div"),Rt(d.$$.fragment),w=le(),x=G("select"),m=G("option"),m.textContent="All",C=G("option"),C.textContent="Valid",_=G("option"),_.textContent="Ln Address",B=G("option"),B.textContent="Lnurl",v=G("option"),v.textContent="refill",P=le(),M=G("div");for(let k=0;k<U.length;k+=1)U[k].c();F=le(),W=G("div"),Rt(z.$$.fragment),D(c,"class","absolute top-5 left-5"),D(h,"class","absolute top-8 right-5"),m.__value="all",m.value=m.__value,C.__value="valid",C.value=C.__value,_.__value="lnAddress",_.value=_.__value,B.__value="lnurl",B.value=B.__value,v.__value="refill",v.value=v.__value,D(x,"id","filter"),D(x,"class","h-8 w-1/3 text-center top-24 relative rounded-xl bg-bitcoin"),a[0]===void 0&&mr(()=>a[1].call(x)),D(M,"id","records"),D(M,"class","absolute bottom-0 h-5/6 overflow-y-scroll w-11/12 flex-wrap"),D(W,"class","absolute bottom-5 right-5"),D(s,"class","bg-base")},m(k,xe){ie(k,s,xe),R(s,c),R(s,f),R(s,h),Ct(d,h,null),R(s,w),R(s,x),R(x,m),R(x,C),R(x,_),R(x,B),R(x,v),Xr(x,a[0]),R(s,P),R(s,M);for(let pe=0;pe<U.length;pe+=1)U[pe].m(M,null);R(s,F),R(s,W),Ct(z,W,null),J=!0,Y||(Q=Te(x,"change",a[1]),Y=!0)},p(k,[xe]){if(xe&1&&Xr(x,k[0]),xe&1){$=Object.keys(localStorage);let pe;for(pe=0;pe<$.length;pe+=1){const ae=ps(k,$,pe);U[pe]?(U[pe].p(ae,xe),He(U[pe],1)):(U[pe]=ms(ae),U[pe].c(),He(U[pe],1),U[pe].m(M,null))}for(vn(),pe=$.length;pe<U.length;pe+=1)se(pe);kn()}},i(k){if(!J){He(d.$$.fragment,k);for(let xe=0;xe<$.length;xe+=1)He(U[xe]);He(z.$$.fragment,k),J=!0}},o(k){Ye(d.$$.fragment,k),U=U.filter(Boolean);for(let xe=0;xe<U.length;xe+=1)Ye(U[xe]);Ye(z.$$.fragment,k),J=!1},d(k){k&&re(s),bt(d),Bs(U,k),bt(z),Y=!1,Q()}}}function ra(a,s,c){let f="all";function h(){f=Ms(this),c(0,f)}return[f,h]}class Ei extends _t{constructor(s){super(),It(this,s,ra,na,Et,{})}}function ia(a){let s,c,f,h,d,w;return{c(){s=zn("svg"),c=zn("g"),f=zn("path"),h=zn("path"),d=zn("path"),w=zn("path"),D(f,"d","M6.93112 12.8181C8.64923 12.8314 10.0312 14.2351 10.0178 15.9532C10.0045 17.6713 8.60087 19.0533 6.88276 19.0399C5.16465 19.0265 3.78268 17.6229 3.79604 15.9048C3.80939 14.1867 5.21302 12.8047 6.93112 12.8181Z"),D(f,"fill","#ffffff"),D(f,"fill-rule","nonzero"),D(f,"opacity","1"),D(f,"stroke","none"),D(f,"class","svg-elem-1 svelte-12zhno"),D(h,"d","M11.0475 21.6459C11.0505 21.2641 11.198 20.8844 11.4903 20.5937C12.7333 19.3582 13.4253 17.72 13.4388 15.9798C13.4523 14.2396 12.7859 12.5908 11.5622 11.3361C10.9843 10.7447 10.9946 9.79359 11.5885 9.21518C12.1814 8.63676 13.131 8.64805 13.7094 9.24143C15.4892 11.0659 16.4584 13.467 16.4387 16.0031C16.419 18.5391 15.4126 20.9249 13.6046 22.7215C13.0171 23.3058 12.0674 23.3023 11.4835 22.7148C11.1899 22.4195 11.0445 22.0316 11.0475 21.6459Z"),D(h,"fill","#ffffff"),D(h,"fill-rule","nonzero"),D(h,"opacity","1"),D(h,"stroke","none"),D(h,"class","svg-elem-2 svelte-12zhno"),D(d,"d","M15.1723 25.8363C15.1753 25.4525 15.3247 25.0699 15.62 24.7792C17.9809 22.4537 19.2956 19.3447 19.3214 16.0255C19.3472 12.7062 18.081 9.57716 15.7565 7.21527C15.1751 6.6248 15.1825 5.6756 15.773 5.09425C16.3634 4.51288 17.3131 4.52026 17.894 5.11073C20.781 8.04343 22.3534 11.9278 22.3213 16.0488C22.2893 20.1698 20.6567 24.0293 17.7245 26.9167C17.1345 27.4981 16.1848 27.4907 15.6035 26.9002C15.3128 26.605 15.1693 26.2201 15.1723 25.8363Z"),D(d,"fill","#ffffff"),D(d,"fill-rule","nonzero"),D(d,"opacity","1"),D(d,"stroke","none"),D(d,"class","svg-elem-3 svelte-12zhno"),D(w,"d","M19.2976 30.0257C19.3005 29.6429 19.449 29.2613 19.7428 28.9706C23.2267 25.5268 25.1662 20.9461 25.2041 16.0712C25.2419 11.1964 23.3739 6.58601 19.944 3.08853C19.3641 2.49709 19.3729 1.54791 19.9648 0.967537C20.5563 0.387157 21.5059 0.396489 22.0863 0.987938C26.0753 5.05618 28.2481 10.4209 28.204 16.0945C28.1599 21.7682 25.904 27.0985 21.8522 31.1042C21.2627 31.6866 20.313 31.6811 19.7307 31.0916C19.4385 30.7964 19.2946 30.4105 19.2976 30.0257Z"),D(w,"fill","#ffffff"),D(w,"fill-rule","nonzero"),D(w,"opacity","1"),D(w,"stroke","none"),D(w,"class","svg-elem-4 svelte-12zhno"),D(c,"id","nfcAnimation"),dr(s,"fill-rule","nonzero"),dr(s,"clip-rule","evenodd"),dr(s,"stroke-linecap","round"),dr(s,"stroke-linejoin","round"),D(s,"viewBox","0 0 32 32"),D(s,"width","100%"),D(s,"xml:space","preserve"),D(s,"xmlns","http://www.w3.org/2000/svg")},m(x,m){ie(x,s,m),R(s,c),R(c,f),R(c,h),R(c,d),R(c,w)},p:_e,i:_e,o:_e,d(x){x&&re(s)}}}class Xs extends _t{constructor(s){super(),It(this,s,null,ia,Et,{})}}function sa(a){let s;return{c(){s=G("h1"),s.textContent="NFC is not supported in your browser/device"},m(c,f){ie(c,s,f)},i:_e,o:_e,d(c){c&&re(s)}}}function oa(a){let s,c,f,h,d,w;return d=new Xs({}),{c(){s=G("div"),c=G("h1"),c.textContent="Tap NFC tag to read",f=le(),h=G("div"),Rt(d.$$.fragment),D(h,"class","w-1/4 mt-4"),D(s,"class","grid row-start-4 items-center justify-items-center text-center")},m(x,m){ie(x,s,m),R(s,c),R(s,f),R(s,h),Ct(d,h,null),w=!0},i(x){w||(He(d.$$.fragment,x),w=!0)},o(x){Ye(d.$$.fragment,x),w=!1},d(x){x&&re(s),bt(d)}}}function la(a){let s,c,f,h,d,w,x,m,C,_,B,v;const P=[oa,sa],M=[];function F(W,z){return"NDEFReader"in window?0:1}return w=F(),x=M[w]=P[w](a),{c(){s=G("main"),c=G("textarea"),f=le(),h=G("input"),d=le(),x.c(),m=le(),C=G("button"),C.textContent="DONE",D(c,"class","w-11/12 h-1/2"),c.readOnly=!0,c.value=a[0],D(h,"placeholder","title"),D(h,"class","row-start-2w-11/12 h-1/2 rounded-xl"),D(C,"class","row-start-6 w-full h-full bg-bitcoin"),D(s,"class","grid items-center justify-items-center w-full h-full grid-rows-6")},m(W,z){ie(W,s,z),R(s,c),R(s,f),R(s,h),Ze(h,a[1]),R(s,d),M[w].m(s,null),R(s,m),R(s,C),_=!0,B||(v=[Te(h,"input",a[4]),Te(C,"click",a[2])],B=!0)},p(W,[z]){(!_||z&1)&&(c.value=W[0]),z&2&&h.value!==W[1]&&Ze(h,W[1])},i(W){_||(He(x),_=!0)},o(W){Ye(x),_=!1},d(W){W&&re(s),M[w].d(),B=!1,Pt(v)}}}function aa(a,s,c){let{params:f={save:""}}=s,h="",d="",w=()=>{};er(()=>{w=async()=>{if(c(0,h=""),"NDEFReader"in window){const M=new window.NDEFReader;try{await M.scan(),M.onreading=F=>{const W=new TextDecoder;let z="";for(const J of F.message.records)z=W.decode(J.data);c(0,h=z)}}catch(F){alert(F),await w()}}},w()});const x=M=>M.split("://")[1]?M.split("://")[0]+"://":"",m=M=>M.split("://")[1]?M.split("://")[1]:M,C=M=>(M=M.toLowerCase(),M.indexOf(":")!==-1&&(M=M.split(":")[1]),M.slice(0,6)==="lnurl1"),_=M=>{if(M.split("@").length!==2)return!1;const F=M.split("@");return!!F[0].trim()&&!!F[1].trim()},B=M=>C(M)?"lnurl":_(M)?"lnAddress":"unknown",v=async()=>{if(f.save==="decoder")if(h){document.location.href=`/#/lnurl/${h}`;return}else{window.history.back();return}else if(f.save==="shorter")if(h){document.location.href=`/#/shorter/${h}`;return}else{window.history.back();return}h?(localStorage.setItem(`lnrecord${encodeURIComponent(m(h))}`,m(h)),localStorage.setItem(`info${encodeURIComponent(m(h))}`,JSON.stringify({title:d||m(h),prefix:x(h),type:B(m(h))})),document.location.href=`/#/manage/${encodeURIComponent(encodeURIComponent(m(h)))}`):document.location.href="/#/home"};function P(){d=this.value,c(1,d)}return a.$$set=M=>{"params"in M&&c(3,f=M.params)},[h,d,v,f,P]}class ca extends _t{constructor(s){super(),It(this,s,aa,la,Et,{params:3})}}function ua(a){let s,c,f;return{c(){s=G("h1"),s.textContent="404",c=le(),f=G("a"),f.textContent="home",D(f,"href","#/home")},m(h,d){ie(h,s,d),ie(h,c,d),ie(h,f,d)},p:_e,i:_e,o:_e,d(h){h&&re(s),h&&re(c),h&&re(f)}}}class fa extends _t{constructor(s){super(),It(this,s,null,ua,Et,{})}}function ha(a){let s,c,f,h,d,w,x,m,C,_,B,v,P,M;return{c(){s=G("main"),c=G("div"),f=G("button"),f.innerHTML='<img alt="back" src="paste.svg" class="row-start-2 col-start-1 w-8 h-8 rotate-90"/>',h=le(),d=G("input"),w=le(),x=G("div"),m=G("input"),C=le(),_=G("button"),_.innerHTML='<img class="w-6" alt="paste" src="paste.svg"/>',B=le(),v=G("button"),v.textContent="DONE",D(f,"class","justify-self-start"),D(d,"placeholder","title"),D(d,"class","row-start-3 w-11/12 h-full rounded-xl"),D(m,"placeholder","lnurl/ln address/rpc"),D(m,"class","w-full h-full rounded-xl"),D(x,"class","row-span-2 row-start-5 w-11/12 h-full items-center justify-items-center inline-grid grid-rows-2"),D(v,"class","row-start-7 w-full h-full bg-bitcoin"),D(c,"class","grid grid-rows-7 items-center justify-items-center w-full h-full")},m(F,W){ie(F,s,W),R(s,c),R(c,f),R(c,h),R(c,d),Ze(d,a[1]),R(c,w),R(c,x),R(x,m),Ze(m,a[0]),R(x,C),R(x,_),R(c,B),R(c,v),P||(M=[Te(f,"click",a[5]),Te(d,"input",a[6]),Te(m,"input",a[7]),Te(_,"click",a[3]),Te(v,"click",a[2])],P=!0)},p(F,[W]){W&2&&d.value!==F[1]&&Ze(d,F[1]),W&1&&m.value!==F[0]&&Ze(m,F[0])},i:_e,o:_e,d(F){F&&re(s),P=!1,Pt(M)}}}function da(a,s,c){let{params:f={record:"",title:"",shorted:""}}=s,h=f.record?decodeURIComponent(f.record):"",d=f.record?decodeURIComponent(f.title):"";const w=W=>W.split("://")[1]?W.split("://")[0]+"://":"",x=W=>W.split("://")[1]?W.split("://")[1]:W,m=W=>(W=W.toLowerCase(),W.indexOf(":")!==-1&&(W=W.split(":")[1]),W.slice(0,6)==="lnurl1"),C=W=>{if(W.split("@").length!==2)return!1;const z=W.split("@");return!!z[0].trim()&&!!z[1].trim()},_=W=>m(W)?"lnurl":C(W)?"lnAddress":"unknown",B=()=>{if(h){if(f.record)if(localStorage.removeItem(`lnrecord${x(f.record)}`),localStorage.getItem(`info${x(f.record)}`)&&x(f.record)===x(h)){let W=JSON.parse(localStorage.getItem(`info${x(f.record)}`));localStorage.removeItem(`info${x(f.record)}`),W.title=d||x(h),W.prefix=w(h),W.type=_(x(h)),localStorage.setItem(`info${encodeURIComponent(x(h))}`,JSON.stringify(W))}else localStorage.removeItem(`info${x(f.record)}`),localStorage.setItem(`info${encodeURIComponent(x(h))}`,JSON.stringify({title:d||x(h),prefix:w(h),type:_(x(h)),shorted:f.shorted?f.shorted:"false"}));else localStorage.setItem(`info${encodeURIComponent(x(h))}`,JSON.stringify({title:d||x(h),prefix:w(h),type:_(x(h)),shorted:f.shorted?f.shorted:"false"}));localStorage.setItem(`lnrecord${encodeURIComponent(x(h))}`,h),document.location.href=`/#/manage/${encodeURIComponent(encodeURIComponent(x(h)))}`}else document.location.href="/#/home"},v=async()=>{c(0,h=await navigator.clipboard.readText())},P=()=>window.history.back();function M(){d=this.value,c(1,d)}function F(){h=this.value,c(0,h)}return a.$$set=W=>{"params"in W&&c(4,f=W.params)},[h,d,B,v,f,P,M,F]}class ga extends _t{constructor(s){super(),It(this,s,da,ha,Et,{params:4})}}function xa(a){let s,c,f,h=a[12](a[0].record)+"",d,w,x,m,C,_={ctx:a,current:null,token:null,hasCatch:!0,pending:Aa,then:Ea,catch:ma,value:9,error:26};return Er(C=a[17](decodeURIComponent(a[0].record)),_),{c(){s=G("p"),c=me("decoded: "),f=G("a"),d=me(h),x=le(),m=Ft(),_.block.c(),D(f,"href",w=a[12](a[0].record)),D(f,"class","text-bitcoin")},m(B,v){ie(B,s,v),R(s,c),R(s,f),R(f,d),ie(B,x,v),ie(B,m,v),_.block.m(B,_.anchor=v),_.mount=()=>m.parentNode,_.anchor=m},p(B,v){a=B,v&1&&h!==(h=a[12](a[0].record)+"")&&Je(d,h),v&1&&w!==(w=a[12](a[0].record))&&D(f,"href",w),_.ctx=a,v&1&&C!==(C=a[17](decodeURIComponent(a[0].record)))&&Er(C,_)||Di(_,a,v)},d(B){B&&re(s),B&&re(x),B&&re(m),_.block.d(B),_.token=null,_=null}}}function wa(a){let s,c,f,h,d,w,x,m={ctx:a,current:null,token:null,hasCatch:!0,pending:Ia,then:ba,catch:Ca,value:9,error:26};return Er(x=a[16](decodeURIComponent(a[0].record)),m),{c(){s=G("p"),c=me("decoded: "),f=G("a"),h=me(a[8]),d=le(),w=Ft(),m.block.c(),D(f,"href",a[8]),D(f,"class","text-bitcoin")},m(C,_){ie(C,s,_),R(s,c),R(s,f),R(f,h),ie(C,d,_),ie(C,w,_),m.block.m(C,m.anchor=_),m.mount=()=>w.parentNode,m.anchor=w},p(C,_){a=C,_&256&&Je(h,a[8]),_&256&&D(f,"href",a[8]),m.ctx=a,_&1&&x!==(x=a[16](decodeURIComponent(a[0].record)))&&Er(x,m)||Di(m,a,_)},d(C){C&&re(s),C&&re(d),C&&re(w),m.block.d(C),m.token=null,m=null}}}function pa(a){let s;function c(d,w){return d[6]==="lnurlw"?ya:_a}let f=c(a),h=f(a);return{c(){h.c(),s=Ft()},m(d,w){h.m(d,w),ie(d,s,w)},p(d,w){f===(f=c(d))&&h?h.p(d,w):(h.d(1),h=f(d),h&&(h.c(),h.m(s.parentNode,s)))},d(d){h.d(d),d&&re(s)}}}function ma(a){let s;return{c(){s=G("h3"),s.textContent="Couldn't fetch data",D(s,"class","text-center")},m(c,f){ie(c,s,f)},p:_e,d(c){c&&re(s)}}}function Ea(a){let s,c,f,h=a[9].callback+"",d,w,x,m,C,_=a[9].tag+"",B,v,P,M,F=a[9].k1+"",W,z,J,Y,Q=(a[9].minWithdrawable||a[9].min)+"",$,U,se,k,xe=(a[9].maxWithdrawable||a[9].max)+"",pe,ae,ne,Ae,q=decodeURIComponent(a[9].defaultDescription)+"",Ne;return{c(){s=G("p"),c=me("callback: "),f=G("a"),d=me(h),x=le(),m=G("p"),C=me("tag: "),B=me(_),v=le(),P=G("p"),M=me("k1: "),W=me(F),z=le(),J=G("p"),Y=me("min: "),$=me(Q),U=le(),se=G("p"),k=me("max: "),pe=me(xe),ae=le(),ne=G("p"),Ae=me("description: "),Ne=me(q),D(f,"href",w=a[9].callback),D(f,"class","text-bitcoin")},m(oe,De){ie(oe,s,De),R(s,c),R(s,f),R(f,d),ie(oe,x,De),ie(oe,m,De),R(m,C),R(m,B),ie(oe,v,De),ie(oe,P,De),R(P,M),R(P,W),ie(oe,z,De),ie(oe,J,De),R(J,Y),R(J,$),ie(oe,U,De),ie(oe,se,De),R(se,k),R(se,pe),ie(oe,ae,De),ie(oe,ne,De),R(ne,Ae),R(ne,Ne)},p(oe,De){De&1&&h!==(h=oe[9].callback+"")&&Je(d,h),De&1&&w!==(w=oe[9].callback)&&D(f,"href",w),De&1&&_!==(_=oe[9].tag+"")&&Je(B,_),De&1&&F!==(F=oe[9].k1+"")&&Je(W,F),De&1&&Q!==(Q=(oe[9].minWithdrawable||oe[9].min)+"")&&Je($,Q),De&1&&xe!==(xe=(oe[9].maxWithdrawable||oe[9].max)+"")&&Je(pe,xe),De&1&&q!==(q=decodeURIComponent(oe[9].defaultDescription)+"")&&Je(Ne,q)},d(oe){oe&&re(s),oe&&re(x),oe&&re(m),oe&&re(v),oe&&re(P),oe&&re(z),oe&&re(J),oe&&re(U),oe&&re(se),oe&&re(ae),oe&&re(ne)}}}function Aa(a){let s;return{c(){s=G("p"),s.textContent="fetching data..."},m(c,f){ie(c,s,f)},p:_e,d(c){c&&re(s)}}}function Ca(a){let s;return{c(){s=G("h3"),s.textContent="Couldn't fetch data",D(s,"class","text-center")},m(c,f){ie(c,s,f)},p:_e,d(c){c&&re(s)}}}function ba(a){let s,c,f,h=a[9].callback+"",d,w,x,m,C,_=a[9].minSendable/1e3+"",B,v,P,M,F,W=a[9].maxSendable/1e3+"",z,J,Y,Q,$,U=a[9].commentAllowed?"allowed":"not allowed",se;return{c(){s=G("p"),c=me("callback: "),f=G("a"),d=me(h),x=le(),m=G("p"),C=me("min: "),B=me(_),v=me(" sats"),P=le(),M=G("p"),F=me("max: "),z=me(W),J=me(" sats"),Y=le(),Q=G("p"),$=me("comment: "),se=me(U),D(f,"href",w=a[9].callback),D(f,"class","text-bitcoin")},m(k,xe){ie(k,s,xe),R(s,c),R(s,f),R(f,d),ie(k,x,xe),ie(k,m,xe),R(m,C),R(m,B),R(m,v),ie(k,P,xe),ie(k,M,xe),R(M,F),R(M,z),R(M,J),ie(k,Y,xe),ie(k,Q,xe),R(Q,$),R(Q,se)},p(k,xe){xe&1&&h!==(h=k[9].callback+"")&&Je(d,h),xe&1&&w!==(w=k[9].callback)&&D(f,"href",w),xe&1&&_!==(_=k[9].minSendable/1e3+"")&&Je(B,_),xe&1&&W!==(W=k[9].maxSendable/1e3+"")&&Je(z,W),xe&1&&U!==(U=k[9].commentAllowed?"allowed":"not allowed")&&Je(se,U)},d(k){k&&re(s),k&&re(x),k&&re(m),k&&re(P),k&&re(M),k&&re(Y),k&&re(Q)}}}function Ia(a){let s;return{c(){s=G("p"),s.textContent="fetching data..."},m(c,f){ie(c,s,f)},p:_e,d(c){c&&re(s)}}}function _a(a){let s,c,f=a[9].id+"",h,d,w,x,m=a[9].wallet+"",C,_,B,v,P=a[9].min+"",M,F,W,z,J,Y=a[9].max+"",Q,$,U,se,k,xe=a[9].comment_chars+"",pe,ae,ne,Ae,q,Ne=a[12](a[9].lnurl)+"",oe,De,et,ze=localStorage.getItem(`user${a[0].record}`),ye,he=ze&&Es(a);return{c(){s=G("p"),c=me("id: "),h=me(f),d=le(),w=G("p"),x=me("wallet: "),C=me(m),_=le(),B=G("p"),v=me("min: "),M=me(P),F=me(" sats"),W=le(),z=G("p"),J=me("max: "),Q=me(Y),$=me(" sats"),U=le(),se=G("p"),k=me("comment length: "),pe=me(xe),ae=le(),ne=G("p"),Ae=me("decoded: "),q=G("a"),oe=me(Ne),et=le(),he&&he.c(),ye=Ft(),D(q,"href",De=a[12](a[9].lnurl)),D(q,"class","text-bitcoin")},m(fe,we){ie(fe,s,we),R(s,c),R(s,h),ie(fe,d,we),ie(fe,w,we),R(w,x),R(w,C),ie(fe,_,we),ie(fe,B,we),R(B,v),R(B,M),R(B,F),ie(fe,W,we),ie(fe,z,we),R(z,J),R(z,Q),R(z,$),ie(fe,U,we),ie(fe,se,we),R(se,k),R(se,pe),ie(fe,ae,we),ie(fe,ne,we),R(ne,Ae),R(ne,q),R(q,oe),ie(fe,et,we),he&&he.m(fe,we),ie(fe,ye,we)},p(fe,we){we&512&&f!==(f=fe[9].id+"")&&Je(h,f),we&512&&m!==(m=fe[9].wallet+"")&&Je(C,m),we&512&&P!==(P=fe[9].min+"")&&Je(M,P),we&512&&Y!==(Y=fe[9].max+"")&&Je(Q,Y),we&512&&xe!==(xe=fe[9].comment_chars+"")&&Je(pe,xe),we&512&&Ne!==(Ne=fe[12](fe[9].lnurl)+"")&&Je(oe,Ne),we&512&&De!==(De=fe[12](fe[9].lnurl))&&D(q,"href",De),we&1&&(ze=localStorage.getItem(`user${fe[0].record}`)),ze?he?he.p(fe,we):(he=Es(fe),he.c(),he.m(ye.parentNode,ye)):he&&(he.d(1),he=null)},d(fe){fe&&re(s),fe&&re(d),fe&&re(w),fe&&re(_),fe&&re(B),fe&&re(W),fe&&re(z),fe&&re(U),fe&&re(se),fe&&re(ae),fe&&re(ne),fe&&re(et),he&&he.d(fe),fe&&re(ye)}}}function ya(a){let s,c,f,h=a[9].id+"",d,w,x,m,C=a[9].wallet+"",_,B,v,P,M=a[9].min_withdrawable+"",F,W,z,J,Y,Q=a[9].max_withdrawable+"",$,U,se,k,xe,pe=a[9].wait_time+"",ae,ne,Ae,q,Ne,oe=a[12](a[9].lnurl)+"",De,et,ze,ye,he={ctx:a,current:null,token:null,hasCatch:!1,pending:Na,then:Ta,catch:Sa,value:25};Er(a[18](),he);let fe=a[1]&&As(a);return{c(){he.block.c(),s=le(),c=G("p"),f=me("id: "),d=me(h),w=le(),x=G("p"),m=me("wallet: "),_=me(C),B=le(),v=G("p"),P=me("min: "),F=me(M),W=me(" sats"),z=le(),J=G("p"),Y=me("max: "),$=me(Q),U=me(" sats"),se=le(),k=G("p"),xe=me("wait time: "),ae=me(pe),ne=le(),Ae=G("p"),q=me("decoded: "),Ne=G("a"),De=me(oe),ze=le(),fe&&fe.c(),ye=Ft(),D(Ne,"href",et=a[12](a[9].lnurl)),D(Ne,"class","text-bitcoin")},m(we,Ve){he.block.m(we,he.anchor=Ve),he.mount=()=>s.parentNode,he.anchor=s,ie(we,s,Ve),ie(we,c,Ve),R(c,f),R(c,d),ie(we,w,Ve),ie(we,x,Ve),R(x,m),R(x,_),ie(we,B,Ve),ie(we,v,Ve),R(v,P),R(v,F),R(v,W),ie(we,z,Ve),ie(we,J,Ve),R(J,Y),R(J,$),R(J,U),ie(we,se,Ve),ie(we,k,Ve),R(k,xe),R(k,ae),ie(we,ne,Ve),ie(we,Ae,Ve),R(Ae,q),R(Ae,Ne),R(Ne,De),ie(we,ze,Ve),fe&&fe.m(we,Ve),ie(we,ye,Ve)},p(we,Ve){a=we,Di(he,a,Ve),Ve&512&&h!==(h=a[9].id+"")&&Je(d,h),Ve&512&&C!==(C=a[9].wallet+"")&&Je(_,C),Ve&512&&M!==(M=a[9].min_withdrawable+"")&&Je(F,M),Ve&512&&Q!==(Q=a[9].max_withdrawable+"")&&Je($,Q),Ve&512&&pe!==(pe=a[9].wait_time+"")&&Je(ae,pe),Ve&512&&oe!==(oe=a[12](a[9].lnurl)+"")&&Je(De,oe),Ve&512&&et!==(et=a[12](a[9].lnurl))&&D(Ne,"href",et),a[1]?fe?fe.p(a,Ve):(fe=As(a),fe.c(),fe.m(ye.parentNode,ye)):fe&&(fe.d(1),fe=null)},d(we){he.block.d(we),he.token=null,he=null,we&&re(s),we&&re(c),we&&re(w),we&&re(x),we&&re(B),we&&re(v),we&&re(z),we&&re(J),we&&re(se),we&&re(k),we&&re(ne),we&&re(Ae),we&&re(ze),fe&&fe.d(we),we&&re(ye)}}}function Es(a){let s,c,f,h=`${a[2]}/wallet?usr=${JSON.parse(localStorage.getItem(`user${a[0].record}`)).data.id}`,d,w;return{c(){s=G("p"),c=me("link: "),f=G("a"),d=me(h),D(f,"class","text-bitcoin"),D(f,"href",w=a[2]+"/wallet?usr="+JSON.parse(localStorage.getItem(`user${a[0].record}`)).data.id)},m(x,m){ie(x,s,m),R(s,c),R(s,f),R(f,d)},p(x,m){m&5&&h!==(h=`${x[2]}/wallet?usr=${JSON.parse(localStorage.getItem(`user${x[0].record}`)).data.id}`)&&Je(d,h),m&5&&w!==(w=x[2]+"/wallet?usr="+JSON.parse(localStorage.getItem(`user${x[0].record}`)).data.id)&&D(f,"href",w)},d(x){x&&re(s)}}}function Sa(a){return{c:_e,m:_e,p:_e,d:_e}}function Ta(a){let s,c,f=a[25].used+"",h,d,w=a[9].uses+"",x;return{c(){s=G("p"),c=me("used: "),h=me(f),d=me(" / "),x=me(w)},m(m,C){ie(m,s,C),R(s,c),R(s,h),R(s,d),R(s,x)},p(m,C){C&512&&w!==(w=m[9].uses+"")&&Je(x,w)},d(m){m&&re(s)}}}function Na(a){let s;return{c(){s=G("p"),s.textContent="fetching data..."},m(c,f){ie(c,s,f)},p:_e,d(c){c&&re(s)}}}function As(a){let s,c;return{c(){s=G("textarea"),D(s,"class","w-full"),s.readOnly=!0,s.value=c="invoice: "+a[1]},m(f,h){ie(f,s,h)},p(f,h){h&2&&c!==(c="invoice: "+f[1])&&(s.value=c)},d(f){f&&re(s)}}}function Ra(a){let s,c,f;return{c(){s=G("button"),s.textContent="short it",s.disabled=!0,D(s,"class","row-start-6 col-start-2 inline-grid items-center w-3/4 h-12 bg-bitcoin rounded-xl opacity-30")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[15]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function Oa(a){let s,c,f;return{c(){s=G("button"),s.textContent="short it",D(s,"class","row-start-6 col-start-2 inline-grid items-center w-3/4 h-12 bg-bitcoin rounded-xl")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[15]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function Ba(a){let s;return{c(){s=G("button"),s.textContent="refill",s.disabled=!0,D(s,"class","row-start-7 col-start-1 rounded-xl bg-bitcoin w-3/4 h-12 text-center opacity-30")},m(c,f){ie(c,s,f)},p:_e,d(c){c&&re(s)}}}function Ma(a){let s,c,f;return{c(){s=G("button"),s.textContent="refill",D(s,"class","row-start-7 col-start-1 rounded-xl bg-bitcoin w-3/4 h-12 text-center")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",function(){Zr(window.location.href=`/#/payment/${a[1]}/${(Number(a[9].uses)-Number(a[9].used))*Number(a[9].max_withdrawable)+(Number(a[9].uses)-Number(a[9].used)>0?5:0)}/${encodeURIComponent(a[0].record)}`)&&(window.location.href=`/#/payment/${a[1]}/${(Number(a[9].uses)-Number(a[9].used))*Number(a[9].max_withdrawable)+(Number(a[9].uses)-Number(a[9].used)>0?5:0)}/${encodeURIComponent(a[0].record)}`).apply(this,arguments)}),c=!0)},p(h,d){a=h},d(h){h&&re(s),c=!1,f()}}}function Da(a){let s,c,f;return{c(){s=G("button"),s.textContent="delete",D(s,"class","row-start-7 col-start-2 rounded-xl bg-red-900 w-3/4 h-12")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[21]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function va(a){let s,c,f;return{c(){s=G("button"),s.textContent="delete",D(s,"class","row-start-7 col-start-2 rounded-xl bg-red-900 w-3/4 h-12")},m(h,d){ie(h,s,d),c||(f=Te(s,"click",a[19]),c=!0)},p:_e,d(h){h&&re(s),c=!1,f()}}}function ka(a){let s,c,f,h,d,w,x,m,C,_,B,v,P,M,F,W,z,J,Y,Q,$,U,se,k,xe,pe,ae,ne,Ae,q,Ne,oe,De,et,ze;function ye(Ee,je){if(je&1&&(Q=null),je&1&&($=null),Ee[9])return pa;if(Q==null&&(Q=!!Ee[13](decodeURIComponent(Ee[0].record))),Q)return wa;if($==null&&($=!!Ee[14](decodeURIComponent(Ee[0].record))),$)return xa}let he=ye(a,-1),fe=he&&he(a);k=new Ir({props:{value:a[0].record}});function we(Ee,je){return je&129&&(ne=null),ne==null&&(ne=!!(Ee[14](Ee[0].record)&&Ee[7]!=="true")),ne?Oa:Ra}let Ve=we(a,-1),Ce=Ve(a);function xn(Ee,je){return Ee[1]?Ma:Ba}let lt=xn(a),ht=lt(a);function Qt(Ee,je){return Ee[3]&&Ee[2]?va:Da}let gt=Qt(a),Mt=gt(a);return{c(){s=G("main"),c=G("div"),f=G("textarea"),d=le(),w=G("div"),x=G("div"),m=G("h1"),C=me("title: "),_=me(a[5]),B=le(),v=G("h1"),P=me("prefix: "),M=me(a[4]),F=le(),W=G("h1"),z=me("type: "),J=me(a[6]),Y=le(),fe&&fe.c(),U=le(),se=G("div"),Rt(k.$$.fragment),xe=le(),pe=G("button"),pe.textContent="edit",ae=le(),Ce.c(),Ae=le(),ht.c(),q=le(),Mt.c(),Ne=le(),oe=G("button"),oe.textContent="DONE",f.readOnly=!0,D(f,"class","w-full"),f.value=h=decodeURIComponent(a[0].record),D(c,"class","row-start-1 col-span-2 w-11/12 rounded-xl"),D(x,"class","overflow-x-scroll max-h-16"),D(w,"class","row-start-2 col-span-2 row-span-3 w-11/12 border border-bitcoin rounded-xl gap-6 p-4 h-full items-center inline-grid grid-cols-1 overflow-y-scroll"),D(se,"class","row-start-5 col-start-1 col-span-2 bg-none border border-bitcoin rounded-xl w-11/12 h-16 mt-2 p-2 inline-flex items-center justify-center"),D(pe,"class","row-start-6 col-start-1 rounded-xl bg-gray-700 w-3/4 h-12"),D(oe,"class","row-start-8 col-span-2 w-full h-full bg-bitcoin"),D(s,"class","grid grid-rows-8 grid-cols-2 justify-center items-center")},m(Ee,je){ie(Ee,s,je),R(s,c),R(c,f),R(s,d),R(s,w),R(w,x),R(x,m),R(m,C),R(m,_),R(w,B),R(w,v),R(v,P),R(v,M),R(w,F),R(w,W),R(W,z),R(W,J),R(w,Y),fe&&fe.m(w,null),R(s,U),R(s,se),Ct(k,se,null),R(s,xe),R(s,pe),R(s,ae),Ce.m(s,null),R(s,Ae),ht.m(s,null),R(s,q),Mt.m(s,null),R(s,Ne),R(s,oe),De=!0,et||(ze=[Te(pe,"click",a[20]),Te(oe,"click",a[22])],et=!0)},p(Ee,[je]){(!De||je&1&&h!==(h=decodeURIComponent(Ee[0].record)))&&(f.value=h),(!De||je&32)&&Je(_,Ee[5]),(!De||je&16)&&Je(M,Ee[4]),(!De||je&64)&&Je(J,Ee[6]),he===(he=ye(Ee,je))&&fe?fe.p(Ee,je):(fe&&fe.d(1),fe=he&&he(Ee),fe&&(fe.c(),fe.m(w,null)));const yt={};je&1&&(yt.value=Ee[0].record),k.$set(yt),Ve===(Ve=we(Ee,je))&&Ce?Ce.p(Ee,je):(Ce.d(1),Ce=Ve(Ee),Ce&&(Ce.c(),Ce.m(s,Ae))),lt===(lt=xn(Ee))&&ht?ht.p(Ee,je):(ht.d(1),ht=lt(Ee),ht&&(ht.c(),ht.m(s,q))),gt===(gt=Qt(Ee))&&Mt?Mt.p(Ee,je):(Mt.d(1),Mt=gt(Ee),Mt&&(Mt.c(),Mt.m(s,Ne)))},i(Ee){De||(He(k.$$.fragment,Ee),De=!0)},o(Ee){Ye(k.$$.fragment,Ee),De=!1},d(Ee){Ee&&re(s),fe&&fe.d(),bt(k),Ce.d(),ht.d(),Mt.d(),et=!1,Pt(ze)}}}function La(a,s,c){const{Buffer:f}=_r;let{params:h={}}=s,d,w,x,m,C,_,B,v;if(localStorage.getItem(`info${h.record}`)){let ne=JSON.parse(localStorage.getItem(`info${h.record}`));d=ne.data,w=ne.invoice,x=ne.server,m=ne.key,C=ne.prefix?ne.prefix:"",_=ne.title?ne.title:"",B=ne.type?ne.type:"",v=ne.shorted?ne.shorted:""}const P=ne=>{ne&&(localStorage.removeItem(`lnrecord${h.record}`),localStorage.removeItem(`info${h.record}`)),window.location.href="/#/home/"},M=()=>{window.location.href=`/#/manual/${encodeURIComponent(C+h.record)}/${encodeURIComponent(_)}`},F=ne=>{try{let Ae=ne.split(/[:=]/);ne=Ae.length===2?Ae[1]:ne;let q=Lt.decode(ne,1500),Ne=Lt.fromWords(q.words);return f.from(Ne).toString()}catch(Ae){return`not valid LNURL - ${Ae}`}},W=ne=>{let Ae=Lt.toWords(f.from(ne,"utf8"));return Lt.encode("lnurl",Ae,1500)},z=ne=>{if(ne.split("@").length!==2)return!1;const Ae=ne.split("@");return!!Ae[0].trim()&&!!Ae[1].trim()},J=ne=>{try{let Ae=ne.split(/[:=]/);ne=Ae.length===2?Ae[1]:ne;let q=Lt.decode(ne,1500),Ne=Lt.fromWords(q.words);return!!f.from(Ne).toString()}catch{return!1}},Y=async()=>{const ne=await(await fetch("https://gotiny.cc/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:F(h.record)})})).json();document.location.href=`/#/manual/${W(`https://gotiny.cc/${ne[0].code}`)}/${encodeURIComponent(_)} - short/true`};let Q;const $=async ne=>(c(8,Q=`https://${ne.split("@")[1]}/.well-known/lnurlp/${ne.split("@")[0]}`),await(await fetch(Q)).json()),U=async ne=>await(await fetch(F(ne))).json(),se=async()=>{let ne=await(await fetch(`${x}/withdraw/api/v1/links/${d.id}`,{method:"GET",headers:{"Content-Type":"application/json","X-Api-Key":m}})).json();return c(9,d.used=ne.used,d),ne},k=async()=>{await(await fetch(`${x}/withdraw/api/v1/links/${d.id}`,{method:"DELETE",headers:{"Content-Type":"application/json","X-Api-Key":m}})).json(),P(!0)},xe=()=>M(),pe=()=>P(!0),ae=()=>document.location.href="/#/home";return a.$$set=ne=>{"params"in ne&&c(0,h=ne.params)},[h,w,x,m,C,_,B,v,Q,d,P,M,F,z,J,Y,$,U,se,k,xe,pe,ae]}class Pa extends _t{constructor(s){super(),It(this,s,La,ka,Et,{params:0})}}var Ie;(function(a){a[a.QR_CODE=0]="QR_CODE",a[a.AZTEC=1]="AZTEC",a[a.CODABAR=2]="CODABAR",a[a.CODE_39=3]="CODE_39",a[a.CODE_93=4]="CODE_93",a[a.CODE_128=5]="CODE_128",a[a.DATA_MATRIX=6]="DATA_MATRIX",a[a.MAXICODE=7]="MAXICODE",a[a.ITF=8]="ITF",a[a.EAN_13=9]="EAN_13",a[a.EAN_8=10]="EAN_8",a[a.PDF_417=11]="PDF_417",a[a.RSS_14=12]="RSS_14",a[a.RSS_EXPANDED=13]="RSS_EXPANDED",a[a.UPC_A=14]="UPC_A",a[a.UPC_E=15]="UPC_E",a[a.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ie||(Ie={}));var Cs=new Map([[Ie.QR_CODE,"QR_CODE"],[Ie.AZTEC,"AZTEC"],[Ie.CODABAR,"CODABAR"],[Ie.CODE_39,"CODE_39"],[Ie.CODE_93,"CODE_93"],[Ie.CODE_128,"CODE_128"],[Ie.DATA_MATRIX,"DATA_MATRIX"],[Ie.MAXICODE,"MAXICODE"],[Ie.ITF,"ITF"],[Ie.EAN_13,"EAN_13"],[Ie.EAN_8,"EAN_8"],[Ie.PDF_417,"PDF_417"],[Ie.RSS_14,"RSS_14"],[Ie.RSS_EXPANDED,"RSS_EXPANDED"],[Ie.UPC_A,"UPC_A"],[Ie.UPC_E,"UPC_E"],[Ie.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),bs;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.URL=1]="URL"})(bs||(bs={}));function Fa(a){return Object.values(Ie).includes(a)}var Yr;(function(a){a[a.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",a[a.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Yr||(Yr={}));var Ua=function(){function a(){}return a.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",a.SCAN_DEFAULT_FPS=2,a.DEFAULT_DISABLE_FLIP=!1,a.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,a.DEFAULT_SUPPORTED_SCAN_TYPE=[Yr.SCAN_TYPE_CAMERA,Yr.SCAN_TYPE_FILE],a}(),Ws=function(){function a(s,c){this.format=s,this.formatName=c}return a.prototype.toString=function(){return this.formatName},a.create=function(s){if(!Cs.has(s))throw s+" not in html5QrcodeSupportedFormatsTextMap";return new a(s,Cs.get(s))},a}(),Is=function(){function a(){}return a.createFromText=function(s){var c={text:s};return{decodedText:s,result:c}},a.createFromQrcodeResult=function(s){return{decodedText:s.text,result:s}},a}(),Ti;(function(a){a[a.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",a[a.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",a[a.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Ti||(Ti={}));var Va=function(){function a(){}return a.createFrom=function(s){return{errorMessage:s,type:Ti.UNKWOWN_ERROR}},a}(),Ha=function(){function a(s){this.verbose=s}return a.prototype.log=function(s){this.verbose&&console.log(s)},a.prototype.warn=function(s){this.verbose&&console.warn(s)},a.prototype.logError=function(s,c){(this.verbose||c===!0)&&console.error(s)},a.prototype.logErrors=function(s){if(s.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(s)},a}();function xr(a){return typeof a>"u"||a===null}var hr=function(){function a(){}return a.codeParseError=function(s){return"QR code parse error, error = "+s},a.errorGettingUserMedia=function(s){return"Error getting userMedia, error = "+s},a.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},a.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},a.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},a.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},a}(),Ys=function(){function a(){}return a.isMediaStreamConstraintsValid=function(s,c){if(typeof s!="object"){var f=typeof s;return c.logError("videoConstraints should be of type object, the "+("object passed is of type "+f+"."),!0),!1}for(var h=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],d=new Set(h),w=Object.keys(s),x=0,m=w;x<m.length;x++){var C=m[x];if(d.has(C))return c.logError(C+" is not supported videoConstaints.",!0),!1}return!0},a}(),ct={exports:{}};(function(a,s){(function(c,f){f(s)})(fr,function(c){/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation. All rights reserved.
	    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	    this file except in compliance with the License. You may obtain a copy of the
	    License at http://www.apache.org/licenses/LICENSE-2.0

	    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	    MERCHANTABLITY OR NON-INFRINGEMENT.

	    See the Apache Version 2.0 License for specific language governing permissions
	    and limitations under the License.
	    ***************************************************************************** */var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,e){b.__proto__=e}||function(b,e){for(var t in e)e.hasOwnProperty(t)&&(b[t]=e[t])};function h(b,e){f(b,e);function t(){this.constructor=b}b.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function d(b,e){var t=Object.setPrototypeOf;t?t(b,e):b.__proto__=e}function w(b,e){e===void 0&&(e=b.constructor);var t=Error.captureStackTrace;t&&t(b,e)}var x=function(b){h(e,b);function e(t){var n=this.constructor,r=b.call(this,t)||this;return Object.defineProperty(r,"name",{value:n.name,enumerable:!1}),d(r,n.prototype),w(r),r}return e}(Error);class m extends x{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}m.kind="Exception";class C extends m{}C.kind="ArgumentException";class _ extends m{}_.kind="IllegalArgumentException";class B{constructor(e){if(this.binarizer=e,e===null)throw new _("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,n,r){const i=this.binarizer.getLuminanceSource().crop(e,t,n,r);return new B(this.binarizer.createBinarizer(i))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new B(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new B(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class v extends m{static getChecksumInstance(){return new v}}v.kind="ChecksumException";class P{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class M{static arraycopy(e,t,n,r,i){for(;i--;)n[r++]=e[t++]}static currentTimeMillis(){return Date.now()}}class F extends m{}F.kind="IndexOutOfBoundsException";class W extends F{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}W.kind="ArrayIndexOutOfBoundsException";class z{static fill(e,t){for(let n=0,r=e.length;n<r;n++)e[n]=t}static fillWithin(e,t,n,r){z.rangeCheck(e.length,t,n);for(let i=t;i<n;i++)e[i]=r}static rangeCheck(e,t,n){if(t>n)throw new _("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new W(t);if(n>e)throw new W(n)}static asList(...e){return e}static create(e,t,n){return Array.from({length:e}).map(i=>Array.from({length:t}).fill(n))}static createInt32Array(e,t,n){return Array.from({length:e}).map(i=>Int32Array.from({length:t}).fill(n))}static equals(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}static hashCode(e){if(e===null)return 0;let t=1;for(const n of e)t=31*t+n;return t}static fillUint8Array(e,t){for(let n=0;n!==e.length;n++)e[n]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)}static copyOfRange(e,t,n){const r=n-t,i=new Int32Array(r);return M.arraycopy(e,t,i,0,r),i}static binarySearch(e,t,n){n===void 0&&(n=z.numberComparator);let r=0,i=e.length-1;for(;r<=i;){const o=i+r>>1,l=n(t,e[o]);if(l>0)r=o+1;else if(l<0)i=o-1;else return o}return-r-1}static numberComparator(e,t){return e-t}}class J{static numberOfTrailingZeros(e){let t;if(e===0)return 32;let n=31;return t=e<<16,t!==0&&(n-=16,e=t),t=e<<8,t!==0&&(n-=8,e=t),t=e<<4,t!==0&&(n-=4,e=t),t=e<<2,t!==0&&(n-=2,e=t),n-(e<<1>>>31)}static numberOfLeadingZeros(e){if(e===0)return 32;let t=1;return e>>>16===0&&(t+=16,e<<=16),e>>>24===0&&(t+=8,e<<=8),e>>>28===0&&(t+=4,e<<=4),e>>>30===0&&(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}J.MIN_VALUE_32_BITS=-2147483648,J.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Y{constructor(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=Y.makeArray(e):this.bits=t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>this.bits.length*32){const t=Y.makeArray(e);M.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0}set(e){this.bits[Math.floor(e/32)]|=1<<(e&31)}flip(e){this.bits[Math.floor(e/32)]^=1<<(e&31)}getNextSet(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),i=n[r];i&=~((1<<(e&31))-1);const o=n.length;for(;i===0;){if(++r===o)return t;i=n[r]}const l=r*32+J.numberOfTrailingZeros(i);return l>t?t:l}getNextUnset(e){const t=this.size;if(e>=t)return t;const n=this.bits;let r=Math.floor(e/32),i=~n[r];i&=~((1<<(e&31))-1);const o=n.length;for(;i===0;){if(++r===o)return t;i=~n[r]}const l=r*32+J.numberOfTrailingZeros(i);return l>t?t:l}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new _;if(t===e)return;t--;const n=Math.floor(e/32),r=Math.floor(t/32),i=this.bits;for(let o=n;o<=r;o++){const l=o>n?0:e&31,u=o<r?31:t&31,g=(2<<u)-(1<<l);i[o]|=g}}clear(){const e=this.bits.length,t=this.bits;for(let n=0;n<e;n++)t[n]=0}isRange(e,t,n){if(t<e||e<0||t>this.size)throw new _;if(t===e)return!0;t--;const r=Math.floor(e/32),i=Math.floor(t/32),o=this.bits;for(let l=r;l<=i;l++){const u=l>r?0:e&31,g=l<i?31:t&31,A=(2<<g)-(1<<u)&4294967295;if((o[l]&A)!==(n?A:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(e,t){if(t<0||t>32)throw new _("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let n=t;n>0;n--)this.appendBit((e>>n-1&1)===1)}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let n=0;n<t;n++)this.appendBit(e.get(n))}xor(e){if(this.size!==e.size)throw new _("Sizes don't match");const t=this.bits;for(let n=0,r=t.length;n<r;n++)t[n]^=e.bits[n]}toBytes(e,t,n,r){for(let i=0;i<r;i++){let o=0;for(let l=0;l<8;l++)this.get(e)&&(o|=1<<7-l),e++;t[n+i]=o}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,r=this.bits;for(let i=0;i<n;i++){let o=r[i];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[t-i]=o}if(this.size!==n*32){const i=n*32-this.size;let o=e[0]>>>i;for(let l=1;l<n;l++){const u=e[l];o|=u<<32-i,e[l-1]=o,o=u>>>i}e[n-1]=o}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof Y))return!1;const t=e;return this.size===t.size&&z.equals(this.bits,t.bits)}hashCode(){return 31*this.size+z.hashCode(this.bits)}toString(){let e="";for(let t=0,n=this.size;t<n;t++)(t&7)===0&&(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new Y(this.size,this.bits.slice())}}var Q;(function(b){b[b.OTHER=0]="OTHER",b[b.PURE_BARCODE=1]="PURE_BARCODE",b[b.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",b[b.TRY_HARDER=3]="TRY_HARDER",b[b.CHARACTER_SET=4]="CHARACTER_SET",b[b.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",b[b.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",b[b.ASSUME_GS1=7]="ASSUME_GS1",b[b.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",b[b.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",b[b.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Q||(Q={}));var $=Q;class U extends m{static getFormatInstance(){return new U}}U.kind="FormatException";var se;(function(b){b[b.Cp437=0]="Cp437",b[b.ISO8859_1=1]="ISO8859_1",b[b.ISO8859_2=2]="ISO8859_2",b[b.ISO8859_3=3]="ISO8859_3",b[b.ISO8859_4=4]="ISO8859_4",b[b.ISO8859_5=5]="ISO8859_5",b[b.ISO8859_6=6]="ISO8859_6",b[b.ISO8859_7=7]="ISO8859_7",b[b.ISO8859_8=8]="ISO8859_8",b[b.ISO8859_9=9]="ISO8859_9",b[b.ISO8859_10=10]="ISO8859_10",b[b.ISO8859_11=11]="ISO8859_11",b[b.ISO8859_13=12]="ISO8859_13",b[b.ISO8859_14=13]="ISO8859_14",b[b.ISO8859_15=14]="ISO8859_15",b[b.ISO8859_16=15]="ISO8859_16",b[b.SJIS=16]="SJIS",b[b.Cp1250=17]="Cp1250",b[b.Cp1251=18]="Cp1251",b[b.Cp1252=19]="Cp1252",b[b.Cp1256=20]="Cp1256",b[b.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",b[b.UTF8=22]="UTF8",b[b.ASCII=23]="ASCII",b[b.Big5=24]="Big5",b[b.GB18030=25]="GB18030",b[b.EUC_KR=26]="EUC_KR"})(se||(se={}));class k{constructor(e,t,n,...r){this.valueIdentifier=e,this.name=n,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=r,k.VALUE_IDENTIFIER_TO_ECI.set(e,this),k.NAME_TO_ECI.set(n,this);const i=this.values;for(let o=0,l=i.length;o!==l;o++){const u=i[o];k.VALUES_TO_ECI.set(u,this)}for(const o of r)k.NAME_TO_ECI.set(o,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new U("incorect value");const t=k.VALUES_TO_ECI.get(e);if(t===void 0)throw new U("incorect value");return t}static getCharacterSetECIByName(e){const t=k.NAME_TO_ECI.get(e);if(t===void 0)throw new U("incorect value");return t}equals(e){if(!(e instanceof k))return!1;const t=e;return this.getName()===t.getName()}}k.VALUE_IDENTIFIER_TO_ECI=new Map,k.VALUES_TO_ECI=new Map,k.NAME_TO_ECI=new Map,k.Cp437=new k(se.Cp437,Int32Array.from([0,2]),"Cp437"),k.ISO8859_1=new k(se.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),k.ISO8859_2=new k(se.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),k.ISO8859_3=new k(se.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),k.ISO8859_4=new k(se.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),k.ISO8859_5=new k(se.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),k.ISO8859_6=new k(se.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),k.ISO8859_7=new k(se.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),k.ISO8859_8=new k(se.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),k.ISO8859_9=new k(se.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),k.ISO8859_10=new k(se.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),k.ISO8859_11=new k(se.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),k.ISO8859_13=new k(se.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),k.ISO8859_14=new k(se.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),k.ISO8859_15=new k(se.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),k.ISO8859_16=new k(se.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),k.SJIS=new k(se.SJIS,20,"SJIS","Shift_JIS"),k.Cp1250=new k(se.Cp1250,21,"Cp1250","windows-1250"),k.Cp1251=new k(se.Cp1251,22,"Cp1251","windows-1251"),k.Cp1252=new k(se.Cp1252,23,"Cp1252","windows-1252"),k.Cp1256=new k(se.Cp1256,24,"Cp1256","windows-1256"),k.UnicodeBigUnmarked=new k(se.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),k.UTF8=new k(se.UTF8,26,"UTF8","UTF-8"),k.ASCII=new k(se.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),k.Big5=new k(se.Big5,28,"Big5"),k.GB18030=new k(se.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),k.EUC_KR=new k(se.EUC_KR,30,"EUC_KR","EUC-KR");class xe extends m{}xe.kind="UnsupportedOperationException";class pe{static decode(e,t){const n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)}static shouldDecodeOnFallback(e){return!pe.isBrowser()&&e==="ISO-8859-1"}static encode(e,t){const n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(e){return typeof e=="string"?e:e.getName()}static encodingCharacterSet(e){return e instanceof k?e:k.getCharacterSetECIByName(e)}static decodeFallback(e,t){const n=this.encodingCharacterSet(t);if(pe.isDecodeFallbackSupported(n)){let r="";for(let i=0,o=e.length;i<o;i++){let l=e[i].toString(16);l.length<2&&(l="0"+l),r+="%"+l}return decodeURIComponent(r)}if(n.equals(k.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new xe(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(k.UTF8)||e.equals(k.ISO8859_1)||e.equals(k.ASCII)}static encodeFallback(e){const n=btoa(unescape(encodeURIComponent(e))).split(""),r=[];for(let i=0;i<n.length;i++)r.push(n[i].charCodeAt(0));return new Uint8Array(r)}}class ae{static castAsNonUtf8Char(e,t=null){const n=t?t.getName():this.ISO88591;return pe.decode(new Uint8Array([e]),n)}static guessEncoding(e,t){if(t!=null&&t.get($.CHARACTER_SET)!==void 0)return t.get($.CHARACTER_SET).toString();const n=e.length;let r=!0,i=!0,o=!0,l=0,u=0,g=0,A=0,I=0,y=0,N=0,L=0,V=0,Z=0,te=0;const de=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191;for(let ge=0;ge<n&&(r||i||o);ge++){const ue=e[ge]&255;o&&(l>0?(ue&128)===0?o=!1:l--:(ue&128)!==0&&((ue&64)===0?o=!1:(l++,(ue&32)===0?u++:(l++,(ue&16)===0?g++:(l++,(ue&8)===0?A++:o=!1))))),r&&(ue>127&&ue<160?r=!1:ue>159&&(ue<192||ue===215||ue===247)&&te++),i&&(I>0?ue<64||ue===127||ue>252?i=!1:I--:ue===128||ue===160||ue>239?i=!1:ue>160&&ue<224?(y++,L=0,N++,N>V&&(V=N)):ue>127?(I++,N=0,L++,L>Z&&(Z=L)):(N=0,L=0))}return o&&l>0&&(o=!1),i&&I>0&&(i=!1),o&&(de||u+g+A>0)?ae.UTF8:i&&(ae.ASSUME_SHIFT_JIS||V>=3||Z>=3)?ae.SHIFT_JIS:r&&i?V===2&&y===2||te*10>=n?ae.SHIFT_JIS:ae.ISO88591:r?ae.ISO88591:i?ae.SHIFT_JIS:o?ae.UTF8:ae.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let n=-1;function r(o,l,u,g,A,I){if(o==="%%")return"%";if(t[++n]===void 0)return;o=g?parseInt(g.substr(1)):void 0;let y=A?parseInt(A.substr(1)):void 0,N;switch(I){case"s":N=t[n];break;case"c":N=t[n][0];break;case"f":N=parseFloat(t[n]).toFixed(o);break;case"p":N=parseFloat(t[n]).toPrecision(o);break;case"e":N=parseFloat(t[n]).toExponential(o);break;case"x":N=parseInt(t[n]).toString(y||16);break;case"d":N=parseFloat(parseInt(t[n],y||10).toPrecision(o)).toFixed(0);break}N=typeof N=="object"?JSON.stringify(N):(+N).toString(y);let L=parseInt(u),V=u&&u[0]+""=="0"?"0":" ";for(;N.length<L;)N=l!==void 0?N+V:V+N;return N}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,r)}static getBytes(e,t){return pe.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}ae.SHIFT_JIS=k.SJIS.getName(),ae.GB2312="GB2312",ae.ISO88591=k.ISO8859_1.getName(),ae.EUC_JP="EUC_JP",ae.UTF8=k.UTF8.getName(),ae.PLATFORM_DEFAULT_ENCODING=ae.UTF8,ae.ASSUME_SHIFT_JIS=!1;class ne{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=ae.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,n){for(let r=t;t<t+n;r++)this.append(e[r]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class Ae{constructor(e,t,n,r){if(this.width=e,this.height=t,this.rowSize=n,this.bits=r,t==null&&(t=e),this.height=t,e<1||t<1)throw new _("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,r==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,n=e[0].length,r=new Ae(n,t);for(let i=0;i<t;i++){const o=e[i];for(let l=0;l<n;l++)o[l]&&r.set(l,i)}return r}static parseFromString(e,t,n){if(e===null)throw new _("stringRepresentation cannot be null");const r=new Array(e.length);let i=0,o=0,l=-1,u=0,g=0;for(;g<e.length;)if(e.charAt(g)===`
`||e.charAt(g)==="\r"){if(i>o){if(l===-1)l=i-o;else if(i-o!==l)throw new _("row lengths do not match");o=i,u++}g++}else if(e.substring(g,g+t.length)===t)g+=t.length,r[i]=!0,i++;else if(e.substring(g,g+n.length)===n)g+=n.length,r[i]=!1,i++;else throw new _("illegal character encountered: "+e.substring(g));if(i>o){if(l===-1)l=i-o;else if(i-o!==l)throw new _("row lengths do not match");u++}const A=new Ae(l,u);for(let I=0;I<i;I++)r[I]&&A.set(Math.floor(I%l),Math.floor(I/l));return A}get(e,t){const n=t*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0}set(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295}unset(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)}flip(e,t){const n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new _("input matrix dimensions do not match");const t=new Y(Math.floor(this.width/32)+1),n=this.rowSize,r=this.bits;for(let i=0,o=this.height;i<o;i++){const l=i*n,u=e.getRow(i,t).getBitArray();for(let g=0;g<n;g++)r[l+g]^=u[g]}}clear(){const e=this.bits,t=e.length;for(let n=0;n<t;n++)e[n]=0}setRegion(e,t,n,r){if(t<0||e<0)throw new _("Left and top must be nonnegative");if(r<1||n<1)throw new _("Height and width must be at least 1");const i=e+n,o=t+r;if(o>this.height||i>this.width)throw new _("The region must fit inside the matrix");const l=this.rowSize,u=this.bits;for(let g=t;g<o;g++){const A=g*l;for(let I=e;I<i;I++)u[A+Math.floor(I/32)]|=1<<(I&31)&4294967295}}getRow(e,t){t==null||t.getSize()<this.width?t=new Y(this.width):t.clear();const n=this.rowSize,r=this.bits,i=e*n;for(let o=0;o<n;o++)t.setBulk(o*32,r[i+o]);return t}setRow(e,t){M.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let n=new Y(e),r=new Y(e);for(let i=0,o=Math.floor((t+1)/2);i<o;i++)n=this.getRow(i,n),r=this.getRow(t-1-i,r),n.reverse(),r.reverse(),this.setRow(i,r),this.setRow(t-1-i,n)}getEnclosingRectangle(){const e=this.width,t=this.height,n=this.rowSize,r=this.bits;let i=e,o=t,l=-1,u=-1;for(let g=0;g<t;g++)for(let A=0;A<n;A++){const I=r[g*n+A];if(I!==0){if(g<o&&(o=g),g>u&&(u=g),A*32<i){let y=0;for(;(I<<31-y&4294967295)===0;)y++;A*32+y<i&&(i=A*32+y)}if(A*32+31>l){let y=31;for(;I>>>y===0;)y--;A*32+y>l&&(l=A*32+y)}}}return l<i||u<o?null:Int32Array.from([i,o,l-i+1,u-o+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let n=0;for(;n<t.length&&t[n]===0;)n++;if(n===t.length)return null;const r=n/e;let i=n%e*32;const o=t[n];let l=0;for(;(o<<31-l&4294967295)===0;)l++;return i+=l,Int32Array.from([i,r])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let n=t.length-1;for(;n>=0&&t[n]===0;)n--;if(n<0)return null;const r=Math.floor(n/e);let i=Math.floor(n%e)*32;const o=t[n];let l=31;for(;o>>>l===0;)l--;return i+=l,Int32Array.from([i,r])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof Ae))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&z.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+z.hashCode(this.bits),e}toString(e="X ",t="  ",n=`
`){return this.buildToString(e,t,n)}buildToString(e,t,n){let r=new ne;for(let i=0,o=this.height;i<o;i++){for(let l=0,u=this.width;l<u;l++)r.append(this.get(l,i)?e:t);r.append(n)}return r.toString()}clone(){return new Ae(this.width,this.height,this.rowSize,this.bits.slice())}}class q extends m{static getNotFoundInstance(){return new q}}q.kind="NotFoundException";class Ne extends P{constructor(e){super(e),this.luminances=Ne.EMPTY,this.buckets=new Int32Array(Ne.LUMINANCE_BUCKETS)}getBlackRow(e,t){const n=this.getLuminanceSource(),r=n.getWidth();t==null||t.getSize()<r?t=new Y(r):t.clear(),this.initArrays(r);const i=n.getRow(e,this.luminances),o=this.buckets;for(let u=0;u<r;u++)o[(i[u]&255)>>Ne.LUMINANCE_SHIFT]++;const l=Ne.estimateBlackPoint(o);if(r<3)for(let u=0;u<r;u++)(i[u]&255)<l&&t.set(u);else{let u=i[0]&255,g=i[1]&255;for(let A=1;A<r-1;A++){const I=i[A+1]&255;(g*4-u-I)/2<l&&t.set(A),u=g,g=I}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight(),r=new Ae(t,n);this.initArrays(t);const i=this.buckets;for(let u=1;u<5;u++){const g=Math.floor(n*u/5),A=e.getRow(g,this.luminances),I=Math.floor(t*4/5);for(let y=Math.floor(t/5);y<I;y++){const N=A[y]&255;i[N>>Ne.LUMINANCE_SHIFT]++}}const o=Ne.estimateBlackPoint(i),l=e.getMatrix();for(let u=0;u<n;u++){const g=u*t;for(let A=0;A<t;A++)(l[g+A]&255)<o&&r.set(A,u)}return r}createBinarizer(e){return new Ne(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let n=0;n<Ne.LUMINANCE_BUCKETS;n++)t[n]=0}static estimateBlackPoint(e){const t=e.length;let n=0,r=0,i=0;for(let A=0;A<t;A++)e[A]>i&&(r=A,i=e[A]),e[A]>n&&(n=e[A]);let o=0,l=0;for(let A=0;A<t;A++){const I=A-r,y=e[A]*I*I;y>l&&(o=A,l=y)}if(r>o){const A=r;r=o,o=A}if(o-r<=t/16)throw new q;let u=o-1,g=-1;for(let A=o-1;A>r;A--){const I=A-r,y=I*I*(o-A)*(n-e[A]);y>g&&(u=A,g=y)}return u<<Ne.LUMINANCE_SHIFT}}Ne.LUMINANCE_BITS=5,Ne.LUMINANCE_SHIFT=8-Ne.LUMINANCE_BITS,Ne.LUMINANCE_BUCKETS=1<<Ne.LUMINANCE_BITS,Ne.EMPTY=Uint8ClampedArray.from([0]);class oe extends Ne{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),n=e.getHeight();if(t>=oe.MINIMUM_DIMENSION&&n>=oe.MINIMUM_DIMENSION){const r=e.getMatrix();let i=t>>oe.BLOCK_SIZE_POWER;(t&oe.BLOCK_SIZE_MASK)!==0&&i++;let o=n>>oe.BLOCK_SIZE_POWER;(n&oe.BLOCK_SIZE_MASK)!==0&&o++;const l=oe.calculateBlackPoints(r,i,o,t,n),u=new Ae(t,n);oe.calculateThresholdForBlock(r,i,o,t,n,l,u),this.matrix=u}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new oe(e)}static calculateThresholdForBlock(e,t,n,r,i,o,l){const u=i-oe.BLOCK_SIZE,g=r-oe.BLOCK_SIZE;for(let A=0;A<n;A++){let I=A<<oe.BLOCK_SIZE_POWER;I>u&&(I=u);const y=oe.cap(A,2,n-3);for(let N=0;N<t;N++){let L=N<<oe.BLOCK_SIZE_POWER;L>g&&(L=g);const V=oe.cap(N,2,t-3);let Z=0;for(let de=-2;de<=2;de++){const ge=o[y+de];Z+=ge[V-2]+ge[V-1]+ge[V]+ge[V+1]+ge[V+2]}const te=Z/25;oe.thresholdBlock(e,L,I,te,r,l)}}}static cap(e,t,n){return e<t?t:e>n?n:e}static thresholdBlock(e,t,n,r,i,o){for(let l=0,u=n*i+t;l<oe.BLOCK_SIZE;l++,u+=i)for(let g=0;g<oe.BLOCK_SIZE;g++)(e[u+g]&255)<=r&&o.set(t+g,n+l)}static calculateBlackPoints(e,t,n,r,i){const o=i-oe.BLOCK_SIZE,l=r-oe.BLOCK_SIZE,u=new Array(n);for(let g=0;g<n;g++){u[g]=new Int32Array(t);let A=g<<oe.BLOCK_SIZE_POWER;A>o&&(A=o);for(let I=0;I<t;I++){let y=I<<oe.BLOCK_SIZE_POWER;y>l&&(y=l);let N=0,L=255,V=0;for(let te=0,de=A*r+y;te<oe.BLOCK_SIZE;te++,de+=r){for(let ge=0;ge<oe.BLOCK_SIZE;ge++){const ue=e[de+ge]&255;N+=ue,ue<L&&(L=ue),ue>V&&(V=ue)}if(V-L>oe.MIN_DYNAMIC_RANGE)for(te++,de+=r;te<oe.BLOCK_SIZE;te++,de+=r)for(let ge=0;ge<oe.BLOCK_SIZE;ge++)N+=e[de+ge]&255}let Z=N>>oe.BLOCK_SIZE_POWER*2;if(V-L<=oe.MIN_DYNAMIC_RANGE&&(Z=L/2,g>0&&I>0)){const te=(u[g-1][I]+2*u[g][I-1]+u[g-1][I-1])/4;L<te&&(Z=te)}u[g][I]=Z}}return u}}oe.BLOCK_SIZE_POWER=3,oe.BLOCK_SIZE=1<<oe.BLOCK_SIZE_POWER,oe.BLOCK_SIZE_MASK=oe.BLOCK_SIZE-1,oe.MINIMUM_DIMENSION=oe.BLOCK_SIZE*5,oe.MIN_DYNAMIC_RANGE=24;class De{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,n,r){throw new xe("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new xe("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new xe("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new ne;for(let n=0;n<this.height;n++){const r=this.getRow(n,e);for(let i=0;i<this.width;i++){const o=r[i]&255;let l;o<64?l="#":o<128?l="+":o<192?l=".":l=" ",t.append(l)}t.append(`
`)}return t.toString()}}class et extends De{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const n=this.delegate.getRow(e,t),r=this.getWidth();for(let i=0;i<r;i++)n[i]=255-(n[i]&255);return n}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),n=new Uint8ClampedArray(t);for(let r=0;r<t;r++)n[r]=255-(e[r]&255);return n}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,n,r){return new et(this.delegate.crop(e,t,n,r))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new et(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new et(this.delegate.rotateCounterClockwise45())}}class ze extends De{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=ze.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return ze.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,n){const r=new Uint8ClampedArray(t*n);for(let i=0,o=0,l=e.length;i<l;i+=4,o++){let u;if(e[i+3]===0)u=255;else{const A=e[i],I=e[i+1],y=e[i+2];u=306*A+601*I+117*y+512>>10}r[o]=u}return r}getRow(e,t){if(e<0||e>=this.getHeight())throw new _("Requested row is outside the image: "+e);const n=this.getWidth(),r=e*n;return t===null?t=this.buffer.slice(r,r+n):(t.length<n&&(t=new Uint8ClampedArray(n)),t.set(this.buffer.slice(r,r+n))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,n,r){return super.crop(e,t,n,r),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),n=t.getContext("2d"),r=e*ze.DEGREE_TO_RADIANS,i=this.canvas.width,o=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(r))*i+Math.abs(Math.sin(r))*o),u=Math.ceil(Math.abs(Math.sin(r))*i+Math.abs(Math.cos(r))*o);return t.width=l,t.height=u,n.translate(l/2,u/2),n.rotate(r),n.drawImage(this.canvas,i/-2,o/-2),this.buffer=ze.makeBufferFromCanvasImageData(t),this}invert(){return new et(this)}}ze.DEGREE_TO_RADIANS=Math.PI/180;class ye{constructor(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var he=(globalThis||fr||self||window||void 0)&&(globalThis||fr||self||window||void 0).__awaiter||function(b,e,t,n){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(A){try{g(n.next(A))}catch(I){o(I)}}function u(A){try{g(n.throw(A))}catch(I){o(I)}}function g(A){A.done?i(A.value):r(A.value).then(l,u)}g((n=n.apply(b,e||[])).next())})};class fe{constructor(e,t=500,n){this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return he(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const n of e){const r=n.kind==="video"?"videoinput":n.kind;if(r!=="videoinput")continue;const i=n.deviceId||n.id,o=n.label||`Video device ${t.length+1}`,l=n.groupId,u={deviceId:i,label:o,kind:r,groupId:l};t.push(u)}return t})}getVideoInputDevices(){return he(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(t=>new ye(t.deviceId,t.label))})}findDeviceById(e){return he(this,void 0,void 0,function*(){const t=yield this.listVideoInputDevices();return t?t.find(n=>n.deviceId===e):null})}decodeFromInputVideoDevice(e,t){return he(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,t)})}decodeOnceFromVideoDevice(e,t){return he(this,void 0,void 0,function*(){this.reset();let n;e?n={deviceId:{exact:e}}:n={facingMode:"environment"};const r={video:n};return yield this.decodeOnceFromConstraints(r,t)})}decodeOnceFromConstraints(e,t){return he(this,void 0,void 0,function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(n,t)})}decodeOnceFromStream(e,t){return he(this,void 0,void 0,function*(){this.reset();const n=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(n)})}decodeFromInputVideoDeviceContinuously(e,t,n){return he(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,t,n)})}decodeFromVideoDevice(e,t,n){return he(this,void 0,void 0,function*(){let r;e?r={deviceId:{exact:e}}:r={facingMode:"environment"};const i={video:r};return yield this.decodeFromConstraints(i,t,n)})}decodeFromConstraints(e,t,n){return he(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(r,t,n)})}decodeFromStream(e,t,n){return he(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(r,n)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return he(this,void 0,void 0,function*(){const n=this.prepareVideoElement(t);return this.addVideoSource(n,e),this.videoElement=n,this.stream=e,yield this.playVideoOnLoadAsync(n),n})}playVideoOnLoadAsync(e){return new Promise((t,n)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return he(this,void 0,void 0,function*(){if(this.isVideoPlaying(e)){console.warn("Trying to play video that is already playing.");return}try{yield e.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(e,t){const n=document.getElementById(e);if(!n)throw new C(`element with id '${e}' not found`);if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new C(`element with id '${e}' must be an ${t} element`);return n}decodeFromImage(e,t){if(!e&&!t)throw new C("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new C("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,n){if(e===void 0&&t===void 0)throw new C("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)}decodeFromImageElement(e){if(!e)throw new C("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);this.imageElement=t;let n;return this.isImageLoaded(t)?n=this.decodeOnce(t,!1,!0):n=this._decodeOnLoadImage(t),n}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)}_decodeFromVideoElementSetup(e){if(!e)throw new C("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new C("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const n=this._decodeOnLoadImage(t);return t.src=e,n}decodeFromVideoUrl(e){if(!e)throw new C("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n}decodeFromVideoUrlContinuously(e,t){if(!e)throw new C("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),r=this.decodeFromVideoElementContinuously(n,t);return n.src=e,r}_decodeOnLoadImage(e){return new Promise((t,n)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,n),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return he(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,t){return he(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)})}isImageLoaded(e){return!(!e.complete||e.naturalWidth===0)}prepareImageElement(e){let t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,n=!0){this._stopAsyncDecode=!1;const r=(i,o)=>{if(this._stopAsyncDecode){o(new q("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const l=this.decode(e);i(l)}catch(l){const u=t&&l instanceof q,A=(l instanceof v||l instanceof U)&&n;if(u||A)return setTimeout(r,this._timeBetweenDecodingAttempts,i,o);o(l)}};return new Promise((i,o)=>r(i,o))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const n=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const r=this.decode(e);t(r,null),setTimeout(n,this.timeBetweenScansMillis)}catch(r){t(null,r);const i=r instanceof v||r instanceof U,o=r instanceof q;(i||o)&&setTimeout(n,this._timeBetweenDecodingAttempts)}};n()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}createBinaryBitmap(e){const t=this.getCaptureCanvasContext(e);this.drawImageOnCanvas(t,e);const n=this.getCaptureCanvas(e),r=new ze(n),i=new oe(r);return new B(i)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const n=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=n}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}drawImageOnCanvas(e,t){e.drawImage(t,0,0)}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let n,r;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,r=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,r=e.naturalHeight||e.height)),t.style.width=n+"px",t.style.height=r+"px",t.width=n,t.height=r,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){!this.videoElement||(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){!this.imageElement||(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")}}class we{constructor(e,t,n=t==null?0:8*t.length,r,i,o=M.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=r,this.format=i,this.timestamp=o,this.text=e,this.rawBytes=t,n==null?this.numBits=t==null?0:8*t.length:this.numBits=n,this.resultPoints=r,this.format=i,this.resultMetadata=null,o==null?this.timestamp=M.currentTimeMillis():this.timestamp=o}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){const n=new Array(t.length+e.length);M.arraycopy(t,0,n,0,t.length),M.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Ve;(function(b){b[b.AZTEC=0]="AZTEC",b[b.CODABAR=1]="CODABAR",b[b.CODE_39=2]="CODE_39",b[b.CODE_93=3]="CODE_93",b[b.CODE_128=4]="CODE_128",b[b.DATA_MATRIX=5]="DATA_MATRIX",b[b.EAN_8=6]="EAN_8",b[b.EAN_13=7]="EAN_13",b[b.ITF=8]="ITF",b[b.MAXICODE=9]="MAXICODE",b[b.PDF_417=10]="PDF_417",b[b.QR_CODE=11]="QR_CODE",b[b.RSS_14=12]="RSS_14",b[b.RSS_EXPANDED=13]="RSS_EXPANDED",b[b.UPC_A=14]="UPC_A",b[b.UPC_E=15]="UPC_E",b[b.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ve||(Ve={}));var Ce=Ve,xn;(function(b){b[b.OTHER=0]="OTHER",b[b.ORIENTATION=1]="ORIENTATION",b[b.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",b[b.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",b[b.ISSUE_NUMBER=4]="ISSUE_NUMBER",b[b.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",b[b.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",b[b.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",b[b.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",b[b.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",b[b.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(xn||(xn={}));var lt=xn;class ht{constructor(e,t,n,r,i=-1,o=-1){this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=r,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Qt{exp(e){return this.expTable[e]}log(e){if(e===0)throw new _;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class gt{constructor(e,t){if(t.length===0)throw new _;this.field=e;const n=t.length;if(n>1&&t[0]===0){let r=1;for(;r<n&&t[r]===0;)r++;r===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-r),M.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);const t=this.coefficients;let n;if(e===1){n=0;for(let o=0,l=t.length;o!==l;o++){const u=t[o];n=Qt.addOrSubtract(n,u)}return n}n=t[0];const r=t.length,i=this.field;for(let o=1;o<r;o++)n=Qt.addOrSubtract(i.multiply(e,n),t[o]);return n}addOrSubtract(e){if(!this.field.equals(e.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){const o=t;t=n,n=o}let r=new Int32Array(n.length);const i=n.length-t.length;M.arraycopy(n,0,r,0,i);for(let o=i;o<n.length;o++)r[o]=Qt.addOrSubtract(t[o-i],n[o]);return new gt(this.field,r)}multiply(e){if(!this.field.equals(e.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,o=new Int32Array(n+i-1),l=this.field;for(let u=0;u<n;u++){const g=t[u];for(let A=0;A<i;A++)o[u+A]=Qt.addOrSubtract(o[u+A],l.multiply(g,r[A]))}return new gt(l,o)}multiplyScalar(e){if(e===0)return this.field.getZero();if(e===1)return this;const t=this.coefficients.length,n=this.field,r=new Int32Array(t),i=this.coefficients;for(let o=0;o<t;o++)r[o]=n.multiply(i[o],e);return new gt(n,r)}multiplyByMonomial(e,t){if(e<0)throw new _;if(t===0)return this.field.getZero();const n=this.coefficients,r=n.length,i=new Int32Array(r+e),o=this.field;for(let l=0;l<r;l++)i[l]=o.multiply(n[l],t);return new gt(o,i)}divide(e){if(!this.field.equals(e.field))throw new _("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new _("Divide by 0");const t=this.field;let n=t.getZero(),r=this;const i=e.getCoefficient(e.getDegree()),o=t.inverse(i);for(;r.getDegree()>=e.getDegree()&&!r.isZero();){const l=r.getDegree()-e.getDegree(),u=t.multiply(r.getCoefficient(r.getDegree()),o),g=e.multiplyByMonomial(l,u),A=t.buildMonomial(l,u);n=n.addOrSubtract(A),r=r.addOrSubtract(g)}return[n,r]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),t===0||n!==1){const r=this.field.log(n);r===0?e+="1":r===1?e+="a":(e+="a^",e+=r)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e}}class Mt extends m{}Mt.kind="ArithmeticException";class Ee extends Qt{constructor(e,t,n){super(),this.primitive=e,this.size=t,this.generatorBase=n;const r=new Int32Array(t);let i=1;for(let l=0;l<t;l++)r[l]=i,i*=2,i>=t&&(i^=e,i&=t-1);this.expTable=r;const o=new Int32Array(t);for(let l=0;l<t-1;l++)o[r[l]]=l;this.logTable=o,this.zero=new gt(this,Int32Array.from([0])),this.one=new gt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new _;if(t===0)return this.zero;const n=new Int32Array(e+1);return n[0]=t,new gt(this,n)}inverse(e){if(e===0)throw new Mt;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+J.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}Ee.AZTEC_DATA_12=new Ee(4201,4096,1),Ee.AZTEC_DATA_10=new Ee(1033,1024,1),Ee.AZTEC_DATA_6=new Ee(67,64,1),Ee.AZTEC_PARAM=new Ee(19,16,1),Ee.QR_CODE_FIELD_256=new Ee(285,256,0),Ee.DATA_MATRIX_FIELD_256=new Ee(301,256,1),Ee.AZTEC_DATA_8=Ee.DATA_MATRIX_FIELD_256,Ee.MAXICODE_FIELD_64=Ee.AZTEC_DATA_6;class je extends m{}je.kind="ReedSolomonException";class yt extends m{}yt.kind="IllegalStateException";class Sn{constructor(e){this.field=e}decode(e,t){const n=this.field,r=new gt(n,e),i=new Int32Array(t);let o=!0;for(let N=0;N<t;N++){const L=r.evaluateAt(n.exp(N+n.getGeneratorBase()));i[i.length-1-N]=L,L!==0&&(o=!1)}if(o)return;const l=new gt(n,i),u=this.runEuclideanAlgorithm(n.buildMonomial(t,1),l,t),g=u[0],A=u[1],I=this.findErrorLocations(g),y=this.findErrorMagnitudes(A,I);for(let N=0;N<I.length;N++){const L=e.length-1-n.log(I[N]);if(L<0)throw new je("Bad error location");e[L]=Ee.addOrSubtract(e[L],y[N])}}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){const N=e;e=t,t=N}const r=this.field;let i=e,o=t,l=r.getZero(),u=r.getOne();for(;o.getDegree()>=(n/2|0);){let N=i,L=l;if(i=o,l=u,i.isZero())throw new je("r_{i-1} was zero");o=N;let V=r.getZero();const Z=i.getCoefficient(i.getDegree()),te=r.inverse(Z);for(;o.getDegree()>=i.getDegree()&&!o.isZero();){const de=o.getDegree()-i.getDegree(),ge=r.multiply(o.getCoefficient(o.getDegree()),te);V=V.addOrSubtract(r.buildMonomial(de,ge)),o=o.addOrSubtract(i.multiplyByMonomial(de,ge))}if(u=V.multiply(l).addOrSubtract(L),o.getDegree()>=i.getDegree())throw new yt("Division algorithm failed to reduce polynomial?")}const g=u.getCoefficient(0);if(g===0)throw new je("sigmaTilde(0) was zero");const A=r.inverse(g),I=u.multiplyScalar(A),y=o.multiplyScalar(A);return[I,y]}findErrorLocations(e){const t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);const n=new Int32Array(t);let r=0;const i=this.field;for(let o=1;o<i.getSize()&&r<t;o++)e.evaluateAt(o)===0&&(n[r]=i.inverse(o),r++);if(r!==t)throw new je("Error locator degree does not match number of roots");return n}findErrorMagnitudes(e,t){const n=t.length,r=new Int32Array(n),i=this.field;for(let o=0;o<n;o++){const l=i.inverse(t[o]);let u=1;for(let g=0;g<n;g++)if(o!==g){const A=i.multiply(t[g],l),I=(A&1)===0?A|1:A&-2;u=i.multiply(u,I)}r[o]=i.multiply(e.evaluateAt(l),i.inverse(u)),i.getGeneratorBase()!==0&&(r[o]=i.multiply(r[o],l))}return r}}var St;(function(b){b[b.UPPER=0]="UPPER",b[b.LOWER=1]="LOWER",b[b.MIXED=2]="MIXED",b[b.DIGIT=3]="DIGIT",b[b.PUNCT=4]="PUNCT",b[b.BINARY=5]="BINARY"})(St||(St={}));class tt{decode(e){this.ddata=e;let t=e.getBits(),n=this.extractBits(t),r=this.correctBits(n),i=tt.convertBoolArrayToByteArray(r),o=tt.getEncodedData(r),l=new ht(i,o,null,null);return l.setNumBits(r.length),l}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,n=St.UPPER,r=St.UPPER,i="",o=0;for(;o<t;)if(r===St.BINARY){if(t-o<5)break;let l=tt.readCode(e,o,5);if(o+=5,l===0){if(t-o<11)break;l=tt.readCode(e,o,11)+31,o+=11}for(let u=0;u<l;u++){if(t-o<8){o=t;break}const g=tt.readCode(e,o,8);i+=ae.castAsNonUtf8Char(g),o+=8}r=n}else{let l=r===St.DIGIT?4:5;if(t-o<l)break;let u=tt.readCode(e,o,l);o+=l;let g=tt.getCharacter(r,u);g.startsWith("CTRL_")?(n=r,r=tt.getTable(g.charAt(5)),g.charAt(6)==="L"&&(n=r)):(i+=g,r=n)}return i}static getTable(e){switch(e){case"L":return St.LOWER;case"P":return St.PUNCT;case"M":return St.MIXED;case"D":return St.DIGIT;case"B":return St.BINARY;case"U":default:return St.UPPER}}static getCharacter(e,t){switch(e){case St.UPPER:return tt.UPPER_TABLE[t];case St.LOWER:return tt.LOWER_TABLE[t];case St.MIXED:return tt.MIXED_TABLE[t];case St.PUNCT:return tt.PUNCT_TABLE[t];case St.DIGIT:return tt.DIGIT_TABLE[t];default:throw new yt("Bad table")}}correctBits(e){let t,n;this.ddata.getNbLayers()<=2?(n=6,t=Ee.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,t=Ee.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,t=Ee.AZTEC_DATA_10):(n=12,t=Ee.AZTEC_DATA_12);let r=this.ddata.getNbDatablocks(),i=e.length/n;if(i<r)throw new U;let o=e.length%n,l=new Int32Array(i);for(let y=0;y<i;y++,o+=n)l[y]=tt.readCode(e,o,n);try{new Sn(t).decode(l,i-r)}catch(y){throw new U(y)}let u=(1<<n)-1,g=0;for(let y=0;y<r;y++){let N=l[y];if(N===0||N===u)throw new U;(N===1||N===u-1)&&g++}let A=new Array(r*n-g),I=0;for(let y=0;y<r;y++){let N=l[y];if(N===1||N===u-1)A.fill(N>1,I,I+n-1),I+=n-1;else for(let L=n-1;L>=0;--L)A[I++]=(N&1<<L)!==0}return A}extractBits(e){let t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),r=(t?11:14)+n*4,i=new Int32Array(r),o=new Array(this.totalBitsInLayer(n,t));if(t)for(let l=0;l<i.length;l++)i[l]=l;else{let l=r+1+2*J.truncDivision(J.truncDivision(r,2)-1,15),u=r/2,g=J.truncDivision(l,2);for(let A=0;A<u;A++){let I=A+J.truncDivision(A,15);i[u-A-1]=g-I-1,i[u+A]=g+I+1}}for(let l=0,u=0;l<n;l++){let g=(n-l)*4+(t?9:12),A=l*2,I=r-1-A;for(let y=0;y<g;y++){let N=y*2;for(let L=0;L<2;L++)o[u+N+L]=e.get(i[A+L],i[A+y]),o[u+2*g+N+L]=e.get(i[A+y],i[I-L]),o[u+4*g+N+L]=e.get(i[I-L],i[I-y]),o[u+6*g+N+L]=e.get(i[I-y],i[A+L])}u+=g*8}return o}static readCode(e,t,n){let r=0;for(let i=t;i<t+n;i++)r<<=1,e[i]&&(r|=1);return r}static readByte(e,t){let n=e.length-t;return n>=8?tt.readCode(e,t,8):tt.readCode(e,t,n)<<8-n}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let n=0;n<t.length;n++)t[n]=tt.readByte(e,8*n);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}tt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],tt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],tt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],tt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],tt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Xe{constructor(){}static round(e){return e===NaN?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,n,r){const i=e-n,o=t-r;return Math.sqrt(i*i+o*o)}static sum(e){let t=0;for(let n=0,r=e.length;n!==r;n++)t+=e[n];return t}}class Ln{static floatToIntBits(e){return e}}Ln.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Se{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof Se){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*Ln.floatToIntBits(this.x)+Ln.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),r=this.distance(e[0],e[2]);let i,o,l;if(n>=t&&n>=r?(o=e[0],i=e[1],l=e[2]):r>=n&&r>=t?(o=e[1],i=e[0],l=e[2]):(o=e[2],i=e[0],l=e[1]),this.crossProductZ(i,o,l)<0){const u=i;i=l,l=u}e[0]=i,e[1]=o,e[2]=l}static distance(e,t){return Xe.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,n){const r=t.x,i=t.y;return(n.x-r)*(e.y-i)-(n.y-i)*(e.x-r)}}class wn{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class jt extends wn{constructor(e,t,n,r,i){super(e,t),this.compact=n,this.nbDatablocks=r,this.nbLayers=i}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Zt{constructor(e,t,n,r){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=Zt.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),r==null&&(r=e.getHeight()/2|0);const i=t/2|0;if(this.leftInit=n-i,this.rightInit=n+i,this.upInit=r-i,this.downInit=r+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new q}detect(){let e=this.leftInit,t=this.rightInit,n=this.upInit,r=this.downInit,i=!1,o=!0,l=!1,u=!1,g=!1,A=!1,I=!1;const y=this.width,N=this.height;for(;o;){o=!1;let L=!0;for(;(L||!u)&&t<y;)L=this.containsBlackPoint(n,r,t,!1),L?(t++,o=!0,u=!0):u||t++;if(t>=y){i=!0;break}let V=!0;for(;(V||!g)&&r<N;)V=this.containsBlackPoint(e,t,r,!0),V?(r++,o=!0,g=!0):g||r++;if(r>=N){i=!0;break}let Z=!0;for(;(Z||!A)&&e>=0;)Z=this.containsBlackPoint(n,r,e,!1),Z?(e--,o=!0,A=!0):A||e--;if(e<0){i=!0;break}let te=!0;for(;(te||!I)&&n>=0;)te=this.containsBlackPoint(e,t,n,!0),te?(n--,o=!0,I=!0):I||n--;if(n<0){i=!0;break}o&&(l=!0)}if(!i&&l){const L=t-e;let V=null;for(let ge=1;V===null&&ge<L;ge++)V=this.getBlackPointOnSegment(e,r-ge,e+ge,r);if(V==null)throw new q;let Z=null;for(let ge=1;Z===null&&ge<L;ge++)Z=this.getBlackPointOnSegment(e,n+ge,e+ge,n);if(Z==null)throw new q;let te=null;for(let ge=1;te===null&&ge<L;ge++)te=this.getBlackPointOnSegment(t,n+ge,t-ge,n);if(te==null)throw new q;let de=null;for(let ge=1;de===null&&ge<L;ge++)de=this.getBlackPointOnSegment(t,r-ge,t-ge,r);if(de==null)throw new q;return this.centerEdges(de,V,te,Z)}else throw new q}getBlackPointOnSegment(e,t,n,r){const i=Xe.round(Xe.distance(e,t,n,r)),o=(n-e)/i,l=(r-t)/i,u=this.image;for(let g=0;g<i;g++){const A=Xe.round(e+g*o),I=Xe.round(t+g*l);if(u.get(A,I))return new Se(A,I)}return null}centerEdges(e,t,n,r){const i=e.getX(),o=e.getY(),l=t.getX(),u=t.getY(),g=n.getX(),A=n.getY(),I=r.getX(),y=r.getY(),N=Zt.CORR;return i<this.width/2?[new Se(I-N,y+N),new Se(l+N,u+N),new Se(g-N,A-N),new Se(i+N,o-N)]:[new Se(I+N,y+N),new Se(l+N,u-N),new Se(g-N,A+N),new Se(i-N,o-N)]}containsBlackPoint(e,t,n,r){const i=this.image;if(r){for(let o=e;o<=t;o++)if(i.get(o,n))return!0}else for(let o=e;o<=t;o++)if(i.get(n,o))return!0;return!1}}Zt.INIT_SIZE=10,Zt.CORR=1;class nr{static checkAndNudgePoints(e,t){const n=e.getWidth(),r=e.getHeight();let i=!0;for(let o=0;o<t.length&&i;o+=2){const l=Math.floor(t[o]),u=Math.floor(t[o+1]);if(l<-1||l>n||u<-1||u>r)throw new q;i=!1,l===-1?(t[o]=0,i=!0):l===n&&(t[o]=n-1,i=!0),u===-1?(t[o+1]=0,i=!0):u===r&&(t[o+1]=r-1,i=!0)}i=!0;for(let o=t.length-2;o>=0&&i;o-=2){const l=Math.floor(t[o]),u=Math.floor(t[o+1]);if(l<-1||l>n||u<-1||u>r)throw new q;i=!1,l===-1?(t[o]=0,i=!0):l===n&&(t[o]=n-1,i=!0),u===-1?(t[o+1]=0,i=!0):u===r&&(t[o+1]=r-1,i=!0)}}}class At{constructor(e,t,n,r,i,o,l,u,g){this.a11=e,this.a21=t,this.a31=n,this.a12=r,this.a22=i,this.a32=o,this.a13=l,this.a23=u,this.a33=g}static quadrilateralToQuadrilateral(e,t,n,r,i,o,l,u,g,A,I,y,N,L,V,Z){const te=At.quadrilateralToSquare(e,t,n,r,i,o,l,u);return At.squareToQuadrilateral(g,A,I,y,N,L,V,Z).times(te)}transformPoints(e){const t=e.length,n=this.a11,r=this.a12,i=this.a13,o=this.a21,l=this.a22,u=this.a23,g=this.a31,A=this.a32,I=this.a33;for(let y=0;y<t;y+=2){const N=e[y],L=e[y+1],V=i*N+u*L+I;e[y]=(n*N+o*L+g)/V,e[y+1]=(r*N+l*L+A)/V}}transformPointsWithValues(e,t){const n=this.a11,r=this.a12,i=this.a13,o=this.a21,l=this.a22,u=this.a23,g=this.a31,A=this.a32,I=this.a33,y=e.length;for(let N=0;N<y;N++){const L=e[N],V=t[N],Z=i*L+u*V+I;e[N]=(n*L+o*V+g)/Z,t[N]=(r*L+l*V+A)/Z}}static squareToQuadrilateral(e,t,n,r,i,o,l,u){const g=e-n+i-l,A=t-r+o-u;if(g===0&&A===0)return new At(n-e,i-n,e,r-t,o-r,t,0,0,1);{const I=n-i,y=l-i,N=r-o,L=u-o,V=I*L-y*N,Z=(g*L-y*A)/V,te=(I*A-g*N)/V;return new At(n-e+Z*n,l-e+te*l,e,r-t+Z*r,u-t+te*u,t,Z,te,1)}}static quadrilateralToSquare(e,t,n,r,i,o,l,u){return At.squareToQuadrilateral(e,t,n,r,i,o,l,u).buildAdjoint()}buildAdjoint(){return new At(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new At(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class Tr extends nr{sampleGrid(e,t,n,r,i,o,l,u,g,A,I,y,N,L,V,Z,te,de,ge){const ue=At.quadrilateralToQuadrilateral(r,i,o,l,u,g,A,I,y,N,L,V,Z,te,de,ge);return this.sampleGridWithTransform(e,t,n,ue)}sampleGridWithTransform(e,t,n,r){if(t<=0||n<=0)throw new q;const i=new Ae(t,n),o=new Float32Array(2*t);for(let l=0;l<n;l++){const u=o.length,g=l+.5;for(let A=0;A<u;A+=2)o[A]=A/2+.5,o[A+1]=g;r.transformPoints(o),nr.checkAndNudgePoints(e,o);try{for(let A=0;A<u;A+=2)e.get(Math.floor(o[A]),Math.floor(o[A+1]))&&i.set(A/2,l)}catch{throw new q}}return i}}class S{static setGridSampler(e){S.gridSampler=e}static getInstance(){return S.gridSampler}}S.gridSampler=new Tr;class p{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new Se(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class E{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){let o=n[0];n[0]=n[2],n[2]=o}this.extractParameters(n);let r=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),i=this.getMatrixCornerPoints(n);return new jt(r,i,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new q;let t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);let r=0;for(let o=0;o<4;o++){let l=n[(this.shift+o)%4];this.compact?(r<<=7,r+=l>>1&127):(r<<=10,r+=(l>>2&31<<5)+(l>>1&31))}let i=this.getCorrectedParameterData(r,this.compact);this.compact?(this.nbLayers=(i>>6)+1,this.nbDataBlocks=(i&63)+1):(this.nbLayers=(i>>11)+1,this.nbDataBlocks=(i&2047)+1)}getRotation(e,t){let n=0;e.forEach((r,i,o)=>{let l=(r>>t-2<<1)+(r&1);n=(n<<3)+l}),n=((n&1)<<11)+(n>>1);for(let r=0;r<4;r++)if(J.bitCount(n^this.EXPECTED_CORNER_BITS[r])<=2)return r;throw new q}getCorrectedParameterData(e,t){let n,r;t?(n=7,r=2):(n=10,r=4);let i=n-r,o=new Int32Array(n);for(let u=n-1;u>=0;--u)o[u]=e&15,e>>=4;try{new Sn(Ee.AZTEC_PARAM).decode(o,i)}catch{throw new q}let l=0;for(let u=0;u<r;u++)l=(l<<4)+o[u];return l}getBullsEyeCorners(e){let t=e,n=e,r=e,i=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let I=this.getFirstDifferent(t,o,1,-1),y=this.getFirstDifferent(n,o,1,1),N=this.getFirstDifferent(r,o,-1,1),L=this.getFirstDifferent(i,o,-1,-1);if(this.nbCenterLayers>2){let V=this.distancePoint(L,I)*this.nbCenterLayers/(this.distancePoint(i,t)*(this.nbCenterLayers+2));if(V<.75||V>1.25||!this.isWhiteOrBlackRectangle(I,y,N,L))break}t=I,n=y,r=N,i=L,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new q;this.compact=this.nbCenterLayers===5;let l=new Se(t.getX()+.5,t.getY()-.5),u=new Se(n.getX()+.5,n.getY()+.5),g=new Se(r.getX()-.5,r.getY()+.5),A=new Se(i.getX()-.5,i.getY()-.5);return this.expandSquare([l,u,g,A],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,n,r;try{let l=new Zt(this.image).detect();e=l[0],t=l[1],n=l[2],r=l[3]}catch{let u=this.image.getWidth()/2,g=this.image.getHeight()/2;e=this.getFirstDifferent(new p(u+7,g-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new p(u+7,g+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new p(u-7,g+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new p(u-7,g-7),!1,-1,-1).toResultPoint()}let i=Xe.round((e.getX()+r.getX()+t.getX()+n.getX())/4),o=Xe.round((e.getY()+r.getY()+t.getY()+n.getY())/4);try{let l=new Zt(this.image,15,i,o).detect();e=l[0],t=l[1],n=l[2],r=l[3]}catch{e=this.getFirstDifferent(new p(i+7,o-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new p(i+7,o+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new p(i-7,o+7),!1,-1,1).toResultPoint(),r=this.getFirstDifferent(new p(i-7,o-7),!1,-1,-1).toResultPoint()}return i=Xe.round((e.getX()+r.getX()+t.getX()+n.getX())/4),o=Xe.round((e.getY()+r.getY()+t.getY()+n.getY())/4),new p(i,o)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,n,r,i){let o=S.getInstance(),l=this.getDimension(),u=l/2-this.nbCenterLayers,g=l/2+this.nbCenterLayers;return o.sampleGrid(e,l,l,u,u,g,u,g,g,u,g,t.getX(),t.getY(),n.getX(),n.getY(),r.getX(),r.getY(),i.getX(),i.getY())}sampleLine(e,t,n){let r=0,i=this.distanceResultPoint(e,t),o=i/n,l=e.getX(),u=e.getY(),g=o*(t.getX()-e.getX())/i,A=o*(t.getY()-e.getY())/i;for(let I=0;I<n;I++)this.image.get(Xe.round(l+I*g),Xe.round(u+I*A))&&(r|=1<<n-I-1);return r}isWhiteOrBlackRectangle(e,t,n,r){let i=3;e=new p(e.getX()-i,e.getY()+i),t=new p(t.getX()-i,t.getY()-i),n=new p(n.getX()+i,n.getY()-i),r=new p(r.getX()+i,r.getY()+i);let o=this.getColor(r,e);if(o===0)return!1;let l=this.getColor(e,t);return l!==o||(l=this.getColor(t,n),l!==o)?!1:(l=this.getColor(n,r),l===o)}getColor(e,t){let n=this.distancePoint(e,t),r=(t.getX()-e.getX())/n,i=(t.getY()-e.getY())/n,o=0,l=e.getX(),u=e.getY(),g=this.image.get(e.getX(),e.getY()),A=Math.ceil(n);for(let y=0;y<A;y++)l+=r,u+=i,this.image.get(Xe.round(l),Xe.round(u))!==g&&o++;let I=o/n;return I>.1&&I<.9?0:I<=.1===g?1:-1}getFirstDifferent(e,t,n,r){let i=e.getX()+n,o=e.getY()+r;for(;this.isValid(i,o)&&this.image.get(i,o)===t;)i+=n,o+=r;for(i-=n,o-=r;this.isValid(i,o)&&this.image.get(i,o)===t;)i+=n;for(i-=n;this.isValid(i,o)&&this.image.get(i,o)===t;)o+=r;return o-=r,new p(i,o)}expandSquare(e,t,n){let r=n/(2*t),i=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),l=(e[0].getX()+e[2].getX())/2,u=(e[0].getY()+e[2].getY())/2,g=new Se(l+r*i,u+r*o),A=new Se(l-r*i,u-r*o);i=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),l=(e[1].getX()+e[3].getX())/2,u=(e[1].getY()+e[3].getY())/2;let I=new Se(l+r*i,u+r*o),y=new Se(l-r*i,u-r*o);return[g,I,A,y]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=Xe.round(e.getX()),n=Xe.round(e.getY());return this.isValid(t,n)}distancePoint(e,t){return Xe.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return Xe.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(J.truncDivision(this.nbLayers-4,8)+1)+15}}class O{decode(e,t=null){let n=null,r=new E(e.getBlackMatrix()),i=null,o=null;try{let A=r.detectMirror(!1);i=A.getPoints(),this.reportFoundResultPoints(t,i),o=new tt().decode(A)}catch(A){n=A}if(o==null)try{let A=r.detectMirror(!0);i=A.getPoints(),this.reportFoundResultPoints(t,i),o=new tt().decode(A)}catch(A){throw n!=null?n:A}let l=new we(o.getText(),o.getRawBytes(),o.getNumBits(),i,Ce.AZTEC,M.currentTimeMillis()),u=o.getByteSegments();u!=null&&l.putMetadata(lt.BYTE_SEGMENTS,u);let g=o.getECLevel();return g!=null&&l.putMetadata(lt.ERROR_CORRECTION_LEVEL,g),l}reportFoundResultPoints(e,t){if(e!=null){let n=e.get($.NEED_RESULT_POINT_CALLBACK);n!=null&&t.forEach((r,i,o)=>{n.foundPossibleResultPoint(r)})}}reset(){}}class X extends fe{constructor(e=500){super(new O,e)}}class j{decode(e,t){try{return this.doDecode(e,t)}catch{if(t&&t.get($.TRY_HARDER)===!0&&e.isRotateSupported()){const i=e.rotateCounterClockwise(),o=this.doDecode(i,t),l=o.getResultMetadata();let u=270;l!==null&&l.get(lt.ORIENTATION)===!0&&(u=u+l.get(lt.ORIENTATION)%360),o.putMetadata(lt.ORIENTATION,u);const g=o.getResultPoints();if(g!==null){const A=i.getHeight();for(let I=0;I<g.length;I++)g[I]=new Se(A-g[I].getY()-1,g[I].getX())}return o}else throw new q}}reset(){}doDecode(e,t){const n=e.getWidth(),r=e.getHeight();let i=new Y(n);const o=t&&t.get($.TRY_HARDER)===!0,l=Math.max(1,r>>(o?8:5));let u;o?u=r:u=15;const g=Math.trunc(r/2);for(let A=0;A<u;A++){const I=Math.trunc((A+1)/2),y=(A&1)===0,N=g+l*(y?I:-I);if(N<0||N>=r)break;try{i=e.getBlackRow(N,i)}catch{continue}for(let L=0;L<2;L++){if(L===1&&(i.reverse(),t&&t.get($.NEED_RESULT_POINT_CALLBACK)===!0)){const V=new Map;t.forEach((Z,te)=>V.set(te,Z)),V.delete($.NEED_RESULT_POINT_CALLBACK),t=V}try{const V=this.decodeRow(N,i,t);if(L===1){V.putMetadata(lt.ORIENTATION,180);const Z=V.getResultPoints();Z!==null&&(Z[0]=new Se(n-Z[0].getX()-1,Z[0].getY()),Z[1]=new Se(n-Z[1].getX()-1,Z[1].getY()))}return V}catch{}}}throw new q}static recordPattern(e,t,n){const r=n.length;for(let g=0;g<r;g++)n[g]=0;const i=e.getSize();if(t>=i)throw new q;let o=!e.get(t),l=0,u=t;for(;u<i;){if(e.get(u)!==o)n[l]++;else{if(++l===r)break;n[l]=1,o=!o}u++}if(!(l===r||l===r-1&&u===i))throw new q}static recordPatternInReverse(e,t,n){let r=n.length,i=e.get(t);for(;t>0&&r>=0;)e.get(--t)!==i&&(r--,i=!i);if(r>=0)throw new q;j.recordPattern(e,t+1,n)}static patternMatchVariance(e,t,n){const r=e.length;let i=0,o=0;for(let g=0;g<r;g++)i+=e[g],o+=t[g];if(i<o)return Number.POSITIVE_INFINITY;const l=i/o;n*=l;let u=0;for(let g=0;g<r;g++){const A=e[g],I=t[g]*l,y=A>I?A-I:I-A;if(y>n)return Number.POSITIVE_INFINITY;u+=y}return u/i}}class H extends j{static findStartPattern(e){const t=e.getSize(),n=e.getNextSet(0);let r=0,i=Int32Array.from([0,0,0,0,0,0]),o=n,l=!1;const u=6;for(let g=n;g<t;g++)if(e.get(g)!==l)i[r]++;else{if(r===u-1){let A=H.MAX_AVG_VARIANCE,I=-1;for(let y=H.CODE_START_A;y<=H.CODE_START_C;y++){const N=j.patternMatchVariance(i,H.CODE_PATTERNS[y],H.MAX_INDIVIDUAL_VARIANCE);N<A&&(A=N,I=y)}if(I>=0&&e.isRange(Math.max(0,o-(g-o)/2),o,!1))return Int32Array.from([o,g,I]);o+=i[0]+i[1],i=i.slice(2,i.length-1),i[r-1]=0,i[r]=0,r--}else r++;i[r]=1,l=!l}throw new q}static decodeCode(e,t,n){j.recordPattern(e,n,t);let r=H.MAX_AVG_VARIANCE,i=-1;for(let o=0;o<H.CODE_PATTERNS.length;o++){const l=H.CODE_PATTERNS[o],u=this.patternMatchVariance(t,l,H.MAX_INDIVIDUAL_VARIANCE);u<r&&(r=u,i=o)}if(i>=0)return i;throw new q}decodeRow(e,t,n){const r=n&&n.get($.ASSUME_GS1)===!0,i=H.findStartPattern(t),o=i[2];let l=0;const u=new Uint8Array(20);u[l++]=o;let g;switch(o){case H.CODE_START_A:g=H.CODE_CODE_A;break;case H.CODE_START_B:g=H.CODE_CODE_B;break;case H.CODE_START_C:g=H.CODE_CODE_C;break;default:throw new U}let A=!1,I=!1,y="",N=i[0],L=i[1];const V=Int32Array.from([0,0,0,0,0,0]);let Z=0,te=0,de=o,ge=0,ue=!0,Ge=!1,Pe=!1;for(;!A;){const Yn=I;switch(I=!1,Z=te,te=H.decodeCode(t,V,L),u[l++]=te,te!==H.CODE_STOP&&(ue=!0),te!==H.CODE_STOP&&(ge++,de+=ge*te),N=L,L+=V.reduce((Uo,Vo)=>Uo+Vo,0),te){case H.CODE_START_A:case H.CODE_START_B:case H.CODE_START_C:throw new U}switch(g){case H.CODE_CODE_A:if(te<64)Pe===Ge?y+=String.fromCharCode(" ".charCodeAt(0)+te):y+=String.fromCharCode(" ".charCodeAt(0)+te+128),Pe=!1;else if(te<96)Pe===Ge?y+=String.fromCharCode(te-64):y+=String.fromCharCode(te+64),Pe=!1;else switch(te!==H.CODE_STOP&&(ue=!1),te){case H.CODE_FNC_1:r&&(y.length===0?y+="]C1":y+=String.fromCharCode(29));break;case H.CODE_FNC_2:case H.CODE_FNC_3:break;case H.CODE_FNC_4_A:!Ge&&Pe?(Ge=!0,Pe=!1):Ge&&Pe?(Ge=!1,Pe=!1):Pe=!0;break;case H.CODE_SHIFT:I=!0,g=H.CODE_CODE_B;break;case H.CODE_CODE_B:g=H.CODE_CODE_B;break;case H.CODE_CODE_C:g=H.CODE_CODE_C;break;case H.CODE_STOP:A=!0;break}break;case H.CODE_CODE_B:if(te<96)Pe===Ge?y+=String.fromCharCode(" ".charCodeAt(0)+te):y+=String.fromCharCode(" ".charCodeAt(0)+te+128),Pe=!1;else switch(te!==H.CODE_STOP&&(ue=!1),te){case H.CODE_FNC_1:r&&(y.length===0?y+="]C1":y+=String.fromCharCode(29));break;case H.CODE_FNC_2:case H.CODE_FNC_3:break;case H.CODE_FNC_4_B:!Ge&&Pe?(Ge=!0,Pe=!1):Ge&&Pe?(Ge=!1,Pe=!1):Pe=!0;break;case H.CODE_SHIFT:I=!0,g=H.CODE_CODE_A;break;case H.CODE_CODE_A:g=H.CODE_CODE_A;break;case H.CODE_CODE_C:g=H.CODE_CODE_C;break;case H.CODE_STOP:A=!0;break}break;case H.CODE_CODE_C:if(te<100)te<10&&(y+="0"),y+=te;else switch(te!==H.CODE_STOP&&(ue=!1),te){case H.CODE_FNC_1:r&&(y.length===0?y+="]C1":y+=String.fromCharCode(29));break;case H.CODE_CODE_A:g=H.CODE_CODE_A;break;case H.CODE_CODE_B:g=H.CODE_CODE_B;break;case H.CODE_STOP:A=!0;break}break}Yn&&(g=g===H.CODE_CODE_A?H.CODE_CODE_B:H.CODE_CODE_A)}const Yt=L-N;if(L=t.getNextUnset(L),!t.isRange(L,Math.min(t.getSize(),L+(L-N)/2),!1))throw new q;if(de-=ge*Z,de%103!==Z)throw new v;const on=y.length;if(on===0)throw new q;on>0&&ue&&(g===H.CODE_CODE_C?y=y.substring(0,on-2):y=y.substring(0,on-1));const zt=(i[1]+i[0])/2,ot=N+Yt/2,kt=u.length,Kt=new Uint8Array(kt);for(let Yn=0;Yn<kt;Yn++)Kt[Yn]=u[Yn];const Wn=[new Se(zt,e),new Se(ot,e)];return new we(y,Kt,0,Wn,Ce.CODE_128,new Date().getTime())}}H.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],H.MAX_AVG_VARIANCE=.25,H.MAX_INDIVIDUAL_VARIANCE=.7,H.CODE_SHIFT=98,H.CODE_CODE_C=99,H.CODE_CODE_B=100,H.CODE_CODE_A=101,H.CODE_FNC_1=102,H.CODE_FNC_2=97,H.CODE_FNC_3=96,H.CODE_FNC_4_A=101,H.CODE_FNC_4_B=100,H.CODE_START_A=103,H.CODE_START_B=104,H.CODE_START_C=105,H.CODE_STOP=106;class Re extends j{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,n){let r=this.counters;r.fill(0),this.decodeRowResult="";let i=Re.findAsteriskPattern(t,r),o=t.getNextSet(i[1]),l=t.getSize(),u,g;do{Re.recordPattern(t,o,r);let V=Re.toNarrowWidePattern(r);if(V<0)throw new q;u=Re.patternToChar(V),this.decodeRowResult+=u,g=o;for(let Z of r)o+=Z;o=t.getNextSet(o)}while(u!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let A=0;for(let V of r)A+=V;let I=o-g-A;if(o!==l&&I*2<A)throw new q;if(this.usingCheckDigit){let V=this.decodeRowResult.length-1,Z=0;for(let te=0;te<V;te++)Z+=Re.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(te));if(this.decodeRowResult.charAt(V)!==Re.ALPHABET_STRING.charAt(Z%43))throw new v;this.decodeRowResult=this.decodeRowResult.substring(0,V)}if(this.decodeRowResult.length===0)throw new q;let y;this.extendedMode?y=Re.decodeExtended(this.decodeRowResult):y=this.decodeRowResult;let N=(i[1]+i[0])/2,L=g+A/2;return new we(y,null,0,[new Se(N,e),new Se(L,e)],Ce.CODE_39,new Date().getTime())}static findAsteriskPattern(e,t){let n=e.getSize(),r=e.getNextSet(0),i=0,o=r,l=!1,u=t.length;for(let g=r;g<n;g++)if(e.get(g)!==l)t[i]++;else{if(i===u-1){if(this.toNarrowWidePattern(t)===Re.ASTERISK_ENCODING&&e.isRange(Math.max(0,o-Math.floor((g-o)/2)),o,!1))return[o,g];o+=t[0]+t[1],t.copyWithin(0,2,2+i-1),t[i-1]=0,t[i]=0,i--}else i++;t[i]=1,l=!l}throw new q}static toNarrowWidePattern(e){let t=e.length,n=0,r;do{let i=2147483647;for(let u of e)u<i&&u>n&&(i=u);n=i,r=0;let o=0,l=0;for(let u=0;u<t;u++){let g=e[u];g>n&&(l|=1<<t-1-u,r++,o+=g)}if(r===3){for(let u=0;u<t&&r>0;u++){let g=e[u];if(g>n&&(r--,g*2>=o))return-1}return l}}while(r>3);return-1}static patternToChar(e){for(let t=0;t<Re.CHARACTER_ENCODINGS.length;t++)if(Re.CHARACTER_ENCODINGS[t]===e)return Re.ALPHABET_STRING.charAt(t);if(e===Re.ASTERISK_ENCODING)return"*";throw new q}static decodeExtended(e){let t=e.length,n="";for(let r=0;r<t;r++){let i=e.charAt(r);if(i==="+"||i==="$"||i==="%"||i==="/"){let o=e.charAt(r+1),l="\0";switch(i){case"+":if(o>="A"&&o<="Z")l=String.fromCharCode(o.charCodeAt(0)+32);else throw new U;break;case"$":if(o>="A"&&o<="Z")l=String.fromCharCode(o.charCodeAt(0)-64);else throw new U;break;case"%":if(o>="A"&&o<="E")l=String.fromCharCode(o.charCodeAt(0)-38);else if(o>="F"&&o<="J")l=String.fromCharCode(o.charCodeAt(0)-11);else if(o>="K"&&o<="O")l=String.fromCharCode(o.charCodeAt(0)+16);else if(o>="P"&&o<="T")l=String.fromCharCode(o.charCodeAt(0)+43);else if(o==="U")l="\0";else if(o==="V")l="@";else if(o==="W")l="`";else if(o==="X"||o==="Y"||o==="Z")l="\x7F";else throw new U;break;case"/":if(o>="A"&&o<="O")l=String.fromCharCode(o.charCodeAt(0)-32);else if(o==="Z")l=":";else throw new U;break}n+=l,r++}else n+=i}return n}}Re.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Re.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Re.ASTERISK_ENCODING=148;class ve extends j{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,n){let r=this.decodeStart(t),i=this.decodeEnd(t),o=new ne;ve.decodeMiddle(t,r[1],i[0],o);let l=o.toString(),u=null;n!=null&&(u=n.get($.ALLOWED_LENGTHS)),u==null&&(u=ve.DEFAULT_ALLOWED_LENGTHS);let g=l.length,A=!1,I=0;for(let L of u){if(g===L){A=!0;break}L>I&&(I=L)}if(!A&&g>I&&(A=!0),!A)throw new U;const y=[new Se(r[1],e),new Se(i[0],e)];return new we(l,null,0,y,Ce.ITF,new Date().getTime())}static decodeMiddle(e,t,n,r){let i=new Int32Array(10),o=new Int32Array(5),l=new Int32Array(5);for(i.fill(0),o.fill(0),l.fill(0);t<n;){j.recordPattern(e,t,i);for(let g=0;g<5;g++){let A=2*g;o[g]=i[A],l[g]=i[A+1]}let u=ve.decodeDigit(o);r.append(u.toString()),u=this.decodeDigit(l),r.append(u.toString()),i.forEach(function(g){t+=g})}}decodeStart(e){let t=ve.skipWhiteSpace(e),n=ve.findGuardPattern(e,t,ve.START_PATTERN);return this.narrowLineWidth=(n[1]-n[0])/4,this.validateQuietZone(e,n[0]),n}validateQuietZone(e,t){let n=this.narrowLineWidth*10;n=n<t?n:t;for(let r=t-1;n>0&&r>=0&&!e.get(r);r--)n--;if(n!==0)throw new q}static skipWhiteSpace(e){const t=e.getSize(),n=e.getNextSet(0);if(n===t)throw new q;return n}decodeEnd(e){e.reverse();try{let t=ve.skipWhiteSpace(e),n;try{n=ve.findGuardPattern(e,t,ve.END_PATTERN_REVERSED[0])}catch(i){i instanceof q&&(n=ve.findGuardPattern(e,t,ve.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,n[0]);let r=n[0];return n[0]=e.getSize()-n[1],n[1]=e.getSize()-r,n}finally{e.reverse()}}static findGuardPattern(e,t,n){let r=n.length,i=new Int32Array(r),o=e.getSize(),l=!1,u=0,g=t;i.fill(0);for(let A=t;A<o;A++)if(e.get(A)!==l)i[u]++;else{if(u===r-1){if(j.patternMatchVariance(i,n,ve.MAX_INDIVIDUAL_VARIANCE)<ve.MAX_AVG_VARIANCE)return[g,A];g+=i[0]+i[1],M.arraycopy(i,2,i,0,u-1),i[u-1]=0,i[u]=0,u--}else u++;i[u]=1,l=!l}throw new q}static decodeDigit(e){let t=ve.MAX_AVG_VARIANCE,n=-1,r=ve.PATTERNS.length;for(let i=0;i<r;i++){let o=ve.PATTERNS[i],l=j.patternMatchVariance(e,o,ve.MAX_INDIVIDUAL_VARIANCE);l<t?(t=l,n=i):l===t&&(n=-1)}if(n>=0)return n%10;throw new q}}ve.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],ve.MAX_AVG_VARIANCE=.38,ve.MAX_INDIVIDUAL_VARIANCE=.5,ve.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],ve.START_PATTERN=Int32Array.from([1,1,1,1]),ve.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Le extends j{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t=!1,n,r=0,i=Int32Array.from([0,0,0]);for(;!t;){i=Int32Array.from([0,0,0]),n=Le.findGuardPattern(e,r,!1,this.START_END_PATTERN,i);let o=n[0];r=n[1];let l=o-(r-o);l>=0&&(t=e.isRange(l,o,!1))}return n}static checkChecksum(e){return Le.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let n=parseInt(e.charAt(t-1),10);return Le.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);if(i<0||i>9)throw new U;n+=i}n*=3;for(let r=t-2;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);if(i<0||i>9)throw new U;n+=i}return(1e3-n)%10}static decodeEnd(e,t){return Le.findGuardPattern(e,t,!1,Le.START_END_PATTERN,new Int32Array(Le.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,n,r){return this.findGuardPattern(e,t,n,r,new Int32Array(r.length))}static findGuardPattern(e,t,n,r,i){let o=e.getSize();t=n?e.getNextUnset(t):e.getNextSet(t);let l=0,u=t,g=r.length,A=n;for(let I=t;I<o;I++)if(e.get(I)!==A)i[l]++;else{if(l===g-1){if(j.patternMatchVariance(i,r,Le.MAX_INDIVIDUAL_VARIANCE)<Le.MAX_AVG_VARIANCE)return Int32Array.from([u,I]);u+=i[0]+i[1];let y=i.slice(2,i.length-1);for(let N=0;N<l-1;N++)i[N]=y[N];i[l-1]=0,i[l]=0,l--}else l++;i[l]=1,A=!A}throw new q}static decodeDigit(e,t,n,r){this.recordPattern(e,n,t);let i=this.MAX_AVG_VARIANCE,o=-1,l=r.length;for(let u=0;u<l;u++){let g=r[u],A=j.patternMatchVariance(t,g,Le.MAX_INDIVIDUAL_VARIANCE);A<i&&(i=A,o=u)}if(o>=0)return o;throw new q}}Le.MAX_AVG_VARIANCE=.48,Le.MAX_INDIVIDUAL_VARIANCE=.7,Le.START_END_PATTERN=Int32Array.from([1,1,1]),Le.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Le.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Le.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class rt{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let r=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,r),o=r.toString(),l=rt.parseExtensionString(o),u=[new Se((n[0]+n[1])/2,e),new Se(i,e)],g=new we(o,null,0,u,Ce.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&g.putAllMetadata(l),g}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),o=t[1],l=0;for(let g=0;g<5&&o<i;g++){let A=Le.decodeDigit(e,r,o,Le.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+A%10);for(let I of r)o+=I;A>=10&&(l|=1<<4-g),g!==4&&(o=e.getNextSet(o),o=e.getNextUnset(o))}if(n.length!==5)throw new q;let u=this.determineCheckDigit(l);if(rt.extensionChecksum(n.toString())!==u)throw new q;return o}static extensionChecksum(e){let t=e.length,n=0;for(let r=t-2;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);n*=3;for(let r=t-1;r>=0;r-=2)n+=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);return n*=3,n%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new q}static parseExtensionString(e){if(e.length!==5)return null;let t=rt.parseExtension5String(e);return t==null?null:new Map([[lt.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="\xA3";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}let n=parseInt(e.substring(1)),r=(n/100).toString(),i=n%100,o=i<10?"0"+i:i.toString();return t+r+"."+o}}class Qe{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,n){let r=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,r),o=r.toString(),l=Qe.parseExtensionString(o),u=[new Se((n[0]+n[1])/2,e),new Se(i,e)],g=new we(o,null,0,u,Ce.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&g.putAllMetadata(l),g}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),o=t[1],l=0;for(let u=0;u<2&&o<i;u++){let g=Le.decodeDigit(e,r,o,Le.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+g%10);for(let A of r)o+=A;g>=10&&(l|=1<<1-u),u!==1&&(o=e.getNextSet(o),o=e.getNextUnset(o))}if(n.length!==2)throw new q;if(parseInt(n.toString())%4!==l)throw new q;return o}static parseExtensionString(e){return e.length!==2?null:new Map([[lt.ISSUE_NUMBER,parseInt(e)]])}}class Gi{static decodeRow(e,t,n){let r=Le.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new rt().decodeRow(e,t,r)}catch{return new Qe().decodeRow(e,t,r)}}}Gi.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class qe extends Le{constructor(){super(),this.decodeRowStringBuffer="",qe.L_AND_G_PATTERNS=qe.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let t=qe.L_PATTERNS[e-10],n=new Int32Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[t.length-r-1];qe.L_AND_G_PATTERNS[e]=n}}decodeRow(e,t,n){let r=qe.findStartGuardPattern(t),i=n==null?null:n.get($.NEED_RESULT_POINT_CALLBACK);if(i!=null){const ue=new Se((r[0]+r[1])/2,e);i.foundPossibleResultPoint(ue)}let o=this.decodeMiddle(t,r,this.decodeRowStringBuffer),l=o.rowOffset,u=o.resultString;if(i!=null){const ue=new Se(l,e);i.foundPossibleResultPoint(ue)}let g=qe.decodeEnd(t,l);if(i!=null){const ue=new Se((g[0]+g[1])/2,e);i.foundPossibleResultPoint(ue)}let A=g[1],I=A+(A-g[0]);if(I>=t.getSize()||!t.isRange(A,I,!1))throw new q;let y=u.toString();if(y.length<8)throw new U;if(!qe.checkChecksum(y))throw new v;let N=(r[1]+r[0])/2,L=(g[1]+g[0])/2,V=this.getBarcodeFormat(),Z=[new Se(N,e),new Se(L,e)],te=new we(y,null,0,Z,V,new Date().getTime()),de=0;try{let ue=Gi.decodeRow(e,t,g[1]);te.putMetadata(lt.UPC_EAN_EXTENSION,ue.getText()),te.putAllMetadata(ue.getResultMetadata()),te.addResultPoints(ue.getResultPoints()),de=ue.getText().length}catch{}let ge=n==null?null:n.get($.ALLOWED_EAN_EXTENSIONS);if(ge!=null){let ue=!1;for(let Ge in ge)if(de.toString()===Ge){ue=!0;break}if(!ue)throw new q}return V===Ce.EAN_13||Ce.UPC_A,te}static checkChecksum(e){return qe.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let n=parseInt(e.charAt(t-1),10);return qe.getStandardUPCEANChecksum(e.substring(0,t-1))===n}static getStandardUPCEANChecksum(e){let t=e.length,n=0;for(let r=t-1;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);if(i<0||i>9)throw new U;n+=i}n*=3;for(let r=t-2;r>=0;r-=2){let i=e.charAt(r).charCodeAt(0)-"0".charCodeAt(0);if(i<0||i>9)throw new U;n+=i}return(1e3-n)%10}static decodeEnd(e,t){return qe.findGuardPattern(e,t,!1,qe.START_END_PATTERN,new Int32Array(qe.START_END_PATTERN.length).fill(0))}}class Tn extends qe{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){let r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),o=t[1],l=0;for(let g=0;g<6&&o<i;g++){let A=qe.decodeDigit(e,r,o,qe.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+A%10);for(let I of r)o+=I;A>=10&&(l|=1<<5-g)}n=Tn.determineFirstDigit(n,l),o=qe.findGuardPattern(e,o,!0,qe.MIDDLE_PATTERN,new Int32Array(qe.MIDDLE_PATTERN.length).fill(0))[1];for(let g=0;g<6&&o<i;g++){let A=qe.decodeDigit(e,r,o,qe.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+A);for(let I of r)o+=I}return{rowOffset:o,resultString:n}}getBarcodeFormat(){return Ce.EAN_13}static determineFirstDigit(e,t){for(let n=0;n<10;n++)if(t===this.FIRST_DIGIT_ENCODINGS[n])return e=String.fromCharCode("0".charCodeAt(0)+n)+e,e;throw new q}}Tn.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Xi extends qe{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,n){const r=this.decodeMiddleCounters;r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),o=t[1];for(let u=0;u<4&&o<i;u++){let g=qe.decodeDigit(e,r,o,qe.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+g);for(let A of r)o+=A}o=qe.findGuardPattern(e,o,!0,qe.MIDDLE_PATTERN,new Int32Array(qe.MIDDLE_PATTERN.length).fill(0))[1];for(let u=0;u<4&&o<i;u++){let g=qe.decodeDigit(e,r,o,qe.L_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+g);for(let A of r)o+=A}return{rowOffset:o,resultString:n}}getBarcodeFormat(){return Ce.EAN_8}}class ao extends qe{constructor(){super(...arguments),this.ean13Reader=new Tn}getBarcodeFormat(){return Ce.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,n){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,n))}decodeMiddle(e,t,n){return this.ean13Reader.decodeMiddle(e,t,n)}maybeReturnResult(e){let t=e.getText();if(t.charAt(0)==="0"){let n=new we(t.substring(1),null,null,e.getResultPoints(),Ce.UPC_A);return e.getResultMetadata()!=null&&n.putAllMetadata(e.getResultMetadata()),n}else throw new q}reset(){this.ean13Reader.reset()}}class sn extends qe{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,n){const r=this.decodeMiddleCounters.map(u=>u);r[0]=0,r[1]=0,r[2]=0,r[3]=0;const i=e.getSize();let o=t[1],l=0;for(let u=0;u<6&&o<i;u++){const g=sn.decodeDigit(e,r,o,sn.L_AND_G_PATTERNS);n+=String.fromCharCode("0".charCodeAt(0)+g%10);for(let A of r)o+=A;g>=10&&(l|=1<<5-u)}return sn.determineNumSysAndCheckDigit(new ne(n),l),o}decodeEnd(e,t){return sn.findGuardPatternWithoutCounters(e,t,!0,sn.MIDDLE_END_PATTERN)}checkChecksum(e){return qe.checkChecksum(sn.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let n=0;n<=1;n++)for(let r=0;r<10;r++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[n][r]){e.insert(0,"0"+n),e.append("0"+r);return}throw q.getNotFoundInstance()}getBarcodeFormat(){return Ce.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map(i=>i.charCodeAt(0)),n=new ne;n.append(e.charAt(0));let r=t[5];switch(r){case 0:case 1:case 2:n.appendChars(t,0,2),n.append(r),n.append("0000"),n.appendChars(t,2,3);break;case 3:n.appendChars(t,0,3),n.append("00000"),n.appendChars(t,3,2);break;case 4:n.appendChars(t,0,4),n.append("00000"),n.append(t[4]);break;default:n.appendChars(t,0,5),n.append("0000"),n.append(r);break}return e.length>=8&&n.append(e.charAt(7)),n.toString()}}sn.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),sn.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])];class ei extends j{constructor(e){super();let t=e==null?null:e.get($.POSSIBLE_FORMATS),n=[];t!=null&&(t.indexOf(Ce.EAN_13)>-1?n.push(new Tn):t.indexOf(Ce.UPC_A)>-1&&n.push(new ao),t.indexOf(Ce.EAN_8)>-1&&n.push(new Xi),t.indexOf(Ce.UPC_E)>-1&&n.push(new sn)),n.length===0&&(n.push(new Tn),n.push(new Xi),n.push(new sn)),this.readers=n}decodeRow(e,t,n){for(let r of this.readers)try{const i=r.decodeRow(e,t,n),o=i.getBarcodeFormat()===Ce.EAN_13&&i.getText().charAt(0)==="0",l=n==null?null:n.get($.POSSIBLE_FORMATS),u=l==null||l.includes(Ce.UPC_A);if(o&&u){const g=i.getRawBytes(),A=new we(i.getText().substring(1),g,g.length,i.getResultPoints(),Ce.UPC_A);return A.putAllMetadata(i.getResultMetadata()),A}return i}catch{}throw new q}reset(){for(let e of this.readers)e.reset()}}class Ut extends j{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let n=0;n<t.length;n++)if(j.patternMatchVariance(e,t[n],Ut.MAX_INDIVIDUAL_VARIANCE)<Ut.MAX_AVG_VARIANCE)return n;throw new q}static count(e){return Xe.sum(new Int32Array(e))}static increment(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]>r&&(r=t[i],n=i);e[n]++}static decrement(e,t){let n=0,r=t[0];for(let i=1;i<e.length;i++)t[i]<r&&(r=t[i],n=i);e[n]--}static isFinderPattern(e){let t=e[0]+e[1],n=t+e[2]+e[3],r=t/n;if(r>=Ut.MIN_FINDER_PATTERN_RATIO&&r<=Ut.MAX_FINDER_PATTERN_RATIO){let i=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER;for(let l of e)l>o&&(o=l),l<i&&(i=l);return o<10*i}return!1}}Ut.MAX_AVG_VARIANCE=.2,Ut.MAX_INDIVIDUAL_VARIANCE=.45,Ut.MIN_FINDER_PATTERN_RATIO=9.5/12,Ut.MAX_FINDER_PATTERN_RATIO=12.5/14;class Pn{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof Pn))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Nr{constructor(e,t,n,r,i){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new Se(n,i)),this.resultPoints.push(new Se(r,i))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof Nr))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class ln{constructor(){}static getRSSvalue(e,t,n){let r=0;for(let u of e)r+=u;let i=0,o=0,l=e.length;for(let u=0;u<l-1;u++){let g;for(g=1,o|=1<<u;g<e[u];g++,o&=~(1<<u)){let A=ln.combins(r-g-1,l-u-2);if(n&&o===0&&r-g-(l-u-1)>=l-u-1&&(A-=ln.combins(r-g-(l-u),l-u-2)),l-u-1>1){let I=0;for(let y=r-g-(l-u-2);y>t;y--)I+=ln.combins(r-g-y-1,l-u-3);A-=I*(l-1-u)}else r-g>t&&A--;i+=A}r-=g}return i}static combins(e,t){let n,r;e-t>t?(r=t,n=e-t):(r=e-t,n=t);let i=1,o=1;for(let l=e;l>n;l--)i*=l,o<=r&&(i/=o,o++);for(;o<=r;)i/=o,o++;return i}}class co{static buildBitArray(e){let t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);let n=12*t,r=new Y(n),i=0,l=e[0].getRightChar().getValue();for(let u=11;u>=0;--u)(l&1<<u)!=0&&r.set(i),i++;for(let u=1;u<e.length;++u){let g=e[u],A=g.getLeftChar().getValue();for(let I=11;I>=0;--I)(A&1<<I)!=0&&r.set(i),i++;if(g.getRightChar()!=null){let I=g.getRightChar().getValue();for(let y=11;y>=0;--y)(I&1<<y)!=0&&r.set(i),i++}}return r}}class Nn{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class ti{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class Gt extends ti{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===Gt.FNC1}}Gt.FNC1="$";class Rn extends ti{constructor(e,t,n){super(e),n?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class $t extends ti{constructor(e,t,n){if(super(e),t<0||t>10||n<0||n>10)throw new U;this.firstDigit=t,this.secondDigit=n}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===$t.FNC1}isSecondDigitFNC1(){return this.secondDigit===$t.FNC1}isAnyFNC1(){return this.firstDigit===$t.FNC1||this.secondDigit===$t.FNC1}}$t.FNC1=10;class be{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new q;let t=e.substring(0,2);for(let i of be.TWO_DIGIT_DATA_LENGTH)if(i[0]===t)return i[1]===be.VARIABLE_LENGTH?be.processVariableAI(2,i[2],e):be.processFixedAI(2,i[1],e);if(e.length<3)throw new q;let n=e.substring(0,3);for(let i of be.THREE_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===be.VARIABLE_LENGTH?be.processVariableAI(3,i[2],e):be.processFixedAI(3,i[1],e);for(let i of be.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===be.VARIABLE_LENGTH?be.processVariableAI(4,i[2],e):be.processFixedAI(4,i[1],e);if(e.length<4)throw new q;let r=e.substring(0,4);for(let i of be.FOUR_DIGIT_DATA_LENGTH)if(i[0]===r)return i[1]===be.VARIABLE_LENGTH?be.processVariableAI(4,i[2],e):be.processFixedAI(4,i[1],e);throw new q}static processFixedAI(e,t,n){if(n.length<e)throw new q;let r=n.substring(0,e);if(n.length<e+t)throw new q;let i=n.substring(e,e+t),o=n.substring(e+t),l="("+r+")"+i,u=be.parseFieldsInGeneralPurpose(o);return u==null?l:l+u}static processVariableAI(e,t,n){let r=n.substring(0,e),i;n.length<e+t?i=n.length:i=e+t;let o=n.substring(e,i),l=n.substring(i),u="("+r+")"+o,g=be.parseFieldsInGeneralPurpose(l);return g==null?u:u+g}}be.VARIABLE_LENGTH=[],be.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",be.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",be.VARIABLE_LENGTH,20],["22",be.VARIABLE_LENGTH,29],["30",be.VARIABLE_LENGTH,8],["37",be.VARIABLE_LENGTH,8],["90",be.VARIABLE_LENGTH,30],["91",be.VARIABLE_LENGTH,30],["92",be.VARIABLE_LENGTH,30],["93",be.VARIABLE_LENGTH,30],["94",be.VARIABLE_LENGTH,30],["95",be.VARIABLE_LENGTH,30],["96",be.VARIABLE_LENGTH,30],["97",be.VARIABLE_LENGTH,3],["98",be.VARIABLE_LENGTH,30],["99",be.VARIABLE_LENGTH,30]],be.THREE_DIGIT_DATA_LENGTH=[["240",be.VARIABLE_LENGTH,30],["241",be.VARIABLE_LENGTH,30],["242",be.VARIABLE_LENGTH,6],["250",be.VARIABLE_LENGTH,30],["251",be.VARIABLE_LENGTH,30],["253",be.VARIABLE_LENGTH,17],["254",be.VARIABLE_LENGTH,20],["400",be.VARIABLE_LENGTH,30],["401",be.VARIABLE_LENGTH,30],["402",17],["403",be.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",be.VARIABLE_LENGTH,20],["421",be.VARIABLE_LENGTH,15],["422",3],["423",be.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],be.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",be.VARIABLE_LENGTH,15],["391",be.VARIABLE_LENGTH,18],["392",be.VARIABLE_LENGTH,15],["393",be.VARIABLE_LENGTH,18],["703",be.VARIABLE_LENGTH,30]],be.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",be.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",be.VARIABLE_LENGTH,20],["8003",be.VARIABLE_LENGTH,30],["8004",be.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",be.VARIABLE_LENGTH,30],["8008",be.VARIABLE_LENGTH,12],["8018",18],["8020",be.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",be.VARIABLE_LENGTH,70],["8200",be.VARIABLE_LENGTH,70]];class Fn{constructor(e){this.buffer=new ne,this.information=e}decodeAllCodes(e,t){let n=t,r=null;do{let i=this.decodeGeneralPurposeField(n,r),o=be.parseFieldsInGeneralPurpose(i.getNewString());if(o!=null&&e.append(o),i.isRemaining()?r=""+i.getRemainingValue():r=null,n===i.getNewPosition())break;n=i.getNewPosition()}while(!0);return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let i=this.extractNumericValueFromBitArray(e,4);return i===0?new $t(this.information.getSize(),$t.FNC1,$t.FNC1):new $t(this.information.getSize(),i-1,$t.FNC1)}let t=this.extractNumericValueFromBitArray(e,7),n=(t-8)/11,r=(t-8)%11;return new $t(e+7,n,r)}extractNumericValueFromBitArray(e,t){return Fn.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,n){let r=0;for(let i=0;i<n;++i)e.get(t+i)&&(r|=1<<n-i-1);return r}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);let n=this.parseBlocks();return n!=null&&n.isRemaining()?new Rn(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new Rn(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let n=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),!(n!==this.current.getPosition())&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return e.isSecondDigitFNC1()?t=new Rn(this.current.getPosition(),this.buffer.toString()):t=new Rn(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Nn(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let t=new Rn(this.current.getPosition(),this.buffer.toString());return new Nn(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Nn(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new Rn(this.current.getPosition(),this.buffer.toString());return new Nn(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Nn(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new Rn(this.current.getPosition(),this.buffer.toString());return new Nn(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Nn(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,8);return r>=232&&r<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new Gt(e+5,Gt.FNC1);if(t>=5&&t<15)return new Gt(e+5,"0"+(t-5));let n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new Gt(e+7,""+(n+1));if(n>=90&&n<116)return new Gt(e+7,""+(n+7));let r=this.extractNumericValueFromBitArray(e,8),i;switch(r){case 232:i="!";break;case 233:i='"';break;case 234:i="%";break;case 235:i="&";break;case 236:i="'";break;case 237:i="(";break;case 238:i=")";break;case 239:i="*";break;case 240:i="+";break;case 241:i=",";break;case 242:i="-";break;case 243:i=".";break;case 244:i="/";break;case 245:i=":";break;case 246:i=";";break;case 247:i="<";break;case 248:i="=";break;case 249:i=">";break;case 250:i="?";break;case 251:i="_";break;case 252:i=" ";break;default:throw new U}return new Gt(e+8,i)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new Gt(e+5,Gt.FNC1);if(t>=5&&t<15)return new Gt(e+5,"0"+(t-5));let n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new Gt(e+6,""+(n+33));let r;switch(n){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new yt("Decoding invalid alphanumeric value: "+n)}return new Gt(e+6,r)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class Wi{constructor(e){this.information=e,this.generalDecoder=new Fn(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Xt extends Wi{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let n=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,n)}encodeCompressedGtinWithoutAI(e,t,n){for(let r=0;r<4;++r){let i=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*r,10);i/100===0&&e.append("0"),i/10===0&&e.append("0"),e.append(i)}Xt.appendCheckDigit(e,n)}static appendCheckDigit(e,t){let n=0;for(let r=0;r<13;r++){let i=e.charAt(r+t).charCodeAt(0)-"0".charCodeAt(0);n+=(r&1)===0?3*i:i}n=10-n%10,n===10&&(n=0),e.append(n)}}Xt.GTIN_SIZE=40;class Un extends Xt{constructor(e){super(e)}parseInformation(){let e=new ne;e.append("(01)");let t=e.length(),n=this.getGeneralDecoder().extractNumericValueFromBitArray(Un.HEADER_SIZE,4);return e.append(n),this.encodeCompressedGtinWithoutAI(e,Un.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,Un.HEADER_SIZE+44)}}Un.HEADER_SIZE=1+1+2;class Rr extends Wi{constructor(e){super(e)}parseInformation(){let e=new ne;return this.getGeneralDecoder().decodeAllCodes(e,Rr.HEADER_SIZE)}}Rr.HEADER_SIZE=2+1+2;class Or extends Xt{constructor(e){super(e)}encodeCompressedWeight(e,t,n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,n);this.addWeightCode(e,r);let i=this.checkWeight(r),o=1e5;for(let l=0;l<5;++l)i/o===0&&e.append("0"),o/=10;e.append(i)}}class an extends Or{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=an.HEADER_SIZE+Or.GTIN_SIZE+an.WEIGHT_SIZE)throw new q;let e=new ne;return this.encodeCompressedGtin(e,an.HEADER_SIZE),this.encodeCompressedWeight(e,an.HEADER_SIZE+Or.GTIN_SIZE,an.WEIGHT_SIZE),e.toString()}}an.HEADER_SIZE=4+1,an.WEIGHT_SIZE=15;class uo extends an{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class fo extends an{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class cn extends Xt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<cn.HEADER_SIZE+Xt.GTIN_SIZE)throw new q;let e=new ne;this.encodeCompressedGtin(e,cn.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(cn.HEADER_SIZE+Xt.GTIN_SIZE,cn.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let n=this.getGeneralDecoder().decodeGeneralPurposeField(cn.HEADER_SIZE+Xt.GTIN_SIZE+cn.LAST_DIGIT_SIZE,null);return e.append(n.getNewString()),e.toString()}}cn.HEADER_SIZE=5+1+2,cn.LAST_DIGIT_SIZE=2;class Ht extends Xt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<Ht.HEADER_SIZE+Xt.GTIN_SIZE)throw new q;let e=new ne;this.encodeCompressedGtin(e,Ht.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(Ht.HEADER_SIZE+Xt.GTIN_SIZE,Ht.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let n=this.getGeneralDecoder().extractNumericValueFromBitArray(Ht.HEADER_SIZE+Xt.GTIN_SIZE+Ht.LAST_DIGIT_SIZE,Ht.FIRST_THREE_DIGITS_SIZE);n/100==0&&e.append("0"),n/10==0&&e.append("0"),e.append(n);let r=this.getGeneralDecoder().decodeGeneralPurposeField(Ht.HEADER_SIZE+Xt.GTIN_SIZE+Ht.LAST_DIGIT_SIZE+Ht.FIRST_THREE_DIGITS_SIZE,null);return e.append(r.getNewString()),e.toString()}}Ht.HEADER_SIZE=5+1+2,Ht.LAST_DIGIT_SIZE=2,Ht.FIRST_THREE_DIGITS_SIZE=10;class ft extends Or{constructor(e,t,n){super(e),this.dateCode=n,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=ft.HEADER_SIZE+ft.GTIN_SIZE+ft.WEIGHT_SIZE+ft.DATE_SIZE)throw new q;let e=new ne;return this.encodeCompressedGtin(e,ft.HEADER_SIZE),this.encodeCompressedWeight(e,ft.HEADER_SIZE+ft.GTIN_SIZE,ft.WEIGHT_SIZE),this.encodeCompressedDate(e,ft.HEADER_SIZE+ft.GTIN_SIZE+ft.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t,ft.DATE_SIZE);if(n==38400)return;e.append("("),e.append(this.dateCode),e.append(")");let r=n%32;n/=32;let i=n%12+1;n/=12;let o=n;o/10==0&&e.append("0"),e.append(o),i/10==0&&e.append("0"),e.append(i),r/10==0&&e.append("0"),e.append(r)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}ft.HEADER_SIZE=7+1,ft.WEIGHT_SIZE=20,ft.DATE_SIZE=16;function ho(b){try{if(b.get(1))return new Un(b);if(!b.get(2))return new Rr(b);switch(Fn.extractNumericValueFromBitArray(b,1,4)){case 4:return new uo(b);case 5:return new fo(b)}switch(Fn.extractNumericValueFromBitArray(b,1,5)){case 12:return new cn(b);case 13:return new Ht(b)}switch(Fn.extractNumericValueFromBitArray(b,1,7)){case 56:return new ft(b,"310","11");case 57:return new ft(b,"320","11");case 58:return new ft(b,"310","13");case 59:return new ft(b,"320","13");case 60:return new ft(b,"310","15");case 61:return new ft(b,"320","15");case 62:return new ft(b,"310","17");case 63:return new ft(b,"320","17")}}catch(e){throw console.log(e),new yt("unknown decoder: "+b)}}class mn{constructor(e,t,n,r){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=r}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof mn?mn.equalsOrNull(e.leftchar,t.leftchar)&&mn.equalsOrNull(e.rightchar,t.rightchar)&&mn.equalsOrNull(e.finderpattern,t.finderpattern):!1}static equalsOrNull(e,t){return e===null?t===null:mn.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ni{constructor(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof ni?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1}checkEqualitity(e,t){if(!e||!t)return;let n;return e.forEach((r,i)=>{t.forEach(o=>{r.getLeftChar().getValue()===o.getLeftChar().getValue()&&r.getRightChar().getValue()===o.getRightChar().getValue()&&r.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}}class ce extends Ut{constructor(e){super(...arguments),this.pairs=new Array(ce.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=e===!0}decodeRow(e,t,n){this.pairs.length=0,this.startFromEven=!1;try{return ce.constructResult(this.decodeRow2pairs(e,t))}catch(r){this.verbose&&console.log(r)}return this.pairs.length=0,this.startFromEven=!0,ce.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let n=!1;for(;!n;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(i){if(i instanceof q){if(!this.pairs.length)throw new q;n=!0}}if(this.checkChecksum())return this.pairs;let r;if(this.rows.length?r=!0:r=!1,this.storeRow(e,!1),r){let i=this.checkRowsBoolean(!1);if(i!=null||(i=this.checkRowsBoolean(!0),i!=null))return i}throw new q}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(n){this.verbose&&console.log(n)}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let n=t;n<this.rows.length;n++){let r=this.rows[n];this.pairs.length=0;for(let o of e)this.pairs.push(o.getPairs());if(this.pairs.push(r.getPairs()),!ce.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let i=new Array(e);i.push(r);try{return this.checkRows(i,n+1)}catch(o){this.verbose&&console.log(o)}}throw new q}static isValidSequence(e){for(let t of ce.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let n=!0;for(let r=0;r<e.length;r++)if(e[r].getFinderPattern().getValue()!=t[r]){n=!1;break}if(n)return!0}return!1}storeRow(e,t){let n=0,r=!1,i=!1;for(;n<this.rows.length;){let o=this.rows[n];if(o.getRowNumber()>e){i=o.isEquivalent(this.pairs);break}r=o.isEquivalent(this.pairs),n++}i||r||ce.isPartialRow(this.pairs,this.rows)||(this.rows.push(n,new ni(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let n of t)if(n.getPairs().length!==e.length){for(let r of n.getPairs())for(let i of e)if(mn.equals(r,i))break}}static isPartialRow(e,t){for(let n of t){let r=!0;for(let i of e){let o=!1;for(let l of n.getPairs())if(i.equals(l)){o=!0;break}if(!o){r=!1;break}}if(r)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=co.buildBitArray(e),r=ho(t).parseInformation(),i=e[0].getFinderPattern().getResultPoints(),o=e[e.length-1].getFinderPattern().getResultPoints(),l=[i[0],i[1],o[0],o[1]];return new we(r,null,null,l,Ce.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),n=e.getRightChar();if(n==null)return!1;let r=n.getChecksumPortion(),i=2;for(let l=1;l<this.pairs.size();++l){let u=this.pairs.get(l);r+=u.getLeftChar().getChecksumPortion(),i++;let g=u.getRightChar();g!=null&&(r+=g.getChecksumPortion(),i++)}return r%=211,211*(i-4)+r==t.getValue()}static getNextSecondBar(e,t){let n;return e.get(t)?(n=e.getNextUnset(t),n=e.getNextSet(n)):(n=e.getNextSet(t),n=e.getNextUnset(n)),n}retrieveNextPair(e,t,n){let r=t.length%2==0;this.startFromEven&&(r=!r);let i,o=!0,l=-1;do this.findNextPair(e,t,l),i=this.parseFoundFinderPattern(e,n,r),i==null?l=ce.getNextSecondBar(e,this.startEnd[0]):o=!1;while(o);let u=this.decodeDataCharacter(e,i,r,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new q;let g;try{g=this.decodeDataCharacter(e,i,r,!1)}catch(A){g=null,this.verbose&&console.log(A)}return new mn(u,g,i,!0)}isEmptyPair(e){return e.length===0}findNextPair(e,t,n){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),o;n>=0?o=n:this.isEmptyPair(t)?o=0:o=t[t.length-1].getFinderPattern().getStartEnd()[1];let l=t.length%2!=0;this.startFromEven&&(l=!l);let u=!1;for(;o<i&&(u=!e.get(o),!!u);)o++;let g=0,A=o;for(let I=o;I<i;I++)if(e.get(I)!=u)r[g]++;else{if(g==3){if(l&&ce.reverseCounters(r),ce.isFinderPattern(r)){this.startEnd[0]=A,this.startEnd[1]=I;return}l&&ce.reverseCounters(r),A+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,g--}else g++;r[g]=1,u=!u}throw new q}static reverseCounters(e){let t=e.length;for(let n=0;n<t/2;++n){let r=e[n];e[n]=e[t-n-1],e[t-n-1]=r}}parseFoundFinderPattern(e,t,n){let r,i,o;if(n){let g=this.startEnd[0]-1;for(;g>=0&&!e.get(g);)g--;g++,r=this.startEnd[0]-g,i=g,o=this.startEnd[1]}else i=this.startEnd[0],o=e.getNextUnset(this.startEnd[1]+1),r=o-this.startEnd[1];let l=this.getDecodeFinderCounters();M.arraycopy(l,0,l,1,l.length-1),l[0]=r;let u;try{u=this.parseFinderValue(l,ce.FINDER_PATTERNS)}catch{return null}return new Nr(u,[i,o],i,o,t)}decodeDataCharacter(e,t,n,r){let i=this.getDataCharacterCounters();for(let ot=0;ot<i.length;ot++)i[ot]=0;if(r)ce.recordPatternInReverse(e,t.getStartEnd()[0],i);else{ce.recordPattern(e,t.getStartEnd()[1],i);for(let ot=0,kt=i.length-1;ot<kt;ot++,kt--){let Kt=i[ot];i[ot]=i[kt],i[kt]=Kt}}let o=17,l=Xe.sum(new Int32Array(i))/o,u=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(l-u)/u>.3)throw new q;let g=this.getOddCounts(),A=this.getEvenCounts(),I=this.getOddRoundingErrors(),y=this.getEvenRoundingErrors();for(let ot=0;ot<i.length;ot++){let kt=1*i[ot]/l,Kt=kt+.5;if(Kt<1){if(kt<.3)throw new q;Kt=1}else if(Kt>8){if(kt>8.7)throw new q;Kt=8}let Wn=ot/2;(ot&1)==0?(g[Wn]=Kt,I[Wn]=kt-Kt):(A[Wn]=Kt,y[Wn]=kt-Kt)}this.adjustOddEvenCounts(o);let N=4*t.getValue()+(n?0:2)+(r?0:1)-1,L=0,V=0;for(let ot=g.length-1;ot>=0;ot--){if(ce.isNotA1left(t,n,r)){let kt=ce.WEIGHTS[N][2*ot];V+=g[ot]*kt}L+=g[ot]}let Z=0;for(let ot=A.length-1;ot>=0;ot--)if(ce.isNotA1left(t,n,r)){let kt=ce.WEIGHTS[N][2*ot+1];Z+=A[ot]*kt}let te=V+Z;if((L&1)!=0||L>13||L<4)throw new q;let de=(13-L)/2,ge=ce.SYMBOL_WIDEST[de],ue=9-ge,Ge=ln.getRSSvalue(g,ge,!0),Pe=ln.getRSSvalue(A,ue,!1),Yt=ce.EVEN_TOTAL_SUBSET[de],on=ce.GSUM[de],zt=Ge*Yt+Pe+on;return new Pn(zt,te)}static isNotA1left(e,t,n){return!(e.getValue()==0&&t&&n)}adjustOddEvenCounts(e){let t=Xe.sum(new Int32Array(this.getOddCounts())),n=Xe.sum(new Int32Array(this.getEvenCounts())),r=!1,i=!1;t>13?i=!0:t<4&&(r=!0);let o=!1,l=!1;n>13?l=!0:n<4&&(o=!0);let u=t+n-e,g=(t&1)==1,A=(n&1)==0;if(u==1)if(g){if(A)throw new q;i=!0}else{if(!A)throw new q;l=!0}else if(u==-1)if(g){if(A)throw new q;r=!0}else{if(!A)throw new q;o=!0}else if(u==0){if(g){if(!A)throw new q;t<n?(r=!0,l=!0):(i=!0,o=!0)}else if(A)throw new q}else throw new q;if(r){if(i)throw new q;ce.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&ce.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(l)throw new q;ce.increment(this.getEvenCounts(),this.getOddRoundingErrors())}l&&ce.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ce.SYMBOL_WIDEST=[7,5,4,3,1],ce.EVEN_TOTAL_SUBSET=[4,20,52,104,204],ce.GSUM=[0,348,1388,2948,3988],ce.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],ce.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],ce.FINDER_PAT_A=0,ce.FINDER_PAT_B=1,ce.FINDER_PAT_C=2,ce.FINDER_PAT_D=3,ce.FINDER_PAT_E=4,ce.FINDER_PAT_F=5,ce.FINDER_PATTERN_SEQUENCES=[[ce.FINDER_PAT_A,ce.FINDER_PAT_A],[ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B],[ce.FINDER_PAT_A,ce.FINDER_PAT_C,ce.FINDER_PAT_B,ce.FINDER_PAT_D],[ce.FINDER_PAT_A,ce.FINDER_PAT_E,ce.FINDER_PAT_B,ce.FINDER_PAT_D,ce.FINDER_PAT_C],[ce.FINDER_PAT_A,ce.FINDER_PAT_E,ce.FINDER_PAT_B,ce.FINDER_PAT_D,ce.FINDER_PAT_D,ce.FINDER_PAT_F],[ce.FINDER_PAT_A,ce.FINDER_PAT_E,ce.FINDER_PAT_B,ce.FINDER_PAT_D,ce.FINDER_PAT_E,ce.FINDER_PAT_F,ce.FINDER_PAT_F],[ce.FINDER_PAT_A,ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B,ce.FINDER_PAT_C,ce.FINDER_PAT_C,ce.FINDER_PAT_D,ce.FINDER_PAT_D],[ce.FINDER_PAT_A,ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B,ce.FINDER_PAT_C,ce.FINDER_PAT_C,ce.FINDER_PAT_D,ce.FINDER_PAT_E,ce.FINDER_PAT_E],[ce.FINDER_PAT_A,ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B,ce.FINDER_PAT_C,ce.FINDER_PAT_C,ce.FINDER_PAT_D,ce.FINDER_PAT_E,ce.FINDER_PAT_F,ce.FINDER_PAT_F],[ce.FINDER_PAT_A,ce.FINDER_PAT_A,ce.FINDER_PAT_B,ce.FINDER_PAT_B,ce.FINDER_PAT_C,ce.FINDER_PAT_D,ce.FINDER_PAT_D,ce.FINDER_PAT_E,ce.FINDER_PAT_E,ce.FINDER_PAT_F,ce.FINDER_PAT_F]],ce.MAX_PAIRS=11;class go extends Pn{constructor(e,t,n){super(e,t),this.count=0,this.finderPattern=n}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class xt extends Ut{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,n){const r=this.decodePair(t,!1,e,n);xt.addOrTally(this.possibleLeftPairs,r),t.reverse();let i=this.decodePair(t,!0,e,n);xt.addOrTally(this.possibleRightPairs,i),t.reverse();for(let o of this.possibleLeftPairs)if(o.getCount()>1){for(let l of this.possibleRightPairs)if(l.getCount()>1&&xt.checkChecksum(o,l))return xt.constructResult(o,l)}throw new q}static addOrTally(e,t){if(t==null)return;let n=!1;for(let r of e)if(r.getValue()===t.getValue()){r.incrementCount(),n=!0;break}n||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let n=4537077*e.getValue()+t.getValue(),r=new String(n).toString(),i=new ne;for(let g=13-r.length;g>0;g--)i.append("0");i.append(r);let o=0;for(let g=0;g<13;g++){let A=i.charAt(g).charCodeAt(0)-"0".charCodeAt(0);o+=(g&1)===0?3*A:A}o=10-o%10,o===10&&(o=0),i.append(o.toString());let l=e.getFinderPattern().getResultPoints(),u=t.getFinderPattern().getResultPoints();return new we(i.toString(),null,0,[l[0],l[1],u[0],u[1]],Ce.RSS_14,new Date().getTime())}static checkChecksum(e,t){let n=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,r=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return r>72&&r--,r>8&&r--,n===r}decodePair(e,t,n,r){try{let i=this.findFinderPattern(e,t),o=this.parseFoundFinderPattern(e,n,t,i),l=r==null?null:r.get($.NEED_RESULT_POINT_CALLBACK);if(l!=null){let A=(i[0]+i[1])/2;t&&(A=e.getSize()-1-A),l.foundPossibleResultPoint(new Se(A,n))}let u=this.decodeDataCharacter(e,o,!0),g=this.decodeDataCharacter(e,o,!1);return new go(1597*u.getValue()+g.getValue(),u.getChecksumPortion()+4*g.getChecksumPortion(),o)}catch{return null}}decodeDataCharacter(e,t,n){let r=this.getDataCharacterCounters();for(let Z=0;Z<r.length;Z++)r[Z]=0;if(n)j.recordPatternInReverse(e,t.getStartEnd()[0],r);else{j.recordPattern(e,t.getStartEnd()[1]+1,r);for(let Z=0,te=r.length-1;Z<te;Z++,te--){let de=r[Z];r[Z]=r[te],r[te]=de}}let i=n?16:15,o=Xe.sum(new Int32Array(r))/i,l=this.getOddCounts(),u=this.getEvenCounts(),g=this.getOddRoundingErrors(),A=this.getEvenRoundingErrors();for(let Z=0;Z<r.length;Z++){let te=r[Z]/o,de=Math.floor(te+.5);de<1?de=1:de>8&&(de=8);let ge=Math.floor(Z/2);(Z&1)===0?(l[ge]=de,g[ge]=te-de):(u[ge]=de,A[ge]=te-de)}this.adjustOddEvenCounts(n,i);let I=0,y=0;for(let Z=l.length-1;Z>=0;Z--)y*=9,y+=l[Z],I+=l[Z];let N=0,L=0;for(let Z=u.length-1;Z>=0;Z--)N*=9,N+=u[Z],L+=u[Z];let V=y+3*N;if(n){if((I&1)!==0||I>12||I<4)throw new q;let Z=(12-I)/2,te=xt.OUTSIDE_ODD_WIDEST[Z],de=9-te,ge=ln.getRSSvalue(l,te,!1),ue=ln.getRSSvalue(u,de,!0),Ge=xt.OUTSIDE_EVEN_TOTAL_SUBSET[Z],Pe=xt.OUTSIDE_GSUM[Z];return new Pn(ge*Ge+ue+Pe,V)}else{if((L&1)!==0||L>10||L<4)throw new q;let Z=(10-L)/2,te=xt.INSIDE_ODD_WIDEST[Z],de=9-te,ge=ln.getRSSvalue(l,te,!0),ue=ln.getRSSvalue(u,de,!1),Ge=xt.INSIDE_ODD_TOTAL_SUBSET[Z],Pe=xt.INSIDE_GSUM[Z];return new Pn(ue*Ge+ge+Pe,V)}}findFinderPattern(e,t){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let r=e.getSize(),i=!1,o=0;for(;o<r&&(i=!e.get(o),t!==i);)o++;let l=0,u=o;for(let g=o;g<r;g++)if(e.get(g)!==i)n[l]++;else{if(l===3){if(Ut.isFinderPattern(n))return[u,g];u+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,l--}else l++;n[l]=1,i=!i}throw new q}parseFoundFinderPattern(e,t,n,r){let i=e.get(r[0]),o=r[0]-1;for(;o>=0&&i!==e.get(o);)o--;o++;const l=r[0]-o,u=this.getDecodeFinderCounters(),g=new Int32Array(u.length);M.arraycopy(u,0,g,1,u.length-1),g[0]=l;const A=this.parseFinderValue(g,xt.FINDER_PATTERNS);let I=o,y=r[1];return n&&(I=e.getSize()-1-I,y=e.getSize()-1-y),new Nr(A,[o,r[1]],I,y,t)}adjustOddEvenCounts(e,t){let n=Xe.sum(new Int32Array(this.getOddCounts())),r=Xe.sum(new Int32Array(this.getEvenCounts())),i=!1,o=!1,l=!1,u=!1;e?(n>12?o=!0:n<4&&(i=!0),r>12?u=!0:r<4&&(l=!0)):(n>11?o=!0:n<5&&(i=!0),r>10?u=!0:r<4&&(l=!0));let g=n+r-t,A=(n&1)===(e?1:0),I=(r&1)===1;if(g===1)if(A){if(I)throw new q;o=!0}else{if(!I)throw new q;u=!0}else if(g===-1)if(A){if(I)throw new q;i=!0}else{if(!I)throw new q;l=!0}else if(g===0){if(A){if(!I)throw new q;n<r?(i=!0,u=!0):(o=!0,l=!0)}else if(I)throw new q}else throw new q;if(i){if(o)throw new q;Ut.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&Ut.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(u)throw new q;Ut.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&Ut.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}xt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],xt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],xt.OUTSIDE_GSUM=[0,161,961,2015,2715],xt.INSIDE_GSUM=[0,336,1036,1516],xt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],xt.INSIDE_ODD_WIDEST=[2,4,6,8],xt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Vn extends j{constructor(e,t){super(),this.readers=[],this.verbose=t===!0;const n=e?e.get($.POSSIBLE_FORMATS):null,r=e&&e.get($.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;n&&((n.includes(Ce.EAN_13)||n.includes(Ce.UPC_A)||n.includes(Ce.EAN_8)||n.includes(Ce.UPC_E))&&this.readers.push(new ei(e)),n.includes(Ce.CODE_39)&&this.readers.push(new Re(r)),n.includes(Ce.CODE_128)&&this.readers.push(new H),n.includes(Ce.ITF)&&this.readers.push(new ve),n.includes(Ce.RSS_14)&&this.readers.push(new xt),n.includes(Ce.RSS_EXPANDED)&&this.readers.push(new ce(this.verbose))),this.readers.length===0&&(this.readers.push(new ei(e)),this.readers.push(new Re),this.readers.push(new ei(e)),this.readers.push(new H),this.readers.push(new ve),this.readers.push(new xt),this.readers.push(new ce(this.verbose)))}decodeRow(e,t,n){for(let r=0;r<this.readers.length;r++)try{return this.readers[r].decodeRow(e,t,n)}catch{}throw new q}reset(){this.readers.forEach(e=>e.reset())}}class xo extends fe{constructor(e=500,t){super(new Vn(t),e,t)}}class nt{constructor(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class $e{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class We{constructor(e,t,n,r,i,o){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=r,this.dataRegionSizeColumns=i,this.ecBlocks=o;let l=0;const u=o.getECCodewords(),g=o.getECBlocks();for(let A of g)l+=A.getCount()*(A.getDataCodewords()+u);this.totalCodewords=l}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if((e&1)!==0||(t&1)!==0)throw new U;for(let n of We.VERSIONS)if(n.symbolSizeRows===e&&n.symbolSizeColumns===t)return n;throw new U}toString(){return""+this.versionNumber}static buildVersions(){return[new We(1,10,10,8,8,new nt(5,new $e(1,3))),new We(2,12,12,10,10,new nt(7,new $e(1,5))),new We(3,14,14,12,12,new nt(10,new $e(1,8))),new We(4,16,16,14,14,new nt(12,new $e(1,12))),new We(5,18,18,16,16,new nt(14,new $e(1,18))),new We(6,20,20,18,18,new nt(18,new $e(1,22))),new We(7,22,22,20,20,new nt(20,new $e(1,30))),new We(8,24,24,22,22,new nt(24,new $e(1,36))),new We(9,26,26,24,24,new nt(28,new $e(1,44))),new We(10,32,32,14,14,new nt(36,new $e(1,62))),new We(11,36,36,16,16,new nt(42,new $e(1,86))),new We(12,40,40,18,18,new nt(48,new $e(1,114))),new We(13,44,44,20,20,new nt(56,new $e(1,144))),new We(14,48,48,22,22,new nt(68,new $e(1,174))),new We(15,52,52,24,24,new nt(42,new $e(2,102))),new We(16,64,64,14,14,new nt(56,new $e(2,140))),new We(17,72,72,16,16,new nt(36,new $e(4,92))),new We(18,80,80,18,18,new nt(48,new $e(4,114))),new We(19,88,88,20,20,new nt(56,new $e(4,144))),new We(20,96,96,22,22,new nt(68,new $e(4,174))),new We(21,104,104,24,24,new nt(56,new $e(6,136))),new We(22,120,120,18,18,new nt(68,new $e(6,175))),new We(23,132,132,20,20,new nt(62,new $e(8,163))),new We(24,144,144,22,22,new nt(62,new $e(8,156),new $e(2,155))),new We(25,8,18,6,16,new nt(7,new $e(1,5))),new We(26,8,32,6,14,new nt(11,new $e(1,10))),new We(27,12,26,10,24,new nt(14,new $e(1,16))),new We(28,12,36,10,16,new nt(18,new $e(1,22))),new We(29,16,36,14,16,new nt(24,new $e(1,32))),new We(30,16,48,14,22,new nt(28,new $e(1,49)))]}}We.VERSIONS=We.buildVersions();class ri{constructor(e){const t=e.getHeight();if(t<8||t>144||(t&1)!==0)throw new U;this.version=ri.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new Ae(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),n=e.getWidth();return We.getVersionForDimensions(t,n)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,n=4,r=0;const i=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth();let l=!1,u=!1,g=!1,A=!1;do if(n===i&&r===0&&!l)e[t++]=this.readCorner1(i,o)&255,n-=2,r+=2,l=!0;else if(n===i-2&&r===0&&(o&3)!==0&&!u)e[t++]=this.readCorner2(i,o)&255,n-=2,r+=2,u=!0;else if(n===i+4&&r===2&&(o&7)===0&&!g)e[t++]=this.readCorner3(i,o)&255,n-=2,r+=2,g=!0;else if(n===i-2&&r===0&&(o&7)===4&&!A)e[t++]=this.readCorner4(i,o)&255,n-=2,r+=2,A=!0;else{do n<i&&r>=0&&!this.readMappingMatrix.get(r,n)&&(e[t++]=this.readUtah(n,r,i,o)&255),n-=2,r+=2;while(n>=0&&r<o);n+=1,r+=3;do n>=0&&r<o&&!this.readMappingMatrix.get(r,n)&&(e[t++]=this.readUtah(n,r,i,o)&255),n+=2,r-=2;while(n<i&&r>=0);n+=3,r+=1}while(n<i||r<o);if(t!==this.version.getTotalCodewords())throw new U;return e}readModule(e,t,n,r){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=r,e+=4-(r+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,n,r){let i=0;return this.readModule(e-2,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-2,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e-1,t,n,r)&&(i|=1),i<<=1,this.readModule(e,t-2,n,r)&&(i|=1),i<<=1,this.readModule(e,t-1,n,r)&&(i|=1),i<<=1,this.readModule(e,t,n,r)&&(i|=1),i}readCorner1(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}readCorner2(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner3(e,t){let n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n}readCorner4(e,t){let n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new _("Dimension of bitMatrix must match the version size");const r=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),o=t/r|0,l=n/i|0,u=o*r,g=l*i,A=new Ae(g,u);for(let I=0;I<o;++I){const y=I*r;for(let N=0;N<l;++N){const L=N*i;for(let V=0;V<r;++V){const Z=I*(r+2)+1+V,te=y+V;for(let de=0;de<i;++de){const ge=N*(i+2)+1+de;if(e.get(ge,Z)){const ue=L+de;A.set(ue,te)}}}}}return A}}class ii{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const n=t.getECBlocks();let r=0;const i=n.getECBlocks();for(let V of i)r+=V.getCount();const o=new Array(r);let l=0;for(let V of i)for(let Z=0;Z<V.getCount();Z++){const te=V.getDataCodewords(),de=n.getECCodewords()+te;o[l++]=new ii(te,new Uint8Array(de))}const g=o[0].codewords.length-n.getECCodewords(),A=g-1;let I=0;for(let V=0;V<A;V++)for(let Z=0;Z<l;Z++)o[Z].codewords[V]=e[I++];const y=t.getVersionNumber()===24,N=y?8:l;for(let V=0;V<N;V++)o[V].codewords[g-1]=e[I++];const L=o[0].codewords.length;for(let V=g;V<L;V++)for(let Z=0;Z<l;Z++){const te=y?(Z+8)%l:Z,de=y&&te>7?V-1:V;o[te].codewords[de]=e[I++]}if(I!==e.length)throw new _;return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class si{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new _(""+e);let t=0,n=this.bitOffset,r=this.byteOffset;const i=this.bytes;if(n>0){const o=8-n,l=e<o?e:o,u=o-l,g=255>>8-l<<u;t=(i[r]&g)>>u,e-=l,n+=l,n===8&&(n=0,r++)}if(e>0){for(;e>=8;)t=t<<8|i[r]&255,r++,e-=8;if(e>0){const o=8-e,l=255>>o<<o;t=t<<e|(i[r]&l)>>o,n+=e}}return this.bitOffset=n,this.byteOffset=r,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Tt;(function(b){b[b.PAD_ENCODE=0]="PAD_ENCODE",b[b.ASCII_ENCODE=1]="ASCII_ENCODE",b[b.C40_ENCODE=2]="C40_ENCODE",b[b.TEXT_ENCODE=3]="TEXT_ENCODE",b[b.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",b[b.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",b[b.BASE256_ENCODE=6]="BASE256_ENCODE"})(Tt||(Tt={}));class En{static decode(e){const t=new si(e),n=new ne,r=new ne,i=new Array;let o=Tt.ASCII_ENCODE;do if(o===Tt.ASCII_ENCODE)o=this.decodeAsciiSegment(t,n,r);else{switch(o){case Tt.C40_ENCODE:this.decodeC40Segment(t,n);break;case Tt.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case Tt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case Tt.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case Tt.BASE256_ENCODE:this.decodeBase256Segment(t,n,i);break;default:throw new U}o=Tt.ASCII_ENCODE}while(o!==Tt.PAD_ENCODE&&t.available()>0);return r.length()>0&&n.append(r.toString()),new ht(e,n.toString(),i.length===0?null:i,null)}static decodeAsciiSegment(e,t,n){let r=!1;do{let i=e.readBits(8);if(i===0)throw new U;if(i<=128)return r&&(i+=128),t.append(String.fromCharCode(i-1)),Tt.ASCII_ENCODE;if(i===129)return Tt.PAD_ENCODE;if(i<=229){const o=i-130;o<10&&t.append("0"),t.append(""+o)}else switch(i){case 230:return Tt.C40_ENCODE;case 231:return Tt.BASE256_ENCODE;case 232:t.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:r=!0;break;case 236:t.append("[)>05"),n.insert(0,"");break;case 237:t.append("[)>06"),n.insert(0,"");break;case 238:return Tt.ANSIX12_ENCODE;case 239:return Tt.TEXT_ENCODE;case 240:return Tt.EDIFACT_ENCODE;case 241:break;default:if(i!==254||e.available()!==0)throw new U;break}}while(e.available()>0);return Tt.ASCII_ENCODE}static decodeC40Segment(e,t){let n=!1;const r=[];let i=0;do{if(e.available()===8)return;const o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),r);for(let l=0;l<3;l++){const u=r[l];switch(i){case 0:if(u<3)i=u+1;else if(u<this.C40_BASIC_SET_CHARS.length){const g=this.C40_BASIC_SET_CHARS[u];n?(t.append(String.fromCharCode(g.charCodeAt(0)+128)),n=!1):t.append(g)}else throw new U;break;case 1:n?(t.append(String.fromCharCode(u+128)),n=!1):t.append(String.fromCharCode(u)),i=0;break;case 2:if(u<this.C40_SHIFT2_SET_CHARS.length){const g=this.C40_SHIFT2_SET_CHARS[u];n?(t.append(String.fromCharCode(g.charCodeAt(0)+128)),n=!1):t.append(g)}else switch(u){case 27:t.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new U}i=0;break;case 3:n?(t.append(String.fromCharCode(u+224)),n=!1):t.append(String.fromCharCode(u+96)),i=0;break;default:throw new U}}}while(e.available()>0)}static decodeTextSegment(e,t){let n=!1,r=[],i=0;do{if(e.available()===8)return;const o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),r);for(let l=0;l<3;l++){const u=r[l];switch(i){case 0:if(u<3)i=u+1;else if(u<this.TEXT_BASIC_SET_CHARS.length){const g=this.TEXT_BASIC_SET_CHARS[u];n?(t.append(String.fromCharCode(g.charCodeAt(0)+128)),n=!1):t.append(g)}else throw new U;break;case 1:n?(t.append(String.fromCharCode(u+128)),n=!1):t.append(String.fromCharCode(u)),i=0;break;case 2:if(u<this.TEXT_SHIFT2_SET_CHARS.length){const g=this.TEXT_SHIFT2_SET_CHARS[u];n?(t.append(String.fromCharCode(g.charCodeAt(0)+128)),n=!1):t.append(g)}else switch(u){case 27:t.append(String.fromCharCode(29));break;case 30:n=!0;break;default:throw new U}i=0;break;case 3:if(u<this.TEXT_SHIFT3_SET_CHARS.length){const g=this.TEXT_SHIFT3_SET_CHARS[u];n?(t.append(String.fromCharCode(g.charCodeAt(0)+128)),n=!1):t.append(g),i=0}else throw new U;break;default:throw new U}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const n=[];do{if(e.available()===8)return;const r=e.readBits(8);if(r===254)return;this.parseTwoBytes(r,e.readBits(8),n);for(let i=0;i<3;i++){const o=n[i];switch(o){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(o<14)t.append(String.fromCharCode(o+44));else if(o<40)t.append(String.fromCharCode(o+51));else throw new U;break}}}while(e.available()>0)}static parseTwoBytes(e,t,n){let r=(e<<8)+t-1,i=Math.floor(r/1600);n[0]=i,r-=i*1600,i=Math.floor(r/40),n[1]=i,n[2]=r-i*40}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let n=0;n<4;n++){let r=e.readBits(6);if(r===31){const i=8-e.getBitOffset();i!==8&&e.readBits(i);return}(r&32)===0&&(r|=64),t.append(String.fromCharCode(r))}}while(e.available()>0)}static decodeBase256Segment(e,t,n){let r=1+e.getByteOffset();const i=this.unrandomize255State(e.readBits(8),r++);let o;if(i===0?o=e.available()/8|0:i<250?o=i:o=250*(i-249)+this.unrandomize255State(e.readBits(8),r++),o<0)throw new U;const l=new Uint8Array(o);for(let u=0;u<o;u++){if(e.available()<8)throw new U;l[u]=this.unrandomize255State(e.readBits(8),r++)}n.push(l);try{t.append(pe.decode(l,ae.ISO88591))}catch(u){throw new yt("Platform does not support required encoding: "+u.message)}}static unrandomize255State(e,t){const n=149*t%255+1,r=e-n;return r>=0?r:r+256}}En.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],En.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],En.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],En.TEXT_SHIFT2_SET_CHARS=En.C40_SHIFT2_SET_CHARS,En.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class wo{constructor(){this.rsDecoder=new Sn(Ee.DATA_MATRIX_FIELD_256)}decode(e){const t=new ri(e),n=t.getVersion(),r=t.readCodewords(),i=ii.getDataBlocks(r,n);let o=0;for(let g of i)o+=g.getNumDataCodewords();const l=new Uint8Array(o),u=i.length;for(let g=0;g<u;g++){const A=i[g],I=A.getCodewords(),y=A.getNumDataCodewords();this.correctErrors(I,y);for(let N=0;N<y;N++)l[N*u+g]=I[N]}return En.decode(l)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new v}for(let r=0;r<t;r++)e[r]=n[r]}}class mt{constructor(e){this.image=e,this.rectangleDetector=new Zt(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new q;t=this.shiftToModuleCenter(t);const n=t[0],r=t[1],i=t[2],o=t[3];let l=this.transitionsBetween(n,o)+1,u=this.transitionsBetween(i,o)+1;(l&1)===1&&(l+=1),(u&1)===1&&(u+=1),4*l<7*u&&4*u<7*l&&(l=u=Math.max(l,u));let g=mt.sampleGrid(this.image,n,r,i,o,l,u);return new wn(g,[n,r,i,o])}static shiftPoint(e,t,n){let r=(t.getX()-e.getX())/(n+1),i=(t.getY()-e.getY())/(n+1);return new Se(e.getX()+r,e.getY()+i)}static moveAway(e,t,n){let r=e.getX(),i=e.getY();return r<t?r-=1:r+=1,i<n?i-=1:i+=1,new Se(r,i)}detectSolid1(e){let t=e[0],n=e[1],r=e[3],i=e[2],o=this.transitionsBetween(t,n),l=this.transitionsBetween(n,r),u=this.transitionsBetween(r,i),g=this.transitionsBetween(i,t),A=o,I=[i,t,n,r];return A>l&&(A=l,I[0]=t,I[1]=n,I[2]=r,I[3]=i),A>u&&(A=u,I[0]=n,I[1]=r,I[2]=i,I[3]=t),A>g&&(I[0]=r,I[1]=i,I[2]=t,I[3]=n),I}detectSolid2(e){let t=e[0],n=e[1],r=e[2],i=e[3],o=this.transitionsBetween(t,i),l=mt.shiftPoint(n,r,(o+1)*4),u=mt.shiftPoint(r,n,(o+1)*4),g=this.transitionsBetween(l,t),A=this.transitionsBetween(u,i);return g<A?(e[0]=t,e[1]=n,e[2]=r,e[3]=i):(e[0]=n,e[1]=r,e[2]=i,e[3]=t),e}correctTopRight(e){let t=e[0],n=e[1],r=e[2],i=e[3],o=this.transitionsBetween(t,i),l=this.transitionsBetween(n,i),u=mt.shiftPoint(t,n,(l+1)*4),g=mt.shiftPoint(r,n,(o+1)*4);o=this.transitionsBetween(u,i),l=this.transitionsBetween(g,i);let A=new Se(i.getX()+(r.getX()-n.getX())/(o+1),i.getY()+(r.getY()-n.getY())/(o+1)),I=new Se(i.getX()+(t.getX()-n.getX())/(l+1),i.getY()+(t.getY()-n.getY())/(l+1));if(!this.isValid(A))return this.isValid(I)?I:null;if(!this.isValid(I))return A;let y=this.transitionsBetween(u,A)+this.transitionsBetween(g,A),N=this.transitionsBetween(u,I)+this.transitionsBetween(g,I);return y>N?A:I}shiftToModuleCenter(e){let t=e[0],n=e[1],r=e[2],i=e[3],o=this.transitionsBetween(t,i)+1,l=this.transitionsBetween(r,i)+1,u=mt.shiftPoint(t,n,l*4),g=mt.shiftPoint(r,n,o*4);o=this.transitionsBetween(u,i)+1,l=this.transitionsBetween(g,i)+1,(o&1)===1&&(o+=1),(l&1)===1&&(l+=1);let A=(t.getX()+n.getX()+r.getX()+i.getX())/4,I=(t.getY()+n.getY()+r.getY()+i.getY())/4;t=mt.moveAway(t,A,I),n=mt.moveAway(n,A,I),r=mt.moveAway(r,A,I),i=mt.moveAway(i,A,I);let y,N;return u=mt.shiftPoint(t,n,l*4),u=mt.shiftPoint(u,i,o*4),y=mt.shiftPoint(n,t,l*4),y=mt.shiftPoint(y,r,o*4),g=mt.shiftPoint(r,i,l*4),g=mt.shiftPoint(g,n,o*4),N=mt.shiftPoint(i,r,l*4),N=mt.shiftPoint(N,t,o*4),[u,y,g,N]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,n,r,i,o,l){return S.getInstance().sampleGrid(e,o,l,.5,.5,o-.5,.5,o-.5,l-.5,.5,l-.5,t.getX(),t.getY(),i.getX(),i.getY(),r.getX(),r.getY(),n.getX(),n.getY())}transitionsBetween(e,t){let n=Math.trunc(e.getX()),r=Math.trunc(e.getY()),i=Math.trunc(t.getX()),o=Math.trunc(t.getY()),l=Math.abs(o-r)>Math.abs(i-n);if(l){let V=n;n=r,r=V,V=i,i=o,o=V}let u=Math.abs(i-n),g=Math.abs(o-r),A=-u/2,I=r<o?1:-1,y=n<i?1:-1,N=0,L=this.image.get(l?r:n,l?n:r);for(let V=n,Z=r;V!==i;V+=y){let te=this.image.get(l?Z:V,l?V:Z);if(te!==L&&(N++,L=te),A+=g,A>0){if(Z===o)break;Z+=I,A-=u}}return N}}class An{constructor(){this.decoder=new wo}decode(e,t=null){let n,r;if(t!=null&&t.has($.PURE_BARCODE)){const g=An.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(g),r=An.NO_POINTS}else{const g=new mt(e.getBlackMatrix()).detect();n=this.decoder.decode(g.getBits()),r=g.getPoints()}const i=n.getRawBytes(),o=new we(n.getText(),i,8*i.length,r,Ce.DATA_MATRIX,M.currentTimeMillis()),l=n.getByteSegments();l!=null&&o.putMetadata(lt.BYTE_SEGMENTS,l);const u=n.getECLevel();return u!=null&&o.putMetadata(lt.ERROR_CORRECTION_LEVEL,u),o}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t==null||n==null)throw new q;const r=this.moduleSize(t,e);let i=t[1];const o=n[1];let l=t[0];const g=(n[0]-l+1)/r,A=(o-i+1)/r;if(g<=0||A<=0)throw new q;const I=r/2;i+=I,l+=I;const y=new Ae(g,A);for(let N=0;N<A;N++){const L=i+N*r;for(let V=0;V<g;V++)e.get(l+V*r,L)&&y.set(V,N)}return y}static moduleSize(e,t){const n=t.getWidth();let r=e[0];const i=e[1];for(;r<n&&t.get(r,i);)r++;if(r===n)throw new q;const o=r-e[0];if(o===0)throw new q;return o}}An.NO_POINTS=[];class po extends fe{constructor(e=500){super(new An,e)}}var Hn;(function(b){b[b.L=0]="L",b[b.M=1]="M",b[b.Q=2]="Q",b[b.H=3]="H"})(Hn||(Hn={}));class at{constructor(e,t,n){this.value=e,this.stringValue=t,this.bits=n,at.FOR_BITS.set(n,this),at.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return at.L;case"M":return at.M;case"Q":return at.Q;case"H":return at.H;default:throw new C(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof at))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=at.FOR_BITS.size)throw new _;return at.FOR_BITS.get(e)}}at.FOR_BITS=new Map,at.FOR_VALUE=new Map,at.L=new at(Hn.L,"L",1),at.M=new at(Hn.M,"M",0),at.Q=new at(Hn.Q,"Q",3),at.H=new at(Hn.H,"H",2);class Vt{constructor(e){this.errorCorrectionLevel=at.forBits(e>>3&3),this.dataMask=e&7}static numBitsDiffering(e,t){return J.bitCount(e^t)}static decodeFormatInformation(e,t){const n=Vt.doDecodeFormatInformation(e,t);return n!==null?n:Vt.doDecodeFormatInformation(e^Vt.FORMAT_INFO_MASK_QR,t^Vt.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let n=Number.MAX_SAFE_INTEGER,r=0;for(const i of Vt.FORMAT_INFO_DECODE_LOOKUP){const o=i[0];if(o===e||o===t)return new Vt(i[1]);let l=Vt.numBitsDiffering(e,o);l<n&&(r=i[1],n=l),e!==t&&(l=Vt.numBitsDiffering(t,o),l<n&&(r=i[1],n=l))}return n<=3?new Vt(r):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof Vt))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}Vt.FORMAT_INFO_MASK_QR=21522,Vt.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class K{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const n of t)e+=n.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class T{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Oe{constructor(e,t,...n){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=n;let r=0;const i=n[0].getECCodewordsPerBlock(),o=n[0].getECBlocks();for(const l of o)r+=l.getCount()*(l.getDataCodewords()+i);this.totalCodewords=r}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!==1)throw new U;try{return this.getVersionForNumber((e-17)/4)}catch{throw new U}}static getVersionForNumber(e){if(e<1||e>40)throw new _;return Oe.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,n=0;for(let r=0;r<Oe.VERSION_DECODE_INFO.length;r++){const i=Oe.VERSION_DECODE_INFO[r];if(i===e)return Oe.getVersionForNumber(r+7);const o=Vt.numBitsDiffering(e,i);o<t&&(n=r+7,t=o)}return t<=3?Oe.getVersionForNumber(n):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new Ae(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const n=this.alignmentPatternCenters.length;for(let r=0;r<n;r++){const i=this.alignmentPatternCenters[r]-2;for(let o=0;o<n;o++)r===0&&(o===0||o===n-1)||r===n-1&&o===0||t.setRegion(this.alignmentPatternCenters[o]-2,i,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}Oe.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Oe.VERSIONS=[new Oe(1,new Int32Array(0),new K(7,new T(1,19)),new K(10,new T(1,16)),new K(13,new T(1,13)),new K(17,new T(1,9))),new Oe(2,Int32Array.from([6,18]),new K(10,new T(1,34)),new K(16,new T(1,28)),new K(22,new T(1,22)),new K(28,new T(1,16))),new Oe(3,Int32Array.from([6,22]),new K(15,new T(1,55)),new K(26,new T(1,44)),new K(18,new T(2,17)),new K(22,new T(2,13))),new Oe(4,Int32Array.from([6,26]),new K(20,new T(1,80)),new K(18,new T(2,32)),new K(26,new T(2,24)),new K(16,new T(4,9))),new Oe(5,Int32Array.from([6,30]),new K(26,new T(1,108)),new K(24,new T(2,43)),new K(18,new T(2,15),new T(2,16)),new K(22,new T(2,11),new T(2,12))),new Oe(6,Int32Array.from([6,34]),new K(18,new T(2,68)),new K(16,new T(4,27)),new K(24,new T(4,19)),new K(28,new T(4,15))),new Oe(7,Int32Array.from([6,22,38]),new K(20,new T(2,78)),new K(18,new T(4,31)),new K(18,new T(2,14),new T(4,15)),new K(26,new T(4,13),new T(1,14))),new Oe(8,Int32Array.from([6,24,42]),new K(24,new T(2,97)),new K(22,new T(2,38),new T(2,39)),new K(22,new T(4,18),new T(2,19)),new K(26,new T(4,14),new T(2,15))),new Oe(9,Int32Array.from([6,26,46]),new K(30,new T(2,116)),new K(22,new T(3,36),new T(2,37)),new K(20,new T(4,16),new T(4,17)),new K(24,new T(4,12),new T(4,13))),new Oe(10,Int32Array.from([6,28,50]),new K(18,new T(2,68),new T(2,69)),new K(26,new T(4,43),new T(1,44)),new K(24,new T(6,19),new T(2,20)),new K(28,new T(6,15),new T(2,16))),new Oe(11,Int32Array.from([6,30,54]),new K(20,new T(4,81)),new K(30,new T(1,50),new T(4,51)),new K(28,new T(4,22),new T(4,23)),new K(24,new T(3,12),new T(8,13))),new Oe(12,Int32Array.from([6,32,58]),new K(24,new T(2,92),new T(2,93)),new K(22,new T(6,36),new T(2,37)),new K(26,new T(4,20),new T(6,21)),new K(28,new T(7,14),new T(4,15))),new Oe(13,Int32Array.from([6,34,62]),new K(26,new T(4,107)),new K(22,new T(8,37),new T(1,38)),new K(24,new T(8,20),new T(4,21)),new K(22,new T(12,11),new T(4,12))),new Oe(14,Int32Array.from([6,26,46,66]),new K(30,new T(3,115),new T(1,116)),new K(24,new T(4,40),new T(5,41)),new K(20,new T(11,16),new T(5,17)),new K(24,new T(11,12),new T(5,13))),new Oe(15,Int32Array.from([6,26,48,70]),new K(22,new T(5,87),new T(1,88)),new K(24,new T(5,41),new T(5,42)),new K(30,new T(5,24),new T(7,25)),new K(24,new T(11,12),new T(7,13))),new Oe(16,Int32Array.from([6,26,50,74]),new K(24,new T(5,98),new T(1,99)),new K(28,new T(7,45),new T(3,46)),new K(24,new T(15,19),new T(2,20)),new K(30,new T(3,15),new T(13,16))),new Oe(17,Int32Array.from([6,30,54,78]),new K(28,new T(1,107),new T(5,108)),new K(28,new T(10,46),new T(1,47)),new K(28,new T(1,22),new T(15,23)),new K(28,new T(2,14),new T(17,15))),new Oe(18,Int32Array.from([6,30,56,82]),new K(30,new T(5,120),new T(1,121)),new K(26,new T(9,43),new T(4,44)),new K(28,new T(17,22),new T(1,23)),new K(28,new T(2,14),new T(19,15))),new Oe(19,Int32Array.from([6,30,58,86]),new K(28,new T(3,113),new T(4,114)),new K(26,new T(3,44),new T(11,45)),new K(26,new T(17,21),new T(4,22)),new K(26,new T(9,13),new T(16,14))),new Oe(20,Int32Array.from([6,34,62,90]),new K(28,new T(3,107),new T(5,108)),new K(26,new T(3,41),new T(13,42)),new K(30,new T(15,24),new T(5,25)),new K(28,new T(15,15),new T(10,16))),new Oe(21,Int32Array.from([6,28,50,72,94]),new K(28,new T(4,116),new T(4,117)),new K(26,new T(17,42)),new K(28,new T(17,22),new T(6,23)),new K(30,new T(19,16),new T(6,17))),new Oe(22,Int32Array.from([6,26,50,74,98]),new K(28,new T(2,111),new T(7,112)),new K(28,new T(17,46)),new K(30,new T(7,24),new T(16,25)),new K(24,new T(34,13))),new Oe(23,Int32Array.from([6,30,54,78,102]),new K(30,new T(4,121),new T(5,122)),new K(28,new T(4,47),new T(14,48)),new K(30,new T(11,24),new T(14,25)),new K(30,new T(16,15),new T(14,16))),new Oe(24,Int32Array.from([6,28,54,80,106]),new K(30,new T(6,117),new T(4,118)),new K(28,new T(6,45),new T(14,46)),new K(30,new T(11,24),new T(16,25)),new K(30,new T(30,16),new T(2,17))),new Oe(25,Int32Array.from([6,32,58,84,110]),new K(26,new T(8,106),new T(4,107)),new K(28,new T(8,47),new T(13,48)),new K(30,new T(7,24),new T(22,25)),new K(30,new T(22,15),new T(13,16))),new Oe(26,Int32Array.from([6,30,58,86,114]),new K(28,new T(10,114),new T(2,115)),new K(28,new T(19,46),new T(4,47)),new K(28,new T(28,22),new T(6,23)),new K(30,new T(33,16),new T(4,17))),new Oe(27,Int32Array.from([6,34,62,90,118]),new K(30,new T(8,122),new T(4,123)),new K(28,new T(22,45),new T(3,46)),new K(30,new T(8,23),new T(26,24)),new K(30,new T(12,15),new T(28,16))),new Oe(28,Int32Array.from([6,26,50,74,98,122]),new K(30,new T(3,117),new T(10,118)),new K(28,new T(3,45),new T(23,46)),new K(30,new T(4,24),new T(31,25)),new K(30,new T(11,15),new T(31,16))),new Oe(29,Int32Array.from([6,30,54,78,102,126]),new K(30,new T(7,116),new T(7,117)),new K(28,new T(21,45),new T(7,46)),new K(30,new T(1,23),new T(37,24)),new K(30,new T(19,15),new T(26,16))),new Oe(30,Int32Array.from([6,26,52,78,104,130]),new K(30,new T(5,115),new T(10,116)),new K(28,new T(19,47),new T(10,48)),new K(30,new T(15,24),new T(25,25)),new K(30,new T(23,15),new T(25,16))),new Oe(31,Int32Array.from([6,30,56,82,108,134]),new K(30,new T(13,115),new T(3,116)),new K(28,new T(2,46),new T(29,47)),new K(30,new T(42,24),new T(1,25)),new K(30,new T(23,15),new T(28,16))),new Oe(32,Int32Array.from([6,34,60,86,112,138]),new K(30,new T(17,115)),new K(28,new T(10,46),new T(23,47)),new K(30,new T(10,24),new T(35,25)),new K(30,new T(19,15),new T(35,16))),new Oe(33,Int32Array.from([6,30,58,86,114,142]),new K(30,new T(17,115),new T(1,116)),new K(28,new T(14,46),new T(21,47)),new K(30,new T(29,24),new T(19,25)),new K(30,new T(11,15),new T(46,16))),new Oe(34,Int32Array.from([6,34,62,90,118,146]),new K(30,new T(13,115),new T(6,116)),new K(28,new T(14,46),new T(23,47)),new K(30,new T(44,24),new T(7,25)),new K(30,new T(59,16),new T(1,17))),new Oe(35,Int32Array.from([6,30,54,78,102,126,150]),new K(30,new T(12,121),new T(7,122)),new K(28,new T(12,47),new T(26,48)),new K(30,new T(39,24),new T(14,25)),new K(30,new T(22,15),new T(41,16))),new Oe(36,Int32Array.from([6,24,50,76,102,128,154]),new K(30,new T(6,121),new T(14,122)),new K(28,new T(6,47),new T(34,48)),new K(30,new T(46,24),new T(10,25)),new K(30,new T(2,15),new T(64,16))),new Oe(37,Int32Array.from([6,28,54,80,106,132,158]),new K(30,new T(17,122),new T(4,123)),new K(28,new T(29,46),new T(14,47)),new K(30,new T(49,24),new T(10,25)),new K(30,new T(24,15),new T(46,16))),new Oe(38,Int32Array.from([6,32,58,84,110,136,162]),new K(30,new T(4,122),new T(18,123)),new K(28,new T(13,46),new T(32,47)),new K(30,new T(48,24),new T(14,25)),new K(30,new T(42,15),new T(32,16))),new Oe(39,Int32Array.from([6,26,54,82,110,138,166]),new K(30,new T(20,117),new T(4,118)),new K(28,new T(40,47),new T(7,48)),new K(30,new T(43,24),new T(22,25)),new K(30,new T(10,15),new T(67,16))),new Oe(40,Int32Array.from([6,30,58,86,114,142,170]),new K(30,new T(19,118),new T(6,119)),new K(28,new T(18,47),new T(31,48)),new K(30,new T(34,24),new T(34,25)),new K(30,new T(20,15),new T(61,16)))];var Ot;(function(b){b[b.DATA_MASK_000=0]="DATA_MASK_000",b[b.DATA_MASK_001=1]="DATA_MASK_001",b[b.DATA_MASK_010=2]="DATA_MASK_010",b[b.DATA_MASK_011=3]="DATA_MASK_011",b[b.DATA_MASK_100=4]="DATA_MASK_100",b[b.DATA_MASK_101=5]="DATA_MASK_101",b[b.DATA_MASK_110=6]="DATA_MASK_110",b[b.DATA_MASK_111=7]="DATA_MASK_111"})(Ot||(Ot={}));class Jt{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let n=0;n<t;n++)for(let r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)}}Jt.values=new Map([[Ot.DATA_MASK_000,new Jt(Ot.DATA_MASK_000,(b,e)=>(b+e&1)===0)],[Ot.DATA_MASK_001,new Jt(Ot.DATA_MASK_001,(b,e)=>(b&1)===0)],[Ot.DATA_MASK_010,new Jt(Ot.DATA_MASK_010,(b,e)=>e%3===0)],[Ot.DATA_MASK_011,new Jt(Ot.DATA_MASK_011,(b,e)=>(b+e)%3===0)],[Ot.DATA_MASK_100,new Jt(Ot.DATA_MASK_100,(b,e)=>(Math.floor(b/2)+Math.floor(e/3)&1)===0)],[Ot.DATA_MASK_101,new Jt(Ot.DATA_MASK_101,(b,e)=>b*e%6===0)],[Ot.DATA_MASK_110,new Jt(Ot.DATA_MASK_110,(b,e)=>b*e%6<3)],[Ot.DATA_MASK_111,new Jt(Ot.DATA_MASK_111,(b,e)=>(b+e+b*e%3&1)===0)]]);class mo{constructor(e){const t=e.getHeight();if(t<21||(t&3)!==1)throw new U;this.bitMatrix=e}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let e=0;for(let i=0;i<6;i++)e=this.copyBit(i,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let i=5;i>=0;i--)e=this.copyBit(8,i,e);const t=this.bitMatrix.getHeight();let n=0;const r=t-7;for(let i=t-1;i>=r;i--)n=this.copyBit(8,i,n);for(let i=t-8;i<t;i++)n=this.copyBit(i,8,n);if(this.parsedFormatInfo=Vt.decodeFormatInformation(e,n),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new U}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return Oe.getVersionForNumber(t);let n=0;const r=e-11;for(let o=5;o>=0;o--)for(let l=e-9;l>=r;l--)n=this.copyBit(l,o,n);let i=Oe.decodeVersionInformation(n);if(i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;n=0;for(let o=5;o>=0;o--)for(let l=e-9;l>=r;l--)n=this.copyBit(o,l,n);if(i=Oe.decodeVersionInformation(n),i!==null&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;throw new U}copyBit(e,t,n){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?n<<1|1:n<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),n=Jt.values.get(e.getDataMask()),r=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,r);const i=t.buildFunctionPattern();let o=!0;const l=new Uint8Array(t.getTotalCodewords());let u=0,g=0,A=0;for(let I=r-1;I>0;I-=2){I===6&&I--;for(let y=0;y<r;y++){const N=o?r-1-y:y;for(let L=0;L<2;L++)i.get(I-L,N)||(A++,g<<=1,this.bitMatrix.get(I-L,N)&&(g|=1),A===8&&(l[u++]=g,A=0,g=0))}o=!o}if(u!==t.getTotalCodewords())throw new U;return l}remask(){if(this.parsedFormatInfo===null)return;const e=Jt.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,n=e.getWidth();t<n;t++)for(let r=t+1,i=e.getHeight();r<i;r++)e.get(t,r)!==e.get(r,t)&&(e.flip(r,t),e.flip(t,r))}}class oi{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,n){if(e.length!==t.getTotalCodewords())throw new _;const r=t.getECBlocksForLevel(n);let i=0;const o=r.getECBlocks();for(const L of o)i+=L.getCount();const l=new Array(i);let u=0;for(const L of o)for(let V=0;V<L.getCount();V++){const Z=L.getDataCodewords(),te=r.getECCodewordsPerBlock()+Z;l[u++]=new oi(Z,new Uint8Array(te))}const g=l[0].codewords.length;let A=l.length-1;for(;A>=0&&l[A].codewords.length!==g;)A--;A++;const I=g-r.getECCodewordsPerBlock();let y=0;for(let L=0;L<I;L++)for(let V=0;V<u;V++)l[V].codewords[L]=e[y++];for(let L=A;L<u;L++)l[L].codewords[I]=e[y++];const N=l[0].codewords.length;for(let L=I;L<N;L++)for(let V=0;V<u;V++){const Z=V<A?L:L+1;l[V].codewords[Z]=e[y++]}return l}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var en;(function(b){b[b.TERMINATOR=0]="TERMINATOR",b[b.NUMERIC=1]="NUMERIC",b[b.ALPHANUMERIC=2]="ALPHANUMERIC",b[b.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",b[b.BYTE=4]="BYTE",b[b.ECI=5]="ECI",b[b.KANJI=6]="KANJI",b[b.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",b[b.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",b[b.HANZI=9]="HANZI"})(en||(en={}));class Be{constructor(e,t,n,r){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=n,this.bits=r,Be.FOR_BITS.set(r,this),Be.FOR_VALUE.set(e,this)}static forBits(e){const t=Be.FOR_BITS.get(e);if(t===void 0)throw new _;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let n;return t<=9?n=0:t<=26?n=1:n=2,this.characterCountBitsForVersions[n]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof Be))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}Be.FOR_BITS=new Map,Be.FOR_VALUE=new Map,Be.TERMINATOR=new Be(en.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Be.NUMERIC=new Be(en.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Be.ALPHANUMERIC=new Be(en.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Be.STRUCTURED_APPEND=new Be(en.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Be.BYTE=new Be(en.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Be.ECI=new Be(en.ECI,"ECI",Int32Array.from([0,0,0]),7),Be.KANJI=new Be(en.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Be.FNC1_FIRST_POSITION=new Be(en.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Be.FNC1_SECOND_POSITION=new Be(en.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Be.HANZI=new Be(en.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class dt{static decode(e,t,n,r){const i=new si(e);let o=new ne;const l=new Array;let u=-1,g=-1;try{let A=null,I=!1,y;do{if(i.available()<4)y=Be.TERMINATOR;else{const N=i.readBits(4);y=Be.forBits(N)}switch(y){case Be.TERMINATOR:break;case Be.FNC1_FIRST_POSITION:case Be.FNC1_SECOND_POSITION:I=!0;break;case Be.STRUCTURED_APPEND:if(i.available()<16)throw new U;u=i.readBits(8),g=i.readBits(8);break;case Be.ECI:const N=dt.parseECIValue(i);if(A=k.getCharacterSetECIByValue(N),A===null)throw new U;break;case Be.HANZI:const L=i.readBits(4),V=i.readBits(y.getCharacterCountBits(t));L===dt.GB2312_SUBSET&&dt.decodeHanziSegment(i,o,V);break;default:const Z=i.readBits(y.getCharacterCountBits(t));switch(y){case Be.NUMERIC:dt.decodeNumericSegment(i,o,Z);break;case Be.ALPHANUMERIC:dt.decodeAlphanumericSegment(i,o,Z,I);break;case Be.BYTE:dt.decodeByteSegment(i,o,Z,A,l,r);break;case Be.KANJI:dt.decodeKanjiSegment(i,o,Z);break;default:throw new U}break}}while(y!==Be.TERMINATOR)}catch{throw new U}return new ht(e,o.toString(),l.length===0?null:l,n===null?null:n.toString(),u,g)}static decodeHanziSegment(e,t,n){if(n*13>e.available())throw new U;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const o=e.readBits(13);let l=o/96<<8&4294967295|o%96;l<959?l+=41377:l+=42657,r[i]=l>>8&255,r[i+1]=l&255,i+=2,n--}try{t.append(pe.decode(r,ae.GB2312))}catch(o){throw new U(o)}}static decodeKanjiSegment(e,t,n){if(n*13>e.available())throw new U;const r=new Uint8Array(2*n);let i=0;for(;n>0;){const o=e.readBits(13);let l=o/192<<8&4294967295|o%192;l<7936?l+=33088:l+=49472,r[i]=l>>8,r[i+1]=l,i+=2,n--}try{t.append(pe.decode(r,ae.SHIFT_JIS))}catch(o){throw new U(o)}}static decodeByteSegment(e,t,n,r,i,o){if(8*n>e.available())throw new U;const l=new Uint8Array(n);for(let g=0;g<n;g++)l[g]=e.readBits(8);let u;r===null?u=ae.guessEncoding(l,o):u=r.getName();try{t.append(pe.decode(l,u))}catch(g){throw new U(g)}i.push(l)}static toAlphaNumericChar(e){if(e>=dt.ALPHANUMERIC_CHARS.length)throw new U;return dt.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,n,r){const i=t.length();for(;n>1;){if(e.available()<11)throw new U;const o=e.readBits(11);t.append(dt.toAlphaNumericChar(Math.floor(o/45))),t.append(dt.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(e.available()<6)throw new U;t.append(dt.toAlphaNumericChar(e.readBits(6)))}if(r)for(let o=i;o<t.length();o++)t.charAt(o)==="%"&&(o<t.length()-1&&t.charAt(o+1)==="%"?t.deleteCharAt(o+1):t.setCharAt(o,String.fromCharCode(29)))}static decodeNumericSegment(e,t,n){for(;n>=3;){if(e.available()<10)throw new U;const r=e.readBits(10);if(r>=1e3)throw new U;t.append(dt.toAlphaNumericChar(Math.floor(r/100))),t.append(dt.toAlphaNumericChar(Math.floor(r/10)%10)),t.append(dt.toAlphaNumericChar(r%10)),n-=3}if(n===2){if(e.available()<7)throw new U;const r=e.readBits(7);if(r>=100)throw new U;t.append(dt.toAlphaNumericChar(Math.floor(r/10))),t.append(dt.toAlphaNumericChar(r%10))}else if(n===1){if(e.available()<4)throw new U;const r=e.readBits(4);if(r>=10)throw new U;t.append(dt.toAlphaNumericChar(r))}}static parseECIValue(e){const t=e.readBits(8);if((t&128)===0)return t&127;if((t&192)===128){const n=e.readBits(8);return(t&63)<<8&4294967295|n}if((t&224)===192){const n=e.readBits(16);return(t&31)<<16&4294967295|n}throw new U}}dt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",dt.GB2312_SUBSET=1;class Yi{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||e===null||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class Eo{constructor(){this.rsDecoder=new Sn(Ee.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(Ae.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const n=new mo(e);let r=null;try{return this.decodeBitMatrixParser(n,t)}catch(i){r=i}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();const i=this.decodeBitMatrixParser(n,t);return i.setOther(new Yi(!0)),i}catch(i){throw r!==null?r:i}}decodeBitMatrixParser(e,t){const n=e.readVersion(),r=e.readFormatInformation().getErrorCorrectionLevel(),i=e.readCodewords(),o=oi.getDataBlocks(i,n,r);let l=0;for(const A of o)l+=A.getNumDataCodewords();const u=new Uint8Array(l);let g=0;for(const A of o){const I=A.getCodewords(),y=A.getNumDataCodewords();this.correctErrors(I,y);for(let N=0;N<y;N++)u[g++]=I[N]}return dt.decode(u,n,r,t)}correctErrors(e,t){const n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new v}for(let r=0;r<t;r++)e[r]=n[r]}}class li extends Se{constructor(e,t,n){super(e,t),this.estimatedModuleSize=n}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=(this.getX()+t)/2,i=(this.getY()+e)/2,o=(this.estimatedModuleSize+n)/2;return new li(r,i,o)}}class Br{constructor(e,t,n,r,i,o,l){this.image=e,this.startX=t,this.startY=n,this.width=r,this.height=i,this.moduleSize=o,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,n=this.width,r=e+n,i=this.startY+t/2,o=new Int32Array(3),l=this.image;for(let u=0;u<t;u++){const g=i+((u&1)===0?Math.floor((u+1)/2):-Math.floor((u+1)/2));o[0]=0,o[1]=0,o[2]=0;let A=e;for(;A<r&&!l.get(A,g);)A++;let I=0;for(;A<r;){if(l.get(A,g))if(I===1)o[1]++;else if(I===2){if(this.foundPatternCross(o)){const y=this.handlePossibleCenter(o,g,A);if(y!==null)return y}o[0]=o[2],o[1]=1,o[2]=0,I=1}else o[++I]++;else I===1&&I++,o[I]++;A++}if(this.foundPatternCross(o)){const y=this.handlePossibleCenter(o,g,r);if(y!==null)return y}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new q}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,n=t/2;for(let r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0}crossCheckVertical(e,t,n,r){const i=this.image,o=i.getHeight(),l=this.crossCheckStateCount;l[0]=0,l[1]=0,l[2]=0;let u=e;for(;u>=0&&i.get(t,u)&&l[1]<=n;)l[1]++,u--;if(u<0||l[1]>n)return NaN;for(;u>=0&&!i.get(t,u)&&l[0]<=n;)l[0]++,u--;if(l[0]>n)return NaN;for(u=e+1;u<o&&i.get(t,u)&&l[1]<=n;)l[1]++,u++;if(u===o||l[1]>n)return NaN;for(;u<o&&!i.get(t,u)&&l[2]<=n;)l[2]++,u++;if(l[2]>n)return NaN;const g=l[0]+l[1]+l[2];return 5*Math.abs(g-r)>=2*r?NaN:this.foundPatternCross(l)?Br.centerFromEnd(l,u):NaN}handlePossibleCenter(e,t,n){const r=e[0]+e[1]+e[2],i=Br.centerFromEnd(e,n),o=this.crossCheckVertical(t,i,2*e[1],r);if(!isNaN(o)){const l=(e[0]+e[1]+e[2])/3;for(const g of this.possibleCenters)if(g.aboutEquals(l,o,i))return g.combineEstimate(o,i,l);const u=new li(i,o,l);this.possibleCenters.push(u),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(u)}return null}}class ai extends Se{constructor(e,t,n,r){super(e,t),this.estimatedModuleSize=n,this.count=r,r===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,n){if(Math.abs(t-this.getY())<=e&&Math.abs(n-this.getX())<=e){const r=Math.abs(e-this.estimatedModuleSize);return r<=1||r<=this.estimatedModuleSize}return!1}combineEstimate(e,t,n){const r=this.count+1,i=(this.count*this.getX()+t)/r,o=(this.count*this.getY()+e)/r,l=(this.count*this.estimatedModuleSize+n)/r;return new ai(i,o,l,r)}}class Ao{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Bt{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=e!=null&&e.get($.TRY_HARDER)!==void 0,n=e!=null&&e.get($.PURE_BARCODE)!==void 0,r=this.image,i=r.getHeight(),o=r.getWidth();let l=Math.floor(3*i/(4*Bt.MAX_MODULES));(l<Bt.MIN_SKIP||t)&&(l=Bt.MIN_SKIP);let u=!1;const g=new Int32Array(5);for(let I=l-1;I<i&&!u;I+=l){g[0]=0,g[1]=0,g[2]=0,g[3]=0,g[4]=0;let y=0;for(let N=0;N<o;N++)if(r.get(N,I))(y&1)===1&&y++,g[y]++;else if((y&1)===0)if(y===4)if(Bt.foundPatternCross(g)){if(this.handlePossibleCenter(g,I,N,n)===!0)if(l=2,this.hasSkipped===!0)u=this.haveMultiplyConfirmedCenters();else{const V=this.findRowSkip();V>g[2]&&(I+=V-g[2]-l,N=o-1)}else{g[0]=g[2],g[1]=g[3],g[2]=g[4],g[3]=1,g[4]=0,y=3;continue}y=0,g[0]=0,g[1]=0,g[2]=0,g[3]=0,g[4]=0}else g[0]=g[2],g[1]=g[3],g[2]=g[4],g[3]=1,g[4]=0,y=3;else g[++y]++;else g[y]++;Bt.foundPatternCross(g)&&this.handlePossibleCenter(g,I,o,n)===!0&&(l=g[0],this.hasSkipped&&(u=this.haveMultiplyConfirmedCenters()))}const A=this.selectBestPatterns();return Se.orderBestPatterns(A),new Ao(A)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let i=0;i<5;i++){const o=e[i];if(o===0)return!1;t+=o}if(t<7)return!1;const n=t/7,r=n/2;return Math.abs(n-e[0])<r&&Math.abs(n-e[1])<r&&Math.abs(3*n-e[2])<3*r&&Math.abs(n-e[3])<r&&Math.abs(n-e[4])<r}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,n,r){const i=this.getCrossCheckStateCount();let o=0;const l=this.image;for(;e>=o&&t>=o&&l.get(t-o,e-o);)i[2]++,o++;if(e<o||t<o)return!1;for(;e>=o&&t>=o&&!l.get(t-o,e-o)&&i[1]<=n;)i[1]++,o++;if(e<o||t<o||i[1]>n)return!1;for(;e>=o&&t>=o&&l.get(t-o,e-o)&&i[0]<=n;)i[0]++,o++;if(i[0]>n)return!1;const u=l.getHeight(),g=l.getWidth();for(o=1;e+o<u&&t+o<g&&l.get(t+o,e+o);)i[2]++,o++;if(e+o>=u||t+o>=g)return!1;for(;e+o<u&&t+o<g&&!l.get(t+o,e+o)&&i[3]<n;)i[3]++,o++;if(e+o>=u||t+o>=g||i[3]>=n)return!1;for(;e+o<u&&t+o<g&&l.get(t+o,e+o)&&i[4]<n;)i[4]++,o++;if(i[4]>=n)return!1;const A=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(A-r)<2*r&&Bt.foundPatternCross(i)}crossCheckVertical(e,t,n,r){const i=this.image,o=i.getHeight(),l=this.getCrossCheckStateCount();let u=e;for(;u>=0&&i.get(t,u);)l[2]++,u--;if(u<0)return NaN;for(;u>=0&&!i.get(t,u)&&l[1]<=n;)l[1]++,u--;if(u<0||l[1]>n)return NaN;for(;u>=0&&i.get(t,u)&&l[0]<=n;)l[0]++,u--;if(l[0]>n)return NaN;for(u=e+1;u<o&&i.get(t,u);)l[2]++,u++;if(u===o)return NaN;for(;u<o&&!i.get(t,u)&&l[3]<n;)l[3]++,u++;if(u===o||l[3]>=n)return NaN;for(;u<o&&i.get(t,u)&&l[4]<n;)l[4]++,u++;if(l[4]>=n)return NaN;const g=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(g-r)>=2*r?NaN:Bt.foundPatternCross(l)?Bt.centerFromEnd(l,u):NaN}crossCheckHorizontal(e,t,n,r){const i=this.image,o=i.getWidth(),l=this.getCrossCheckStateCount();let u=e;for(;u>=0&&i.get(u,t);)l[2]++,u--;if(u<0)return NaN;for(;u>=0&&!i.get(u,t)&&l[1]<=n;)l[1]++,u--;if(u<0||l[1]>n)return NaN;for(;u>=0&&i.get(u,t)&&l[0]<=n;)l[0]++,u--;if(l[0]>n)return NaN;for(u=e+1;u<o&&i.get(u,t);)l[2]++,u++;if(u===o)return NaN;for(;u<o&&!i.get(u,t)&&l[3]<n;)l[3]++,u++;if(u===o||l[3]>=n)return NaN;for(;u<o&&i.get(u,t)&&l[4]<n;)l[4]++,u++;if(l[4]>=n)return NaN;const g=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(g-r)>=r?NaN:Bt.foundPatternCross(l)?Bt.centerFromEnd(l,u):NaN}handlePossibleCenter(e,t,n,r){const i=e[0]+e[1]+e[2]+e[3]+e[4];let o=Bt.centerFromEnd(e,n),l=this.crossCheckVertical(t,Math.floor(o),e[2],i);if(!isNaN(l)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(l),e[2],i),!isNaN(o)&&(!r||this.crossCheckDiagonal(Math.floor(l),Math.floor(o),e[2],i)))){const u=i/7;let g=!1;const A=this.possibleCenters;for(let I=0,y=A.length;I<y;I++){const N=A[I];if(N.aboutEquals(u,l,o)){A[I]=N.combineEstimate(l,o,u),g=!0;break}}if(!g){const I=new ai(o,l,u);A.push(I),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(I)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let t=null;for(const n of this.possibleCenters)if(n.getCount()>=Bt.CENTER_QUORUM)if(t==null)t=n;else return this.hasSkipped=!0,Math.floor((Math.abs(t.getX()-n.getX())-Math.abs(t.getY()-n.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const n=this.possibleCenters.length;for(const o of this.possibleCenters)o.getCount()>=Bt.CENTER_QUORUM&&(e++,t+=o.getEstimatedModuleSize());if(e<3)return!1;const r=t/n;let i=0;for(const o of this.possibleCenters)i+=Math.abs(o.getEstimatedModuleSize()-r);return i<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new q;const t=this.possibleCenters;let n;if(e>3){let r=0,i=0;for(const u of this.possibleCenters){const g=u.getEstimatedModuleSize();r+=g,i+=g*g}n=r/e;let o=Math.sqrt(i/e-n*n);t.sort((u,g)=>{const A=Math.abs(g.getEstimatedModuleSize()-n),I=Math.abs(u.getEstimatedModuleSize()-n);return A<I?-1:A>I?1:0});const l=Math.max(.2*n,o);for(let u=0;u<t.length&&t.length>3;u++){const g=t[u];Math.abs(g.getEstimatedModuleSize()-n)>l&&(t.splice(u,1),u--)}}if(t.length>3){let r=0;for(const i of t)r+=i.getEstimatedModuleSize();n=r/t.length,t.sort((i,o)=>{if(o.getCount()===i.getCount()){const l=Math.abs(o.getEstimatedModuleSize()-n),u=Math.abs(i.getEstimatedModuleSize()-n);return l<u?1:l>u?-1:0}else return o.getCount()-i.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}Bt.CENTER_QUORUM=2,Bt.MIN_SKIP=3,Bt.MAX_MODULES=57;class rr{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=e==null?null:e.get($.NEED_RESULT_POINT_CALLBACK);const n=new Bt(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(n)}processFinderPatternInfo(e){const t=e.getTopLeft(),n=e.getTopRight(),r=e.getBottomLeft(),i=this.calculateModuleSize(t,n,r);if(i<1)throw new q("No pattern found in proccess finder.");const o=rr.computeDimension(t,n,r,i),l=Oe.getProvisionalVersionForDimension(o),u=l.getDimensionForVersion()-7;let g=null;if(l.getAlignmentPatternCenters().length>0){const N=n.getX()-t.getX()+r.getX(),L=n.getY()-t.getY()+r.getY(),V=1-3/u,Z=Math.floor(t.getX()+V*(N-t.getX())),te=Math.floor(t.getY()+V*(L-t.getY()));for(let de=4;de<=16;de<<=1)try{g=this.findAlignmentInRegion(i,Z,te,de);break}catch(ge){if(!(ge instanceof q))throw ge}}const A=rr.createTransform(t,n,r,g,o),I=rr.sampleGrid(this.image,A,o);let y;return g===null?y=[r,t,n]:y=[r,t,n,g],new wn(I,y)}static createTransform(e,t,n,r,i){const o=i-3.5;let l,u,g,A;return r!==null?(l=r.getX(),u=r.getY(),g=o-3,A=g):(l=t.getX()-e.getX()+n.getX(),u=t.getY()-e.getY()+n.getY(),g=o,A=o),At.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,g,A,3.5,o,e.getX(),e.getY(),t.getX(),t.getY(),l,u,n.getX(),n.getY())}static sampleGrid(e,t,n){return S.getInstance().sampleGridWithTransform(e,n,n,t)}static computeDimension(e,t,n,r){const i=Xe.round(Se.distance(e,t)/r),o=Xe.round(Se.distance(e,n)/r);let l=Math.floor((i+o)/2)+7;switch(l&3){case 0:l++;break;case 2:l--;break;case 3:throw new q("Dimensions could be not found.")}return l}calculateModuleSize(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2}calculateModuleSizeOneWay(e,t){const n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,n,r){let i=this.sizeOfBlackWhiteBlackRun(e,t,n,r),o=1,l=e-(n-e);l<0?(o=e/(e-l),l=0):l>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(l-e),l=this.image.getWidth()-1);let u=Math.floor(t-(r-t)*o);return o=1,u<0?(o=t/(t-u),u=0):u>=this.image.getHeight()&&(o=(this.image.getHeight()-1-t)/(u-t),u=this.image.getHeight()-1),l=Math.floor(e+(l-e)*o),i+=this.sizeOfBlackWhiteBlackRun(e,t,l,u),i-1}sizeOfBlackWhiteBlackRun(e,t,n,r){const i=Math.abs(r-t)>Math.abs(n-e);if(i){let N=e;e=t,t=N,N=n,n=r,r=N}const o=Math.abs(n-e),l=Math.abs(r-t);let u=-o/2;const g=e<n?1:-1,A=t<r?1:-1;let I=0;const y=n+g;for(let N=e,L=t;N!==y;N+=g){const V=i?L:N,Z=i?N:L;if(I===1===this.image.get(V,Z)){if(I===2)return Xe.distance(N,L,e,t);I++}if(u+=l,u>0){if(L===r)break;L+=A,u-=o}}return I===2?Xe.distance(n+g,r,e,t):NaN}findAlignmentInRegion(e,t,n,r){const i=Math.floor(r*e),o=Math.max(0,t-i),l=Math.min(this.image.getWidth()-1,t+i);if(l-o<e*3)throw new q("Alignment top exceeds estimated module size.");const u=Math.max(0,n-i),g=Math.min(this.image.getHeight()-1,n+i);if(g-u<e*3)throw new q("Alignment bottom exceeds estimated module size.");return new Br(this.image,o,u,l-o,g-u,e,this.resultPointCallback).find()}}class Cn{constructor(){this.decoder=new Eo}getDecoder(){return this.decoder}decode(e,t){let n,r;if(t!=null&&t.get($.PURE_BARCODE)!==void 0){const u=Cn.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(u,t),r=Cn.NO_POINTS}else{const u=new rr(e.getBlackMatrix()).detect(t);n=this.decoder.decodeBitMatrix(u.getBits(),t),r=u.getPoints()}n.getOther()instanceof Yi&&n.getOther().applyMirroredCorrection(r);const i=new we(n.getText(),n.getRawBytes(),void 0,r,Ce.QR_CODE,void 0),o=n.getByteSegments();o!==null&&i.putMetadata(lt.BYTE_SEGMENTS,o);const l=n.getECLevel();return l!==null&&i.putMetadata(lt.ERROR_CORRECTION_LEVEL,l),n.hasStructuredAppend()&&(i.putMetadata(lt.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),i.putMetadata(lt.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),i}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t===null||n===null)throw new q;const r=this.moduleSize(t,e);let i=t[1],o=n[1],l=t[0],u=n[0];if(l>=u||i>=o)throw new q;if(o-i!==u-l&&(u=l+(o-i),u>=e.getWidth()))throw new q;const g=Math.round((u-l+1)/r),A=Math.round((o-i+1)/r);if(g<=0||A<=0)throw new q;if(A!==g)throw new q;const I=Math.floor(r/2);i+=I,l+=I;const y=l+Math.floor((g-1)*r)-u;if(y>0){if(y>I)throw new q;l-=y}const N=i+Math.floor((A-1)*r)-o;if(N>0){if(N>I)throw new q;i-=N}const L=new Ae(g,A);for(let V=0;V<A;V++){const Z=i+Math.floor(V*r);for(let te=0;te<g;te++)e.get(l+Math.floor(te*r),Z)&&L.set(te,V)}return L}static moduleSize(e,t){const n=t.getHeight(),r=t.getWidth();let i=e[0],o=e[1],l=!0,u=0;for(;i<r&&o<n;){if(l!==t.get(i,o)){if(++u===5)break;l=!l}i++,o++}if(i===r||o===n)throw new q;return(i-e[0])/7}}Cn.NO_POINTS=new Array;class ke{PDF417Common(){}static getBitCountSum(e){return Xe.sum(e)}static toIntArray(e){if(e==null||!e.length)return ke.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let n=0;for(const r of e)t[n++]=r;return t}static getCodeword(e){const t=z.binarySearch(ke.SYMBOL_TABLE,e&262143);return t<0?-1:(ke.CODEWORD_TABLE[t]-1)%ke.NUMBER_OF_CODEWORDS}}ke.NUMBER_OF_CODEWORDS=929,ke.MAX_CODEWORDS_IN_BARCODE=ke.NUMBER_OF_CODEWORDS-1,ke.MIN_ROWS_IN_BARCODE=3,ke.MAX_ROWS_IN_BARCODE=90,ke.MODULES_IN_CODEWORD=17,ke.MODULES_IN_STOP_PATTERN=18,ke.BARS_IN_MODULE=8,ke.EMPTY_INT_ARRAY=new Int32Array([]),ke.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),ke.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Co{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class Fe{static detectMultiple(e,t,n){let r=e.getBlackMatrix(),i=Fe.detect(n,r);return i.length||(r=r.clone(),r.rotate180(),i=Fe.detect(n,r)),new Co(r,i)}static detect(e,t){const n=new Array;let r=0,i=0,o=!1;for(;r<t.getHeight();){const l=Fe.findVertices(t,r,i);if(l[0]==null&&l[3]==null){if(!o)break;o=!1,i=0;for(const u of n)u[1]!=null&&(r=Math.trunc(Math.max(r,u[1].getY()))),u[3]!=null&&(r=Math.max(r,Math.trunc(u[3].getY())));r+=Fe.ROW_STEP;continue}if(o=!0,n.push(l),!e)break;l[2]!=null?(i=Math.trunc(l[2].getX()),r=Math.trunc(l[2].getY())):(i=Math.trunc(l[4].getX()),r=Math.trunc(l[4].getY()))}return n}static findVertices(e,t,n){const r=e.getHeight(),i=e.getWidth(),o=new Array(8);return Fe.copyToResult(o,Fe.findRowsWithPattern(e,r,i,t,n,Fe.START_PATTERN),Fe.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),t=Math.trunc(o[4].getY())),Fe.copyToResult(o,Fe.findRowsWithPattern(e,r,i,t,n,Fe.STOP_PATTERN),Fe.INDEXES_STOP_PATTERN),o}static copyToResult(e,t,n){for(let r=0;r<n.length;r++)e[n[r]]=t[r]}static findRowsWithPattern(e,t,n,r,i,o){const l=new Array(4);let u=!1;const g=new Int32Array(o.length);for(;r<t;r+=Fe.ROW_STEP){let I=Fe.findGuardPattern(e,i,r,n,!1,o,g);if(I!=null){for(;r>0;){const y=Fe.findGuardPattern(e,i,--r,n,!1,o,g);if(y!=null)I=y;else{r++;break}}l[0]=new Se(I[0],r),l[1]=new Se(I[1],r),u=!0;break}}let A=r+1;if(u){let I=0,y=Int32Array.from([Math.trunc(l[0].getX()),Math.trunc(l[1].getX())]);for(;A<t;A++){const N=Fe.findGuardPattern(e,y[0],A,n,!1,o,g);if(N!=null&&Math.abs(y[0]-N[0])<Fe.MAX_PATTERN_DRIFT&&Math.abs(y[1]-N[1])<Fe.MAX_PATTERN_DRIFT)y=N,I=0;else{if(I>Fe.SKIPPED_ROW_COUNT_MAX)break;I++}}A-=I+1,l[2]=new Se(y[0],A),l[3]=new Se(y[1],A)}return A-r<Fe.BARCODE_MIN_HEIGHT&&z.fill(l,null),l}static findGuardPattern(e,t,n,r,i,o,l){z.fillWithin(l,0,l.length,0);let u=t,g=0;for(;e.get(u,n)&&u>0&&g++<Fe.MAX_PIXEL_DRIFT;)u--;let A=u,I=0,y=o.length;for(let N=i;A<r;A++)if(e.get(A,n)!==N)l[I]++;else{if(I===y-1){if(Fe.patternMatchVariance(l,o,Fe.MAX_INDIVIDUAL_VARIANCE)<Fe.MAX_AVG_VARIANCE)return new Int32Array([u,A]);u+=l[0]+l[1],M.arraycopy(l,2,l,0,I-1),l[I-1]=0,l[I]=0,I--}else I++;l[I]=1,N=!N}return I===y-1&&Fe.patternMatchVariance(l,o,Fe.MAX_INDIVIDUAL_VARIANCE)<Fe.MAX_AVG_VARIANCE?new Int32Array([u,A-1]):null}static patternMatchVariance(e,t,n){let r=e.length,i=0,o=0;for(let g=0;g<r;g++)i+=e[g],o+=t[g];if(i<o)return 1/0;let l=i/o;n*=l;let u=0;for(let g=0;g<r;g++){let A=e[g],I=t[g]*l,y=A>I?A-I:I-A;if(y>n)return 1/0;u+=y}return u/i}}Fe.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Fe.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Fe.MAX_AVG_VARIANCE=.42,Fe.MAX_INDIVIDUAL_VARIANCE=.8,Fe.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Fe.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Fe.MAX_PIXEL_DRIFT=3,Fe.MAX_PATTERN_DRIFT=5,Fe.SKIPPED_ROW_COUNT_MAX=25,Fe.ROW_STEP=5,Fe.BARCODE_MIN_HEIGHT=10;class Dt{constructor(e,t){if(t.length===0)throw new _;this.field=e;let n=t.length;if(n>1&&t[0]===0){let r=1;for(;r<n&&t[r]===0;)r++;r===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-r),M.arraycopy(t,r,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);if(e===1){let r=0;for(let i of this.coefficients)r=this.field.add(r,i);return r}let t=this.coefficients[0],n=this.coefficients.length;for(let r=1;r<n;r++)t=this.field.add(this.field.multiply(e,t),this.coefficients[r]);return t}add(e){if(!this.field.equals(e.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,n=e.coefficients;if(t.length>n.length){let o=t;t=n,n=o}let r=new Int32Array(n.length),i=n.length-t.length;M.arraycopy(n,0,r,0,i);for(let o=i;o<n.length;o++)r[o]=this.field.add(t[o-i],n[o]);return new Dt(this.field,r)}subtract(e){if(!this.field.equals(e.field))throw new _("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof Dt?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new Dt(this.field,new Int32Array([0]));let t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,o=new Int32Array(n+i-1);for(let l=0;l<n;l++){let u=t[l];for(let g=0;g<i;g++)o[l+g]=this.field.add(o[l+g],this.field.multiply(u,r[g]))}return new Dt(this.field,o)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=this.field.subtract(0,this.coefficients[n]);return new Dt(this.field,t)}multiplyScalar(e){if(e===0)return new Dt(this.field,new Int32Array([0]));if(e===1)return this;let t=this.coefficients.length,n=new Int32Array(t);for(let r=0;r<t;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new Dt(this.field,n)}multiplyByMonomial(e,t){if(e<0)throw new _;if(t===0)return new Dt(this.field,new Int32Array([0]));let n=this.coefficients.length,r=new Int32Array(n+e);for(let i=0;i<n;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new Dt(this.field,r)}toString(){let e=new ne;for(let t=this.getDegree();t>=0;t--){let n=this.getCoefficient(t);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(t===0||n!==1)&&e.append(n),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class bo{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(e===0)throw new _;return this.logTable[e]}inverse(e){if(e===0)throw new Mt;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class ci extends bo{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let n=1;for(let r=0;r<e;r++)this.expTable[r]=n,n=n*t%e;for(let r=0;r<e-1;r++)this.logTable[this.expTable[r]]=r;this.zero=new Dt(this,new Int32Array([0])),this.one=new Dt(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new _;if(t===0)return this.zero;let n=new Int32Array(e+1);return n[0]=t,new Dt(this,n)}}ci.PDF417_GF=new ci(ke.NUMBER_OF_CODEWORDS,3);class zi{constructor(){this.field=ci.PDF417_GF}decode(e,t,n){let r=new Dt(this.field,e),i=new Int32Array(t),o=!1;for(let L=t;L>0;L--){let V=r.evaluateAt(this.field.exp(L));i[t-L]=V,V!==0&&(o=!0)}if(!o)return 0;let l=this.field.getOne();if(n!=null)for(const L of n){let V=this.field.exp(e.length-1-L),Z=new Dt(this.field,new Int32Array([this.field.subtract(0,V),1]));l=l.multiply(Z)}let u=new Dt(this.field,i),g=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),u,t),A=g[0],I=g[1],y=this.findErrorLocations(A),N=this.findErrorMagnitudes(I,A,y);for(let L=0;L<y.length;L++){let V=e.length-1-this.field.log(y[L]);if(V<0)throw v.getChecksumInstance();e[V]=this.field.subtract(e[V],N[L])}return y.length}runEuclideanAlgorithm(e,t,n){if(e.getDegree()<t.getDegree()){let y=e;e=t,t=y}let r=e,i=t,o=this.field.getZero(),l=this.field.getOne();for(;i.getDegree()>=Math.round(n/2);){let y=r,N=o;if(r=i,o=l,r.isZero())throw v.getChecksumInstance();i=y;let L=this.field.getZero(),V=r.getCoefficient(r.getDegree()),Z=this.field.inverse(V);for(;i.getDegree()>=r.getDegree()&&!i.isZero();){let te=i.getDegree()-r.getDegree(),de=this.field.multiply(i.getCoefficient(i.getDegree()),Z);L=L.add(this.field.buildMonomial(te,de)),i=i.subtract(r.multiplyByMonomial(te,de))}l=L.multiply(o).subtract(N).negative()}let u=l.getCoefficient(0);if(u===0)throw v.getChecksumInstance();let g=this.field.inverse(u),A=l.multiply(g),I=i.multiply(g);return[A,I]}findErrorLocations(e){let t=e.getDegree(),n=new Int32Array(t),r=0;for(let i=1;i<this.field.getSize()&&r<t;i++)e.evaluateAt(i)===0&&(n[r]=this.field.inverse(i),r++);if(r!==t)throw v.getChecksumInstance();return n}findErrorMagnitudes(e,t,n){let r=t.getDegree(),i=new Int32Array(r);for(let g=1;g<=r;g++)i[r-g]=this.field.multiply(g,t.getCoefficient(g));let o=new Dt(this.field,i),l=n.length,u=new Int32Array(l);for(let g=0;g<l;g++){let A=this.field.inverse(n[g]),I=this.field.subtract(0,e.evaluateAt(A)),y=this.field.inverse(o.evaluateAt(A));u[g]=this.field.multiply(I,y)}return u}}class On{constructor(e,t,n,r,i){e instanceof On?this.constructor_2(e):this.constructor_1(e,t,n,r,i)}constructor_1(e,t,n,r,i){const o=t==null||n==null,l=r==null||i==null;if(o&&l)throw new q;o?(t=new Se(0,r.getY()),n=new Se(0,i.getY())):l&&(r=new Se(e.getWidth()-1,t.getY()),i=new Se(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=r,this.bottomRight=i,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(r.getX(),i.getX())),this.minY=Math.trunc(Math.min(t.getY(),r.getY())),this.maxY=Math.trunc(Math.max(n.getY(),i.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return e==null?t:t==null?e:new On(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,n){let r=this.topLeft,i=this.bottomLeft,o=this.topRight,l=this.bottomRight;if(e>0){let u=n?this.topLeft:this.topRight,g=Math.trunc(u.getY()-e);g<0&&(g=0);let A=new Se(u.getX(),g);n?r=A:o=A}if(t>0){let u=n?this.bottomLeft:this.bottomRight,g=Math.trunc(u.getY()+t);g>=this.image.getHeight()&&(g=this.image.getHeight()-1);let A=new Se(u.getX(),g);n?i=A:l=A}return new On(this.image,r,i,o,l)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Io{constructor(e,t,n,r){this.columnCount=e,this.errorCorrectionLevel=r,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class ir{constructor(){this.buffer=""}static form(e,t){let n=-1;function r(o,l,u,g,A,I){if(o==="%%")return"%";if(t[++n]===void 0)return;o=g?parseInt(g.substr(1)):void 0;let y=A?parseInt(A.substr(1)):void 0,N;switch(I){case"s":N=t[n];break;case"c":N=t[n][0];break;case"f":N=parseFloat(t[n]).toFixed(o);break;case"p":N=parseFloat(t[n]).toPrecision(o);break;case"e":N=parseFloat(t[n]).toExponential(o);break;case"x":N=parseInt(t[n]).toString(y||16);break;case"d":N=parseFloat(parseInt(t[n],y||10).toPrecision(o)).toFixed(0);break}N=typeof N=="object"?JSON.stringify(N):(+N).toString(y);let L=parseInt(u),V=u&&u[0]+""=="0"?"0":" ";for(;N.length<L;)N=l!==void 0?N+V:V+N;return N}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,r)}format(e,...t){this.buffer+=ir.form(e,t)}toString(){return this.buffer}}class sr{constructor(e){this.boundingBox=new On(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(t!=null)return t;for(let n=1;n<sr.MAX_NEARBY_DISTANCE;n++){let r=this.imageRowToCodewordIndex(e)-n;if(r>=0&&(t=this.codewords[r],t!=null)||(r=this.imageRowToCodewordIndex(e)+n,r<this.codewords.length&&(t=this.codewords[r],t!=null)))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new ir;let t=0;for(const n of this.codewords){if(n==null){e.format("%3d:    |   %n",t++);continue}e.format("%3d: %3d|%3d%n",t++,n.getRowNumber(),n.getValue())}return e.toString()}}sr.MAX_NEARBY_DISTANCE=5;class or{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[n,r]of this.values.entries()){const i={getKey:()=>n,getValue:()=>r};i.getValue()>e?(e=i.getValue(),t=[],t.push(i.getKey())):i.getValue()===e&&t.push(i.getKey())}return ke.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class ji extends sr{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())e!=null&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let n=this.getBoundingBox(),r=this._isLeft?n.getTopLeft():n.getTopRight(),i=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(r.getY())),l=this.imageRowToCodewordIndex(Math.trunc(i.getY())),u=-1,g=1,A=0;for(let I=o;I<l;I++){if(t[I]==null)continue;let y=t[I],N=y.getRowNumber()-u;if(N===0)A++;else if(N===1)g=Math.max(g,A),A=1,u=y.getRowNumber();else if(N<0||y.getRowNumber()>=e.getRowCount()||N>I)t[I]=null;else{let L;g>2?L=(g-2)*N:L=N;let V=L>=I;for(let Z=1;Z<=L&&!V;Z++)V=t[I-Z]!=null;V?t[I]=null:(u=y.getRowNumber(),A=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(e==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let n of this.getCodewords())if(n!=null){let r=n.getRowNumber();if(r>=t.length)continue;t[r]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),n=this._isLeft?t.getTopLeft():t.getTopRight(),r=this._isLeft?t.getBottomLeft():t.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(n.getY())),o=this.imageRowToCodewordIndex(Math.trunc(r.getY())),l=this.getCodewords(),u=-1;for(let g=i;g<o;g++){if(l[g]==null)continue;let A=l[g];A.setRowNumberAsRowIndicatorColumn();let I=A.getRowNumber()-u;I===0||(I===1?u=A.getRowNumber():A.getRowNumber()>=e.getRowCount()?l[g]=null:u=A.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new or,n=new or,r=new or,i=new or;for(let l of e){if(l==null)continue;l.setRowNumberAsRowIndicatorColumn();let u=l.getValue()%30,g=l.getRowNumber();switch(this._isLeft||(g+=2),g%3){case 0:n.setValue(u*3+1);break;case 1:i.setValue(u/3),r.setValue(u%3);break;case 2:t.setValue(u+1);break}}if(t.getValue().length===0||n.getValue().length===0||r.getValue().length===0||i.getValue().length===0||t.getValue()[0]<1||n.getValue()[0]+r.getValue()[0]<ke.MIN_ROWS_IN_BARCODE||n.getValue()[0]+r.getValue()[0]>ke.MAX_ROWS_IN_BARCODE)return null;let o=new Io(t.getValue()[0],n.getValue()[0],r.getValue()[0],i.getValue()[0]);return this.removeIncorrectCodewords(e,o),o}removeIncorrectCodewords(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(e[n]==null)continue;let i=r.getValue()%30,o=r.getRowNumber();if(o>t.getRowCount()){e[n]=null;continue}switch(this._isLeft||(o+=2),o%3){case 0:i*3+1!==t.getRowCountUpperPart()&&(e[n]=null);break;case 1:(Math.trunc(i/3)!==t.getErrorCorrectionLevel()||i%3!==t.getRowCountLowerPart())&&(e[n]=null);break;case 2:i+1!==t.getColumnCount()&&(e[n]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class lr{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e=ke.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(e===0)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let n=this.detectionResultColumns[t].getCodewords();for(let r=0;r<n.length;r++)n[r]!=null&&(n[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,n))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<e.length;n++)if(e[n]!=null&&t[n]!=null&&e[n].getRowNumber()===t[n].getRowNumber())for(let r=1;r<=this.barcodeColumnCount;r++){let i=this.detectionResultColumns[r].getCodewords()[n];i!=null&&(i.setRowNumber(e[n].getRowNumber()),i.hasValidRowNumber()||(this.detectionResultColumns[r].getCodewords()[n]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let n=0;n<t.length;n++){if(t[n]==null)continue;let r=t[n].getRowNumber(),i=0;for(let o=this.barcodeColumnCount+1;o>0&&i<this.ADJUST_ROW_NUMBER_SKIP;o--){let l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(i=lr.adjustRowNumberIfValid(r,i,l),l.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let n=0;n<t.length;n++){if(t[n]==null)continue;let r=t[n].getRowNumber(),i=0;for(let o=1;o<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;o++){let l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(i=lr.adjustRowNumberIfValid(r,i,l),l.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,n){let r=n[t],i=this.detectionResultColumns[e-1].getCodewords(),o=i;this.detectionResultColumns[e+1]!=null&&(o=this.detectionResultColumns[e+1].getCodewords());let l=new Array(14);l[2]=i[t],l[3]=o[t],t>0&&(l[0]=n[t-1],l[4]=i[t-1],l[5]=o[t-1]),t>1&&(l[8]=n[t-2],l[10]=i[t-2],l[11]=o[t-2]),t<n.length-1&&(l[1]=n[t+1],l[6]=i[t+1],l[7]=o[t+1]),t<n.length-2&&(l[9]=n[t+2],l[12]=i[t+2],l[13]=o[t+2]);for(let u of l)if(lr.adjustRowNumber(r,u))return}static adjustRowNumber(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new ir;for(let n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(let r=0;r<this.barcodeColumnCount+2;r++){if(this.detectionResultColumns[r]==null){t.format("    |   ");continue}let i=this.detectionResultColumns[r].getCodewords()[n];if(i==null){t.format("    |   ");continue}t.format(" %3d|%3d",i.getRowNumber(),i.getValue())}t.format("%n")}return t.toString()}}class ar{constructor(e,t,n,r){this.rowNumber=ar.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(n),this.value=Math.trunc(r)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==ar.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}ar.BARCODE_ROW_UNKNOWN=-1;class Wt{static initialize(){for(let e=0;e<ke.SYMBOL_TABLE.length;e++){let t=ke.SYMBOL_TABLE[e],n=t&1;for(let r=0;r<ke.BARS_IN_MODULE;r++){let i=0;for(;(t&1)===n;)i+=1,t>>=1;n=t&1,Wt.RATIOS_TABLE[e]||(Wt.RATIOS_TABLE[e]=new Array(ke.BARS_IN_MODULE)),Wt.RATIOS_TABLE[e][ke.BARS_IN_MODULE-r-1]=Math.fround(i/ke.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=Wt.getDecodedCodewordValue(Wt.sampleBitCounts(e));return t!==-1?t:Wt.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=Xe.sum(e),n=new Int32Array(ke.BARS_IN_MODULE),r=0,i=0;for(let o=0;o<ke.MODULES_IN_CODEWORD;o++){let l=t/(2*ke.MODULES_IN_CODEWORD)+o*t/ke.MODULES_IN_CODEWORD;i+e[r]<=l&&(i+=e[r],r++),n[r]++}return n}static getDecodedCodewordValue(e){let t=Wt.getBitValue(e);return ke.getCodeword(t)===-1?-1:t}static getBitValue(e){let t=0;for(let n=0;n<e.length;n++)for(let r=0;r<e[n];r++)t=t<<1|(n%2===0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=Xe.sum(e),n=new Array(ke.BARS_IN_MODULE);if(t>1)for(let o=0;o<n.length;o++)n[o]=Math.fround(e[o]/t);let r=Ln.MAX_VALUE,i=-1;this.bSymbolTableReady||Wt.initialize();for(let o=0;o<Wt.RATIOS_TABLE.length;o++){let l=0,u=Wt.RATIOS_TABLE[o];for(let g=0;g<ke.BARS_IN_MODULE;g++){let A=Math.fround(u[g]-n[g]);if(l+=Math.fround(A*A),l>=r)break}l<r&&(r=l,i=ke.SYMBOL_TABLE[o])}return i}}Wt.bSymbolTableReady=!1,Wt.RATIOS_TABLE=new Array(ke.SYMBOL_TABLE.length).map(b=>new Array(ke.BARS_IN_MODULE));class Zi{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class Ki{static parseLong(e,t=void 0){return parseInt(e,t)}}class qi extends m{}qi.kind="NullPointerException";class _o{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,n){if(e==null)throw new qi;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new F;if(n===0)return;for(let r=0;r<n;r++)this.write(e[t+r])}flush(){}close(){}}class yo extends m{}class So extends _o{constructor(e=32){if(super(),this.count=0,e<0)throw new _("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let n=this.buf.length<<1;if(n-e<0&&(n=e),n<0){if(e<0)throw new yo;n=J.MAX_VALUE}this.buf=z.copyOfUint8Array(this.buf,n)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,n){if(t<0||t>e.length||n<0||t+n-e.length>0)throw new F;this.ensureCapacity(this.count+n),M.arraycopy(e,t,this.buf,this.count,n),this.count+=n}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return z.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?typeof e=="string"?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}var it;(function(b){b[b.ALPHA=0]="ALPHA",b[b.LOWER=1]="LOWER",b[b.MIXED=2]="MIXED",b[b.PUNCT=3]="PUNCT",b[b.ALPHA_SHIFT=4]="ALPHA_SHIFT",b[b.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(it||(it={}));function Qi(){if(typeof window<"u")return window.BigInt||null;if(typeof fr<"u")return fr.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Mr;function bn(b){if(typeof Mr>"u"&&(Mr=Qi()),Mr===null)throw new Error("BigInt is not supported!");return Mr(b)}function To(){let b=[];b[0]=bn(1);let e=bn(900);b[1]=e;for(let t=2;t<16;t++)b[t]=b[t-1]*e;return b}class ee{static decode(e,t){let n=new ne(""),r=k.ISO8859_1;n.enableDecoding(r);let i=1,o=e[i++],l=new Zi;for(;i<e[0];){switch(o){case ee.TEXT_COMPACTION_MODE_LATCH:i=ee.textCompaction(e,i,n);break;case ee.BYTE_COMPACTION_MODE_LATCH:case ee.BYTE_COMPACTION_MODE_LATCH_6:i=ee.byteCompaction(o,e,r,i,n);break;case ee.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[i++]);break;case ee.NUMERIC_COMPACTION_MODE_LATCH:i=ee.numericCompaction(e,i,n);break;case ee.ECI_CHARSET:k.getCharacterSetECIByValue(e[i++]);break;case ee.ECI_GENERAL_PURPOSE:i+=2;break;case ee.ECI_USER_DEFINED:i++;break;case ee.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=ee.decodeMacroBlock(e,i,l);break;case ee.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ee.MACRO_PDF417_TERMINATOR:throw new U;default:i--,i=ee.textCompaction(e,i,n);break}if(i<e.length)o=e[i++];else throw U.getFormatInstance()}if(n.length()===0)throw U.getFormatInstance();let u=new ht(null,n.toString(),null,t);return u.setOther(l),u}static decodeMacroBlock(e,t,n){if(t+ee.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw U.getFormatInstance();let r=new Int32Array(ee.NUMBER_OF_SEQUENCE_CODEWORDS);for(let l=0;l<ee.NUMBER_OF_SEQUENCE_CODEWORDS;l++,t++)r[l]=e[t];n.setSegmentIndex(J.parseInt(ee.decodeBase900toBase10(r,ee.NUMBER_OF_SEQUENCE_CODEWORDS)));let i=new ne;t=ee.textCompaction(e,t,i),n.setFileId(i.toString());let o=-1;for(e[t]===ee.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(o=t+1);t<e[0];)switch(e[t]){case ee.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case ee.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let l=new ne;t=ee.textCompaction(e,t+1,l),n.setFileName(l.toString());break;case ee.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let u=new ne;t=ee.textCompaction(e,t+1,u),n.setSender(u.toString());break;case ee.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let g=new ne;t=ee.textCompaction(e,t+1,g),n.setAddressee(g.toString());break;case ee.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let A=new ne;t=ee.numericCompaction(e,t+1,A),n.setSegmentCount(J.parseInt(A.toString()));break;case ee.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let I=new ne;t=ee.numericCompaction(e,t+1,I),n.setTimestamp(Ki.parseLong(I.toString()));break;case ee.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let y=new ne;t=ee.numericCompaction(e,t+1,y),n.setChecksum(J.parseInt(y.toString()));break;case ee.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let N=new ne;t=ee.numericCompaction(e,t+1,N),n.setFileSize(Ki.parseLong(N.toString()));break;default:throw U.getFormatInstance()}break;case ee.MACRO_PDF417_TERMINATOR:t++,n.setLastSegment(!0);break;default:throw U.getFormatInstance()}if(o!==-1){let l=t-o;n.isLastSegment()&&l--,n.setOptionalData(z.copyOfRange(e,o,o+l))}return t}static textCompaction(e,t,n){let r=new Int32Array((e[0]-t)*2),i=new Int32Array((e[0]-t)*2),o=0,l=!1;for(;t<e[0]&&!l;){let u=e[t++];if(u<ee.TEXT_COMPACTION_MODE_LATCH)r[o]=u/30,r[o+1]=u%30,o+=2;else switch(u){case ee.TEXT_COMPACTION_MODE_LATCH:r[o++]=ee.TEXT_COMPACTION_MODE_LATCH;break;case ee.BYTE_COMPACTION_MODE_LATCH:case ee.BYTE_COMPACTION_MODE_LATCH_6:case ee.NUMERIC_COMPACTION_MODE_LATCH:case ee.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ee.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ee.MACRO_PDF417_TERMINATOR:t--,l=!0;break;case ee.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r[o]=ee.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,u=e[t++],i[o]=u,o++;break}}return ee.decodeTextCompaction(r,i,o,n),t}static decodeTextCompaction(e,t,n,r){let i=it.ALPHA,o=it.ALPHA,l=0;for(;l<n;){let u=e[l],g="";switch(i){case it.ALPHA:if(u<26)g=String.fromCharCode(65+u);else switch(u){case 26:g=" ";break;case ee.LL:i=it.LOWER;break;case ee.ML:i=it.MIXED;break;case ee.PS:o=i,i=it.PUNCT_SHIFT;break;case ee.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[l]);break;case ee.TEXT_COMPACTION_MODE_LATCH:i=it.ALPHA;break}break;case it.LOWER:if(u<26)g=String.fromCharCode(97+u);else switch(u){case 26:g=" ";break;case ee.AS:o=i,i=it.ALPHA_SHIFT;break;case ee.ML:i=it.MIXED;break;case ee.PS:o=i,i=it.PUNCT_SHIFT;break;case ee.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[l]);break;case ee.TEXT_COMPACTION_MODE_LATCH:i=it.ALPHA;break}break;case it.MIXED:if(u<ee.PL)g=ee.MIXED_CHARS[u];else switch(u){case ee.PL:i=it.PUNCT;break;case 26:g=" ";break;case ee.LL:i=it.LOWER;break;case ee.AL:i=it.ALPHA;break;case ee.PS:o=i,i=it.PUNCT_SHIFT;break;case ee.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[l]);break;case ee.TEXT_COMPACTION_MODE_LATCH:i=it.ALPHA;break}break;case it.PUNCT:if(u<ee.PAL)g=ee.PUNCT_CHARS[u];else switch(u){case ee.PAL:i=it.ALPHA;break;case ee.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[l]);break;case ee.TEXT_COMPACTION_MODE_LATCH:i=it.ALPHA;break}break;case it.ALPHA_SHIFT:if(i=o,u<26)g=String.fromCharCode(65+u);else switch(u){case 26:g=" ";break;case ee.TEXT_COMPACTION_MODE_LATCH:i=it.ALPHA;break}break;case it.PUNCT_SHIFT:if(i=o,u<ee.PAL)g=ee.PUNCT_CHARS[u];else switch(u){case ee.PAL:i=it.ALPHA;break;case ee.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[l]);break;case ee.TEXT_COMPACTION_MODE_LATCH:i=it.ALPHA;break}break}g!==""&&r.append(g),l++}}static byteCompaction(e,t,n,r,i){let o=new So,l=0,u=0,g=!1;switch(e){case ee.BYTE_COMPACTION_MODE_LATCH:let A=new Int32Array(6),I=t[r++];for(;r<t[0]&&!g;)switch(A[l++]=I,u=900*u+I,I=t[r++],I){case ee.TEXT_COMPACTION_MODE_LATCH:case ee.BYTE_COMPACTION_MODE_LATCH:case ee.NUMERIC_COMPACTION_MODE_LATCH:case ee.BYTE_COMPACTION_MODE_LATCH_6:case ee.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ee.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ee.MACRO_PDF417_TERMINATOR:r--,g=!0;break;default:if(l%5===0&&l>0){for(let y=0;y<6;++y)o.write(Number(bn(u)>>bn(8*(5-y))));u=0,l=0}break}r===t[0]&&I<ee.TEXT_COMPACTION_MODE_LATCH&&(A[l++]=I);for(let y=0;y<l;y++)o.write(A[y]);break;case ee.BYTE_COMPACTION_MODE_LATCH_6:for(;r<t[0]&&!g;){let y=t[r++];if(y<ee.TEXT_COMPACTION_MODE_LATCH)l++,u=900*u+y;else switch(y){case ee.TEXT_COMPACTION_MODE_LATCH:case ee.BYTE_COMPACTION_MODE_LATCH:case ee.NUMERIC_COMPACTION_MODE_LATCH:case ee.BYTE_COMPACTION_MODE_LATCH_6:case ee.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ee.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ee.MACRO_PDF417_TERMINATOR:r--,g=!0;break}if(l%5===0&&l>0){for(let N=0;N<6;++N)o.write(Number(bn(u)>>bn(8*(5-N))));u=0,l=0}}break}return i.append(pe.decode(o.toByteArray(),n)),r}static numericCompaction(e,t,n){let r=0,i=!1,o=new Int32Array(ee.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!i;){let l=e[t++];if(t===e[0]&&(i=!0),l<ee.TEXT_COMPACTION_MODE_LATCH)o[r]=l,r++;else switch(l){case ee.TEXT_COMPACTION_MODE_LATCH:case ee.BYTE_COMPACTION_MODE_LATCH:case ee.BYTE_COMPACTION_MODE_LATCH_6:case ee.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ee.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ee.MACRO_PDF417_TERMINATOR:t--,i=!0;break}(r%ee.MAX_NUMERIC_CODEWORDS===0||l===ee.NUMERIC_COMPACTION_MODE_LATCH||i)&&r>0&&(n.append(ee.decodeBase900toBase10(o,r)),r=0)}return t}static decodeBase900toBase10(e,t){let n=bn(0);for(let i=0;i<t;i++)n+=ee.EXP900[t-i-1]*bn(e[i]);let r=n.toString();if(r.charAt(0)!=="1")throw new U;return r.substring(1)}}ee.TEXT_COMPACTION_MODE_LATCH=900,ee.BYTE_COMPACTION_MODE_LATCH=901,ee.NUMERIC_COMPACTION_MODE_LATCH=902,ee.BYTE_COMPACTION_MODE_LATCH_6=924,ee.ECI_USER_DEFINED=925,ee.ECI_GENERAL_PURPOSE=926,ee.ECI_CHARSET=927,ee.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,ee.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,ee.MACRO_PDF417_TERMINATOR=922,ee.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,ee.MAX_NUMERIC_CODEWORDS=15,ee.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,ee.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,ee.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,ee.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,ee.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,ee.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,ee.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,ee.PL=25,ee.LL=27,ee.AS=27,ee.ML=28,ee.AL=28,ee.PS=29,ee.PAL=29,ee.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,ee.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",ee.EXP900=Qi()?To():[],ee.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Ue{constructor(){}static decode(e,t,n,r,i,o,l){let u=new On(e,t,n,r,i),g=null,A=null,I;for(let L=!0;;L=!1){if(t!=null&&(g=Ue.getRowIndicatorColumn(e,u,t,!0,o,l)),r!=null&&(A=Ue.getRowIndicatorColumn(e,u,r,!1,o,l)),I=Ue.merge(g,A),I==null)throw q.getNotFoundInstance();let V=I.getBoundingBox();if(L&&V!=null&&(V.getMinY()<u.getMinY()||V.getMaxY()>u.getMaxY()))u=V;else break}I.setBoundingBox(u);let y=I.getBarcodeColumnCount()+1;I.setDetectionResultColumn(0,g),I.setDetectionResultColumn(y,A);let N=g!=null;for(let L=1;L<=y;L++){let V=N?L:y-L;if(I.getDetectionResultColumn(V)!==void 0)continue;let Z;V===0||V===y?Z=new ji(u,V===0):Z=new sr(u),I.setDetectionResultColumn(V,Z);let te=-1,de=te;for(let ge=u.getMinY();ge<=u.getMaxY();ge++){if(te=Ue.getStartColumn(I,V,ge,N),te<0||te>u.getMaxX()){if(de===-1)continue;te=de}let ue=Ue.detectCodeword(e,u.getMinX(),u.getMaxX(),N,te,ge,o,l);ue!=null&&(Z.setCodeword(ge,ue),de=te,o=Math.min(o,ue.getWidth()),l=Math.max(l,ue.getWidth()))}}return Ue.createDecoderResult(I)}static merge(e,t){if(e==null&&t==null)return null;let n=Ue.getBarcodeMetadata(e,t);if(n==null)return null;let r=On.merge(Ue.adjustBoundingBox(e),Ue.adjustBoundingBox(t));return new lr(n,r)}static adjustBoundingBox(e){if(e==null)return null;let t=e.getRowHeights();if(t==null)return null;let n=Ue.getMax(t),r=0;for(let l of t)if(r+=n-l,l>0)break;let i=e.getCodewords();for(let l=0;r>0&&i[l]==null;l++)r--;let o=0;for(let l=t.length-1;l>=0&&(o+=n-t[l],!(t[l]>0));l--);for(let l=i.length-1;o>0&&i[l]==null;l--)o--;return e.getBoundingBox().addMissingRows(r,o,e.isLeft())}static getMax(e){let t=-1;for(let n of e)t=Math.max(t,n);return t}static getBarcodeMetadata(e,t){let n;if(e==null||(n=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();let r;return t==null||(r=t.getBarcodeMetadata())==null?n:n.getColumnCount()!==r.getColumnCount()&&n.getErrorCorrectionLevel()!==r.getErrorCorrectionLevel()&&n.getRowCount()!==r.getRowCount()?null:n}static getRowIndicatorColumn(e,t,n,r,i,o){let l=new ji(t,r);for(let u=0;u<2;u++){let g=u===0?1:-1,A=Math.trunc(Math.trunc(n.getX()));for(let I=Math.trunc(Math.trunc(n.getY()));I<=t.getMaxY()&&I>=t.getMinY();I+=g){let y=Ue.detectCodeword(e,0,e.getWidth(),r,A,I,i,o);y!=null&&(l.setCodeword(I,y),r?A=y.getStartX():A=y.getEndX())}}return l}static adjustCodewordCount(e,t){let n=t[0][1],r=n.getValue(),i=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-Ue.getNumberOfECCodeWords(e.getBarcodeECLevel());if(r.length===0){if(i<1||i>ke.MAX_CODEWORDS_IN_BARCODE)throw q.getNotFoundInstance();n.setValue(i)}else r[0]!==i&&n.setValue(i)}static createDecoderResult(e){let t=Ue.createBarcodeMatrix(e);Ue.adjustCodewordCount(e,t);let n=new Array,r=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),i=[],o=new Array;for(let u=0;u<e.getBarcodeRowCount();u++)for(let g=0;g<e.getBarcodeColumnCount();g++){let A=t[u][g+1].getValue(),I=u*e.getBarcodeColumnCount()+g;A.length===0?n.push(I):A.length===1?r[I]=A[0]:(o.push(I),i.push(A))}let l=new Array(i.length);for(let u=0;u<l.length;u++)l[u]=i[u];return Ue.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),r,ke.toIntArray(n),ke.toIntArray(o),l)}static createDecoderResultFromAmbiguousValues(e,t,n,r,i){let o=new Int32Array(r.length),l=100;for(;l-- >0;){for(let u=0;u<o.length;u++)t[r[u]]=i[u][o[u]];try{return Ue.decodeCodewords(t,e,n)}catch(u){if(!(u instanceof v))throw u}if(o.length===0)throw v.getChecksumInstance();for(let u=0;u<o.length;u++)if(o[u]<i[u].length-1){o[u]++;break}else if(o[u]=0,u===o.length-1)throw v.getChecksumInstance()}throw v.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let r=0;r<t.length;r++)for(let i=0;i<t[r].length;i++)t[r][i]=new or;let n=0;for(let r of e.getDetectionResultColumns()){if(r!=null){for(let i of r.getCodewords())if(i!=null){let o=i.getRowNumber();if(o>=0){if(o>=t.length)continue;t[o][n].setValue(i.getValue())}}}n++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,n,r){let i=r?1:-1,o=null;if(Ue.isValidBarcodeColumn(e,t-i)&&(o=e.getDetectionResultColumn(t-i).getCodeword(n)),o!=null)return r?o.getEndX():o.getStartX();if(o=e.getDetectionResultColumn(t).getCodewordNearby(n),o!=null)return r?o.getStartX():o.getEndX();if(Ue.isValidBarcodeColumn(e,t-i)&&(o=e.getDetectionResultColumn(t-i).getCodewordNearby(n)),o!=null)return r?o.getEndX():o.getStartX();let l=0;for(;Ue.isValidBarcodeColumn(e,t-i);){t-=i;for(let u of e.getDetectionResultColumn(t).getCodewords())if(u!=null)return(r?u.getEndX():u.getStartX())+i*l*(u.getEndX()-u.getStartX());l++}return r?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,n,r,i,o,l,u){i=Ue.adjustCodewordStartColumn(e,t,n,r,i,o);let g=Ue.getModuleBitCount(e,t,n,r,i,o);if(g==null)return null;let A,I=Xe.sum(g);if(r)A=i+I;else{for(let L=0;L<g.length/2;L++){let V=g[L];g[L]=g[g.length-1-L],g[g.length-1-L]=V}A=i,i=A-I}if(!Ue.checkCodewordSkew(I,l,u))return null;let y=Wt.getDecodedValue(g),N=ke.getCodeword(y);return N===-1?null:new ar(i,A,Ue.getCodewordBucketNumber(y),N)}static getModuleBitCount(e,t,n,r,i,o){let l=i,u=new Int32Array(8),g=0,A=r?1:-1,I=r;for(;(r?l<n:l>=t)&&g<u.length;)e.get(l,o)===I?(u[g]++,l+=A):(g++,I=!I);return g===u.length||l===(r?n:t)&&g===u.length-1?u:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,n,r,i,o){let l=i,u=r?-1:1;for(let g=0;g<2;g++){for(;(r?l>=t:l<n)&&r===e.get(l,o);){if(Math.abs(i-l)>Ue.CODEWORD_SKEW_SIZE)return i;l+=u}u=-u,r=!r}return l}static checkCodewordSkew(e,t,n){return t-Ue.CODEWORD_SKEW_SIZE<=e&&e<=n+Ue.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,n){if(e.length===0)throw U.getFormatInstance();let r=1<<t+1,i=Ue.correctErrors(e,n,r);Ue.verifyCodewordCount(e,r);let o=ee.decode(e,""+t);return o.setErrorsCorrected(i),o.setErasures(n.length),o}static correctErrors(e,t,n){if(t!=null&&t.length>n/2+Ue.MAX_ERRORS||n<0||n>Ue.MAX_EC_CODEWORDS)throw v.getChecksumInstance();return Ue.errorCorrection.decode(e,n,t)}static verifyCodewordCount(e,t){if(e.length<4)throw U.getFormatInstance();let n=e[0];if(n>e.length)throw U.getFormatInstance();if(n===0)if(t<e.length)e[0]=e.length-t;else throw U.getFormatInstance()}static getBitCountForCodeword(e){let t=new Int32Array(8),n=0,r=t.length-1;for(;!((e&1)!==n&&(n=e&1,r--,r<0));)t[r]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return Ue.getCodewordBucketNumber(Ue.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new ir;for(let n=0;n<e.length;n++){t.format("Row %2d: ",n);for(let r=0;r<e[n].length;r++){let i=e[n][r];i.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}t.format("%n")}return t.toString()}}Ue.CODEWORD_SKEW_SIZE=2,Ue.MAX_ERRORS=3,Ue.MAX_EC_CODEWORDS=512,Ue.errorCorrection=new zi;class vt{decode(e,t=null){let n=vt.decode(e,t,!1);if(n==null||n.length===0||n[0]==null)throw q.getNotFoundInstance();return n[0]}decodeMultiple(e,t=null){try{return vt.decode(e,t,!0)}catch(n){throw n instanceof U||n instanceof v?q.getNotFoundInstance():n}}static decode(e,t,n){const r=new Array,i=Fe.detectMultiple(e,t,n);for(const o of i.getPoints()){const l=Ue.decode(i.getBits(),o[4],o[5],o[6],o[7],vt.getMinCodewordWidth(o),vt.getMaxCodewordWidth(o)),u=new we(l.getText(),l.getRawBytes(),void 0,o,Ce.PDF_417);u.putMetadata(lt.ERROR_CORRECTION_LEVEL,l.getECLevel());const g=l.getOther();g!=null&&u.putMetadata(lt.PDF417_EXTRA_METADATA,g),r.push(u)}return r.map(o=>o)}static getMaxWidth(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return e==null||t==null?J.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(vt.getMaxWidth(e[0],e[4]),vt.getMaxWidth(e[6],e[2])*ke.MODULES_IN_CODEWORD/ke.MODULES_IN_STOP_PATTERN),Math.max(vt.getMaxWidth(e[1],e[5]),vt.getMaxWidth(e[7],e[3])*ke.MODULES_IN_CODEWORD/ke.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(vt.getMinWidth(e[0],e[4]),vt.getMinWidth(e[6],e[2])*ke.MODULES_IN_CODEWORD/ke.MODULES_IN_STOP_PATTERN),Math.min(vt.getMinWidth(e[1],e[5]),vt.getMinWidth(e[7],e[3])*ke.MODULES_IN_CODEWORD/ke.MODULES_IN_STOP_PATTERN)))}reset(){}}class Dr extends m{}Dr.kind="ReaderException";class $i{constructor(e,t){this.verbose=e===!0,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const t=e!=null&&e.get($.TRY_HARDER)!==void 0,n=e==null?null:e.get($.POSSIBLE_FORMATS),r=new Array;if(n!=null){const i=n.some(o=>o===Ce.UPC_A||o===Ce.UPC_E||o===Ce.EAN_13||o===Ce.EAN_8||o===Ce.CODABAR||o===Ce.CODE_39||o===Ce.CODE_93||o===Ce.CODE_128||o===Ce.ITF||o===Ce.RSS_14||o===Ce.RSS_EXPANDED);i&&!t&&r.push(new Vn(e,this.verbose)),n.includes(Ce.QR_CODE)&&r.push(new Cn),n.includes(Ce.DATA_MATRIX)&&r.push(new An),n.includes(Ce.AZTEC)&&r.push(new O),n.includes(Ce.PDF_417)&&r.push(new vt),i&&t&&r.push(new Vn(e,this.verbose))}r.length===0&&(t||r.push(new Vn(e,this.verbose)),r.push(new Cn),r.push(new An),r.push(new O),r.push(new vt),t&&r.push(new Vn(e,this.verbose))),this.readers=r}reset(){if(this.readers!==null)for(const e of this.readers)e.reset()}decodeInternal(e){if(this.readers===null)throw new Dr("No readers where selected, nothing can be read.");for(const t of this.readers)try{return t.decode(e,this.hints)}catch(n){if(n instanceof Dr)continue}throw new q("No MultiFormat Readers were able to detect the code.")}}class No extends fe{constructor(e=null,t=500){const n=new $i;n.setHints(e),super(n,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class Ro extends fe{constructor(e=500){super(new vt,e)}}class Oo extends fe{constructor(e=500){super(new Cn,e)}}var ui;(function(b){b[b.ERROR_CORRECTION=0]="ERROR_CORRECTION",b[b.CHARACTER_SET=1]="CHARACTER_SET",b[b.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",b[b.MIN_SIZE=3]="MIN_SIZE",b[b.MAX_SIZE=4]="MAX_SIZE",b[b.MARGIN=5]="MARGIN",b[b.PDF417_COMPACT=6]="PDF417_COMPACT",b[b.PDF417_COMPACTION=7]="PDF417_COMPACTION",b[b.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",b[b.AZTEC_LAYERS=9]="AZTEC_LAYERS",b[b.QR_VERSION=10]="QR_VERSION"})(ui||(ui={}));var Nt=ui;class fi{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new gt(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let n=t[t.length-1];const r=this.field;for(let i=t.length;i<=e;i++){const o=n.multiply(new gt(r,Int32Array.from([1,r.exp(i-1+r.getGeneratorBase())])));t.push(o),n=o}}return t[e]}encode(e,t){if(t===0)throw new _("No error correction bytes");const n=e.length-t;if(n<=0)throw new _("No data bytes provided");const r=this.buildGenerator(t),i=new Int32Array(n);M.arraycopy(e,0,i,0,n);let o=new gt(this.field,i);o=o.multiplyByMonomial(t,1);const u=o.divide(r)[1].getCoefficients(),g=t-u.length;for(let A=0;A<g;A++)e[n+A]=0;M.arraycopy(u,0,e,n+g,u.length)}}class wt{constructor(){}static applyMaskPenaltyRule1(e){return wt.applyMaskPenaltyRule1Internal(e,!0)+wt.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let o=0;o<i-1;o++){const l=n[o];for(let u=0;u<r-1;u++){const g=l[u];g===l[u+1]&&g===n[o+1][u]&&g===n[o+1][u+1]&&t++}}return wt.N2*t}static applyMaskPenaltyRule3(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let o=0;o<i;o++)for(let l=0;l<r;l++){const u=n[o];l+6<r&&u[l]===1&&u[l+1]===0&&u[l+2]===1&&u[l+3]===1&&u[l+4]===1&&u[l+5]===0&&u[l+6]===1&&(wt.isWhiteHorizontal(u,l-4,l)||wt.isWhiteHorizontal(u,l+7,l+11))&&t++,o+6<i&&n[o][l]===1&&n[o+1][l]===0&&n[o+2][l]===1&&n[o+3][l]===1&&n[o+4][l]===1&&n[o+5][l]===0&&n[o+6][l]===1&&(wt.isWhiteVertical(n,l,o-4,o)||wt.isWhiteVertical(n,l,o+7,o+11))&&t++}return t*wt.N3}static isWhiteHorizontal(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(let r=t;r<n;r++)if(e[r]===1)return!1;return!0}static isWhiteVertical(e,t,n,r){n=Math.max(n,0),r=Math.min(r,e.length);for(let i=n;i<r;i++)if(e[i][t]===1)return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const n=e.getArray(),r=e.getWidth(),i=e.getHeight();for(let u=0;u<i;u++){const g=n[u];for(let A=0;A<r;A++)g[A]===1&&t++}const o=e.getHeight()*e.getWidth();return Math.floor(Math.abs(t*2-o)*10/o)*wt.N4}static getDataMaskBit(e,t,n){let r,i;switch(e){case 0:r=n+t&1;break;case 1:r=n&1;break;case 2:r=t%3;break;case 3:r=(n+t)%3;break;case 4:r=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:i=n*t,r=(i&1)+i%3;break;case 6:i=n*t,r=(i&1)+i%3&1;break;case 7:i=n*t,r=i%3+(n+t&1)&1;break;default:throw new _("Invalid mask pattern: "+e)}return r===0}static applyMaskPenaltyRule1Internal(e,t){let n=0;const r=t?e.getHeight():e.getWidth(),i=t?e.getWidth():e.getHeight(),o=e.getArray();for(let l=0;l<r;l++){let u=0,g=-1;for(let A=0;A<i;A++){const I=t?o[l][A]:o[A][l];I===g?u++:(u>=5&&(n+=wt.N1+(u-5)),u=1,g=I)}u>=5&&(n+=wt.N1+(u-5))}return n}}wt.N1=3,wt.N2=3,wt.N3=40,wt.N4=10;class vr{constructor(e,t){this.width=e,this.height=t;const n=new Array(t);for(let r=0;r!==t;r++)n[r]=new Uint8Array(e);this.bytes=n}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,n){this.bytes[t][e]=n}setBoolean(e,t,n){this.bytes[t][e]=n?1:0}clear(e){for(const t of this.bytes)z.fill(t,e)}equals(e){if(!(e instanceof vr))return!1;const t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(let n=0,r=this.height;n<r;++n){const i=this.bytes[n],o=t.bytes[n];for(let l=0,u=this.width;l<u;++l)if(i[l]!==o[l])return!1}return!0}toString(){const e=new ne;for(let t=0,n=this.height;t<n;++t){const r=this.bytes[t];for(let i=0,o=this.width;i<o;++i)switch(r[i]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()}}class Bn{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new ne;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<Bn.NUM_MASK_PATTERNS}}Bn.NUM_MASK_PATTERNS=8;class st extends m{}st.kind="WriterException";class Me{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,n,r,i){Me.clearMatrix(i),Me.embedBasicPatterns(n,i),Me.embedTypeInfo(t,r,i),Me.maybeEmbedVersionInfo(n,i),Me.embedDataBits(e,r,i)}static embedBasicPatterns(e,t){Me.embedPositionDetectionPatternsAndSeparators(t),Me.embedDarkDotAtLeftBottomCorner(t),Me.maybeEmbedPositionAdjustmentPatterns(e,t),Me.embedTimingPatterns(t)}static embedTypeInfo(e,t,n){const r=new Y;Me.makeTypeInfoBits(e,t,r);for(let i=0,o=r.getSize();i<o;++i){const l=r.get(r.getSize()-1-i),u=Me.TYPE_INFO_COORDINATES[i],g=u[0],A=u[1];if(n.setBoolean(g,A,l),i<8){const I=n.getWidth()-i-1,y=8;n.setBoolean(I,y,l)}else{const y=n.getHeight()-7+(i-8);n.setBoolean(8,y,l)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const n=new Y;Me.makeVersionInfoBits(e,n);let r=6*3-1;for(let i=0;i<6;++i)for(let o=0;o<3;++o){const l=n.get(r);r--,t.setBoolean(i,t.getHeight()-11+o,l),t.setBoolean(t.getHeight()-11+o,i,l)}}static embedDataBits(e,t,n){let r=0,i=-1,o=n.getWidth()-1,l=n.getHeight()-1;for(;o>0;){for(o===6&&(o-=1);l>=0&&l<n.getHeight();){for(let u=0;u<2;++u){const g=o-u;if(!Me.isEmpty(n.get(g,l)))continue;let A;r<e.getSize()?(A=e.get(r),++r):A=!1,t!==255&&wt.getDataMaskBit(t,g,l)&&(A=!A),n.setBoolean(g,l,A)}l+=i}i=-i,l+=i,o-=2}if(r!==e.getSize())throw new st("Not all bits consumed: "+r+"/"+e.getSize())}static findMSBSet(e){return 32-J.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(t===0)throw new _("0 polynomial");const n=Me.findMSBSet(t);for(e<<=n-1;Me.findMSBSet(e)>=n;)e^=t<<Me.findMSBSet(e)-n;return e}static makeTypeInfoBits(e,t,n){if(!Bn.isValidMaskPattern(t))throw new st("Invalid mask pattern");const r=e.getBits()<<3|t;n.appendBits(r,5);const i=Me.calculateBCHCode(r,Me.TYPE_INFO_POLY);n.appendBits(i,10);const o=new Y;if(o.appendBits(Me.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new st("should not happen but we got: "+n.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const n=Me.calculateBCHCode(e.getVersionNumber(),Me.VERSION_INFO_POLY);if(t.appendBits(n,12),t.getSize()!==18)throw new st("should not happen but we got: "+t.getSize())}static isEmpty(e){return e===255}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const n=(t+1)%2;Me.isEmpty(e.get(t,6))&&e.setNumber(t,6,n),Me.isEmpty(e.get(6,t))&&e.setNumber(6,t,n)}}static embedDarkDotAtLeftBottomCorner(e){if(e.get(8,e.getHeight()-8)===0)throw new st;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,n){for(let r=0;r<8;++r){if(!Me.isEmpty(n.get(e+r,t)))throw new st;n.setNumber(e+r,t,0)}}static embedVerticalSeparationPattern(e,t,n){for(let r=0;r<7;++r){if(!Me.isEmpty(n.get(e,t+r)))throw new st;n.setNumber(e,t+r,0)}}static embedPositionAdjustmentPattern(e,t,n){for(let r=0;r<5;++r){const i=Me.POSITION_ADJUSTMENT_PATTERN[r];for(let o=0;o<5;++o)n.setNumber(e+o,t+r,i[o])}}static embedPositionDetectionPattern(e,t,n){for(let r=0;r<7;++r){const i=Me.POSITION_DETECTION_PATTERN[r];for(let o=0;o<7;++o)n.setNumber(e+o,t+r,i[o])}}static embedPositionDetectionPatternsAndSeparators(e){const t=Me.POSITION_DETECTION_PATTERN[0].length;Me.embedPositionDetectionPattern(0,0,e),Me.embedPositionDetectionPattern(e.getWidth()-t,0,e),Me.embedPositionDetectionPattern(0,e.getWidth()-t,e);const n=8;Me.embedHorizontalSeparationPattern(0,n-1,e),Me.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),Me.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);const r=7;Me.embedVerticalSeparationPattern(r,0,e),Me.embedVerticalSeparationPattern(e.getHeight()-r-1,0,e),Me.embedVerticalSeparationPattern(r,e.getHeight()-r,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const n=e.getVersionNumber()-1,r=Me.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n];for(let i=0,o=r.length;i!==o;i++){const l=r[i];if(l>=0)for(let u=0;u!==o;u++){const g=r[u];g>=0&&Me.isEmpty(t.get(g,l))&&Me.embedPositionAdjustmentPattern(g-2,l-2,t)}}}}Me.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Me.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Me.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Me.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Me.VERSION_INFO_POLY=7973,Me.TYPE_INFO_POLY=1335,Me.TYPE_INFO_MASK_PATTERN=21522;class Bo{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class ut{constructor(){}static calculateMaskPenalty(e){return wt.applyMaskPenaltyRule1(e)+wt.applyMaskPenaltyRule2(e)+wt.applyMaskPenaltyRule3(e)+wt.applyMaskPenaltyRule4(e)}static encode(e,t,n=null){let r=ut.DEFAULT_BYTE_MODE_ENCODING;const i=n!==null&&n.get(Nt.CHARACTER_SET)!==void 0;i&&(r=n.get(Nt.CHARACTER_SET).toString());const o=this.chooseMode(e,r),l=new Y;if(o===Be.BYTE&&(i||ut.DEFAULT_BYTE_MODE_ENCODING!==r)){const ge=k.getCharacterSetECIByName(r);ge!==void 0&&this.appendECI(ge,l)}this.appendModeInfo(o,l);const u=new Y;this.appendBytes(e,o,u,r);let g;if(n!==null&&n.get(Nt.QR_VERSION)!==void 0){const ge=Number.parseInt(n.get(Nt.QR_VERSION).toString(),10);g=Oe.getVersionForNumber(ge);const ue=this.calculateBitsNeeded(o,l,u,g);if(!this.willFit(ue,g,t))throw new st("Data too big for requested version")}else g=this.recommendVersion(t,o,l,u);const A=new Y;A.appendBitArray(l);const I=o===Be.BYTE?u.getSizeInBytes():e.length;this.appendLengthInfo(I,g,o,A),A.appendBitArray(u);const y=g.getECBlocksForLevel(t),N=g.getTotalCodewords()-y.getTotalECCodewords();this.terminateBits(N,A);const L=this.interleaveWithECBytes(A,g.getTotalCodewords(),N,y.getNumBlocks()),V=new Bn;V.setECLevel(t),V.setMode(o),V.setVersion(g);const Z=g.getDimensionForVersion(),te=new vr(Z,Z),de=this.chooseMaskPattern(L,t,g,te);return V.setMaskPattern(de),Me.buildMatrix(L,t,g,de,te),V.setMatrix(te),V}static recommendVersion(e,t,n,r){const i=this.calculateBitsNeeded(t,n,r,Oe.getVersionForNumber(1)),o=this.chooseVersion(i,e),l=this.calculateBitsNeeded(t,n,r,o);return this.chooseVersion(l,e)}static calculateBitsNeeded(e,t,n,r){return t.getSize()+e.getCharacterCountBits(r)+n.getSize()}static getAlphanumericCode(e){return e<ut.ALPHANUMERIC_TABLE.length?ut.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(k.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return Be.KANJI;let n=!1,r=!1;for(let i=0,o=e.length;i<o;++i){const l=e.charAt(i);if(ut.isDigit(l))n=!0;else if(this.getAlphanumericCode(l.charCodeAt(0))!==-1)r=!0;else return Be.BYTE}return r?Be.ALPHANUMERIC:n?Be.NUMERIC:Be.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=pe.encode(e,k.SJIS)}catch{return!1}const n=t.length;if(n%2!==0)return!1;for(let r=0;r<n;r+=2){const i=t[r]&255;if((i<129||i>159)&&(i<224||i>235))return!1}return!0}static chooseMaskPattern(e,t,n,r){let i=Number.MAX_SAFE_INTEGER,o=-1;for(let l=0;l<Bn.NUM_MASK_PATTERNS;l++){Me.buildMatrix(e,t,n,l,r);let u=this.calculateMaskPenalty(r);u<i&&(i=u,o=l)}return o}static chooseVersion(e,t){for(let n=1;n<=40;n++){const r=Oe.getVersionForNumber(n);if(ut.willFit(e,r,t))return r}throw new st("Data too big")}static willFit(e,t,n){const r=t.getTotalCodewords(),o=t.getECBlocksForLevel(n).getTotalECCodewords(),l=r-o,u=(e+7)/8;return l>=u}static terminateBits(e,t){const n=e*8;if(t.getSize()>n)throw new st("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(let o=0;o<4&&t.getSize()<n;++o)t.appendBit(!1);const r=t.getSize()&7;if(r>0)for(let o=r;o<8;o++)t.appendBit(!1);const i=e-t.getSizeInBytes();for(let o=0;o<i;++o)t.appendBits((o&1)===0?236:17,8);if(t.getSize()!==n)throw new st("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,n,r,i,o){if(r>=n)throw new st("Block ID too large");const l=e%n,u=n-l,g=Math.floor(e/n),A=g+1,I=Math.floor(t/n),y=I+1,N=g-I,L=A-y;if(N!==L)throw new st("EC bytes mismatch");if(n!==u+l)throw new st("RS blocks mismatch");if(e!==(I+N)*u+(y+L)*l)throw new st("Total bytes mismatch");r<u?(i[0]=I,o[0]=N):(i[0]=y,o[0]=L)}static interleaveWithECBytes(e,t,n,r){if(e.getSizeInBytes()!==n)throw new st("Number of bits and data bytes does not match");let i=0,o=0,l=0;const u=new Array;for(let A=0;A<r;++A){const I=new Int32Array(1),y=new Int32Array(1);ut.getNumDataBytesAndNumECBytesForBlockID(t,n,r,A,I,y);const N=I[0],L=new Uint8Array(N);e.toBytes(8*i,L,0,N);const V=ut.generateECBytes(L,y[0]);u.push(new Bo(L,V)),o=Math.max(o,N),l=Math.max(l,V.length),i+=I[0]}if(n!==i)throw new st("Data bytes does not match offset");const g=new Y;for(let A=0;A<o;++A)for(const I of u){const y=I.getDataBytes();A<y.length&&g.appendBits(y[A],8)}for(let A=0;A<l;++A)for(const I of u){const y=I.getErrorCorrectionBytes();A<y.length&&g.appendBits(y[A],8)}if(t!==g.getSizeInBytes())throw new st("Interleaving error: "+t+" and "+g.getSizeInBytes()+" differ.");return g}static generateECBytes(e,t){const n=e.length,r=new Int32Array(n+t);for(let o=0;o<n;o++)r[o]=e[o]&255;new fi(Ee.QR_CODE_FIELD_256).encode(r,t);const i=new Uint8Array(t);for(let o=0;o<t;o++)i[o]=r[n+o];return i}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,n,r){const i=n.getCharacterCountBits(t);if(e>=1<<i)throw new st(e+" is bigger than "+((1<<i)-1));r.appendBits(e,i)}static appendBytes(e,t,n,r){switch(t){case Be.NUMERIC:ut.appendNumericBytes(e,n);break;case Be.ALPHANUMERIC:ut.appendAlphanumericBytes(e,n);break;case Be.BYTE:ut.append8BitBytes(e,n,r);break;case Be.KANJI:ut.appendKanjiBytes(e,n);break;default:throw new st("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=ut.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=ut.getDigit(e.charAt(r));if(r+2<n){const o=ut.getDigit(e.charAt(r+1)),l=ut.getDigit(e.charAt(r+2));t.appendBits(i*100+o*10+l,10),r+=3}else if(r+1<n){const o=ut.getDigit(e.charAt(r+1));t.appendBits(i*10+o,7),r+=2}else t.appendBits(i,4),r++}}static appendAlphanumericBytes(e,t){const n=e.length;let r=0;for(;r<n;){const i=ut.getAlphanumericCode(e.charCodeAt(r));if(i===-1)throw new st;if(r+1<n){const o=ut.getAlphanumericCode(e.charCodeAt(r+1));if(o===-1)throw new st;t.appendBits(i*45+o,11),r+=2}else t.appendBits(i,6),r++}}static append8BitBytes(e,t,n){let r;try{r=pe.encode(e,n)}catch(i){throw new st(i)}for(let i=0,o=r.length;i!==o;i++){const l=r[i];t.appendBits(l,8)}}static appendKanjiBytes(e,t){let n;try{n=pe.encode(e,k.SJIS)}catch(i){throw new st(i)}const r=n.length;for(let i=0;i<r;i+=2){const o=n[i]&255,l=n[i+1]&255,u=o<<8&4294967295|l;let g=-1;if(u>=33088&&u<=40956?g=u-33088:u>=57408&&u<=60351&&(g=u-49472),g===-1)throw new st("Invalid byte sequence");const A=(g>>8)*192+(g&255);t.appendBits(A,13)}}static appendECI(e,t){t.appendBits(Be.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}ut.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),ut.DEFAULT_BYTE_MODE_ENCODING=k.UTF8.getName();class Mn{write(e,t,n,r=null){if(e.length===0)throw new _("Found empty contents");if(t<0||n<0)throw new _("Requested dimensions are too small: "+t+"x"+n);let i=at.L,o=Mn.QUIET_ZONE_SIZE;r!==null&&(r.get(Nt.ERROR_CORRECTION)!==void 0&&(i=at.fromString(r.get(Nt.ERROR_CORRECTION).toString())),r.get(Nt.MARGIN)!==void 0&&(o=Number.parseInt(r.get(Nt.MARGIN).toString(),10)));const l=ut.encode(e,i,r);return this.renderResult(l,t,n,o)}writeToDom(e,t,n,r,i=null){typeof e=="string"&&(e=document.querySelector(e));const o=this.write(t,n,r,i);e&&e.appendChild(o)}renderResult(e,t,n,r){const i=e.getMatrix();if(i===null)throw new yt;const o=i.getWidth(),l=i.getHeight(),u=o+r*2,g=l+r*2,A=Math.max(t,u),I=Math.max(n,g),y=Math.min(Math.floor(A/u),Math.floor(I/g)),N=Math.floor((A-o*y)/2),L=Math.floor((I-l*y)/2),V=this.createSVGElement(A,I);for(let Z=0,te=L;Z<l;Z++,te+=y)for(let de=0,ge=N;de<o;de++,ge+=y)if(i.get(de,Z)===1){const ue=this.createSvgRectElement(ge,te,y,y);V.appendChild(ue)}return V}createSVGElement(e,t){const n=document.createElementNS(Mn.SVG_NS,"svg");return n.setAttributeNS(null,"height",e.toString()),n.setAttributeNS(null,"width",t.toString()),n}createSvgRectElement(e,t,n,r){const i=document.createElementNS(Mn.SVG_NS,"rect");return i.setAttributeNS(null,"x",e.toString()),i.setAttributeNS(null,"y",t.toString()),i.setAttributeNS(null,"height",n.toString()),i.setAttributeNS(null,"width",r.toString()),i.setAttributeNS(null,"fill","#000000"),i}}Mn.QUIET_ZONE_SIZE=4,Mn.SVG_NS="http://www.w3.org/2000/svg";class Gn{encode(e,t,n,r,i){if(e.length===0)throw new _("Found empty contents");if(t!==Ce.QR_CODE)throw new _("Can only encode QR_CODE, but got "+t);if(n<0||r<0)throw new _(`Requested dimensions are too small: ${n}x${r}`);let o=at.L,l=Gn.QUIET_ZONE_SIZE;i!==null&&(i.get(Nt.ERROR_CORRECTION)!==void 0&&(o=at.fromString(i.get(Nt.ERROR_CORRECTION).toString())),i.get(Nt.MARGIN)!==void 0&&(l=Number.parseInt(i.get(Nt.MARGIN).toString(),10)));const u=ut.encode(e,o,i);return Gn.renderResult(u,n,r,l)}static renderResult(e,t,n,r){const i=e.getMatrix();if(i===null)throw new yt;const o=i.getWidth(),l=i.getHeight(),u=o+r*2,g=l+r*2,A=Math.max(t,u),I=Math.max(n,g),y=Math.min(Math.floor(A/u),Math.floor(I/g)),N=Math.floor((A-o*y)/2),L=Math.floor((I-l*y)/2),V=new Ae(A,I);for(let Z=0,te=L;Z<l;Z++,te+=y)for(let de=0,ge=N;de<o;de++,ge+=y)i.get(de,Z)===1&&V.setRegion(ge,te,y,y);return V}}Gn.QUIET_ZONE_SIZE=4;class Mo{encode(e,t,n,r,i){let o;switch(t){case Ce.QR_CODE:o=new Gn;break;default:throw new _("No encoder available for format "+t)}return o.encode(e,t,n,r,i)}}class un extends De{constructor(e,t,n,r,i,o,l,u){if(super(o,l),this.yuvData=e,this.dataWidth=t,this.dataHeight=n,this.left=r,this.top=i,r+o>t||i+l>n)throw new _("Crop rectangle does not fit within image data.");u&&this.reverseHorizontal(o,l)}getRow(e,t){if(e<0||e>=this.getHeight())throw new _("Requested row is outside the image: "+e);const n=this.getWidth();(t==null||t.length<n)&&(t=new Uint8ClampedArray(n));const r=(e+this.top)*this.dataWidth+this.left;return M.arraycopy(this.yuvData,r,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const n=e*t,r=new Uint8ClampedArray(n);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return M.arraycopy(this.yuvData,i,r,0,n),r;for(let o=0;o<t;o++){const l=o*e;M.arraycopy(this.yuvData,i,r,l,e),i+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,n,r){return new un(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,n,r,!1)}renderThumbnail(){const e=this.getWidth()/un.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/un.THUMBNAIL_SCALE_FACTOR,n=new Int32Array(e*t),r=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let o=0;o<t;o++){const l=o*e;for(let u=0;u<e;u++){const g=r[i+u*un.THUMBNAIL_SCALE_FACTOR]&255;n[l+u]=4278190080|g*65793}i+=this.dataWidth*un.THUMBNAIL_SCALE_FACTOR}return n}getThumbnailWidth(){return this.getWidth()/un.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/un.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const n=this.yuvData;for(let r=0,i=this.top*this.dataWidth+this.left;r<t;r++,i+=this.dataWidth){const o=i+e/2;for(let l=i,u=i+e-1;l<o;l++,u--){const g=n[l];n[l]=n[u],n[u]=g}}}invert(){return new et(this)}}un.THUMBNAIL_SCALE_FACTOR=2;class hi extends De{constructor(e,t,n,r,i,o,l){if(super(t,n),this.dataWidth=r,this.dataHeight=i,this.left=o,this.top=l,e.BYTES_PER_ELEMENT===4){const u=t*n,g=new Uint8ClampedArray(u);for(let A=0;A<u;A++){const I=e[A],y=I>>16&255,N=I>>7&510,L=I&255;g[A]=(y+N+L)/4&255}this.luminances=g}else this.luminances=e;if(r===void 0&&(this.dataWidth=t),i===void 0&&(this.dataHeight=n),o===void 0&&(this.left=0),l===void 0&&(this.top=0),this.left+t>this.dataWidth||this.top+n>this.dataHeight)throw new _("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new _("Requested row is outside the image: "+e);const n=this.getWidth();(t==null||t.length<n)&&(t=new Uint8ClampedArray(n));const r=(e+this.top)*this.dataWidth+this.left;return M.arraycopy(this.luminances,r,t,0,n),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const n=e*t,r=new Uint8ClampedArray(n);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return M.arraycopy(this.luminances,i,r,0,n),r;for(let o=0;o<t;o++){const l=o*e;M.arraycopy(this.luminances,i,r,l,e),i+=this.dataWidth}return r}isCropSupported(){return!0}crop(e,t,n,r){return new hi(this.luminances,n,r,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new et(this)}}class Ji extends k{static forName(e){return this.getCharacterSetECIByName(e)}}class di{}di.ISO_8859_1=k.ISO8859_1;class es{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class ts{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class Do{constructor(e){this.previous=e}getPrevious(){return this.previous}}class Xn extends Do{constructor(e,t,n){super(e),this.value=t,this.bitCount=n}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new Xn(this,e,t)}addBinaryShift(e,t){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Xn(this,e,t)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+J.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class gi extends Xn{constructor(e,t,n){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=n}appendTo(e,t){for(let n=0;n<this.binaryShiftByteCount;n++)(n===0||n===31&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):n===0?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+n],8)}addBinaryShift(e,t){return new gi(this,e,t)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function vo(b,e,t){return new gi(b,e,t)}function cr(b,e,t){return new Xn(b,e,t)}const ko=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],In=0,kr=1,tn=2,ns=3,fn=4,Lo=new Xn(null,0,0),xi=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,(10<<16)+(29<<5)+30]),Int32Array.from([(9<<16)+(30<<4)+14,0,(5<<16)+30,(5<<16)+29,(10<<16)+(29<<5)+30]),Int32Array.from([(4<<16)+14,(9<<16)+(14<<5)+28,0,(9<<16)+(14<<5)+29,(14<<16)+(14<<10)+(29<<5)+30]),Int32Array.from([(5<<16)+29,(5<<16)+28,(10<<16)+(29<<5)+30,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,(10<<16)+(31<<5)+28,(10<<16)+(31<<5)+30,(10<<16)+(31<<5)+29,0])];function Po(b){for(let e of b)z.fill(e,-1);return b[In][fn]=0,b[kr][fn]=0,b[kr][In]=28,b[ns][fn]=0,b[tn][fn]=0,b[tn][In]=15,b}const rs=Po(z.createInt32Array(6,6));class hn{constructor(e,t,n,r){this.token=e,this.mode=t,this.binaryShiftByteCount=n,this.bitCount=r}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let n=this.bitCount,r=this.token;if(e!==this.mode){let o=xi[this.mode][e];r=cr(r,o&65535,o>>16),n+=o>>16}let i=e===tn?4:5;return r=cr(r,t,i),new hn(r,e,0,n+i)}shiftAndAppend(e,t){let n=this.token,r=this.mode===tn?4:5;return n=cr(n,rs[this.mode][e],r),n=cr(n,t,5),new hn(n,this.mode,0,this.bitCount+r+5)}addBinaryShiftChar(e){let t=this.token,n=this.mode,r=this.bitCount;if(this.mode===fn||this.mode===tn){let l=xi[n][In];t=cr(t,l&65535,l>>16),r+=l>>16,n=In}let i=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,o=new hn(t,n,this.binaryShiftByteCount+1,r+i);return o.binaryShiftByteCount===2047+31&&(o=o.endBinaryShift(e+1)),o}endBinaryShift(e){if(this.binaryShiftByteCount===0)return this;let t=this.token;return t=vo(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new hn(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(xi[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=hn.calculateBinaryShiftCost(e)-hn.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let r=this.endBinaryShift(e.length).token;r!==null;r=r.getPrevious())t.unshift(r);let n=new Y;for(const r of t)r.appendTo(n,e);return n}toString(){return ae.format("%s bits=%d bytes=%d",ko[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}hn.INITIAL_STATE=new hn(Lo,In,0,0);function Fo(b){const e=ae.getCharCode(" "),t=ae.getCharCode("."),n=ae.getCharCode(",");b[In][e]=1;const r=ae.getCharCode("Z"),i=ae.getCharCode("A");for(let y=i;y<=r;y++)b[In][y]=y-i+2;b[kr][e]=1;const o=ae.getCharCode("z"),l=ae.getCharCode("a");for(let y=l;y<=o;y++)b[kr][y]=y-l+2;b[tn][e]=1;const u=ae.getCharCode("9"),g=ae.getCharCode("0");for(let y=g;y<=u;y++)b[tn][y]=y-g+2;b[tn][n]=12,b[tn][t]=13;const A=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","\x7F"];for(let y=0;y<A.length;y++)b[ns][ae.getCharCode(A[y])]=y;const I=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let y=0;y<I.length;y++)ae.getCharCode(I[y])>0&&(b[fn][ae.getCharCode(I[y])]=y);return b}const wi=Fo(z.createInt32Array(5,256));class ur{constructor(e){this.text=e}encode(){const e=ae.getCharCode(" "),t=ae.getCharCode(`
`);let n=ts.singletonList(hn.INITIAL_STATE);for(let i=0;i<this.text.length;i++){let o,l=i+1<this.text.length?this.text[i+1]:0;switch(this.text[i]){case ae.getCharCode("\r"):o=l===t?2:0;break;case ae.getCharCode("."):o=l===e?3:0;break;case ae.getCharCode(","):o=l===e?4:0;break;case ae.getCharCode(":"):o=l===e?5:0;break;default:o=0}o>0?(n=ur.updateStateListForPair(n,i,o),i++):n=this.updateStateListForChar(n,i)}return ts.min(n,(i,o)=>i.getBitCount()-o.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,t){const n=[];for(let r of e)this.updateStateForChar(r,t,n);return ur.simplifyStates(n)}updateStateForChar(e,t,n){let r=this.text[t]&255,i=wi[e.getMode()][r]>0,o=null;for(let l=0;l<=fn;l++){let u=wi[l][r];if(u>0){if(o==null&&(o=e.endBinaryShift(t)),!i||l===e.getMode()||l===tn){const g=o.latchAndAppend(l,u);n.push(g)}if(!i&&rs[e.getMode()][l]>=0){const g=o.shiftAndAppend(l,u);n.push(g)}}}if(e.getBinaryShiftByteCount()>0||wi[e.getMode()][r]===0){let l=e.addBinaryShiftChar(t);n.push(l)}}static updateStateListForPair(e,t,n){const r=[];for(let i of e)this.updateStateForPair(i,t,n,r);return this.simplifyStates(r)}static updateStateForPair(e,t,n,r){let i=e.endBinaryShift(t);if(r.push(i.latchAndAppend(fn,n)),e.getMode()!==fn&&r.push(i.shiftAndAppend(fn,n)),n===3||n===4){let o=i.latchAndAppend(tn,16-n).latchAndAppend(tn,1);r.push(o)}if(e.getBinaryShiftByteCount()>0){let o=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);r.push(o)}}static simplifyStates(e){let t=[];for(const n of e){let r=!0;for(const i of t){if(i.isBetterThanOrEqualTo(n)){r=!1;break}n.isBetterThanOrEqualTo(i)&&(t=t.filter(o=>o!==i))}r&&t.push(n)}return t}}class Ke{constructor(){}static encodeBytes(e){return Ke.encode(e,Ke.DEFAULT_EC_PERCENT,Ke.DEFAULT_AZTEC_LAYERS)}static encode(e,t,n){let r=new ur(e).encode(),i=J.truncDivision(r.getSize()*t,100)+11,o=r.getSize()+i,l,u,g,A,I;if(n!==Ke.DEFAULT_AZTEC_LAYERS){if(l=n<0,u=Math.abs(n),u>(l?Ke.MAX_NB_BITS_COMPACT:Ke.MAX_NB_BITS))throw new _(ae.format("Illegal value %s for layers",n));g=Ke.totalBitsInLayer(u,l),A=Ke.WORD_SIZE[u];let ue=g-g%A;if(I=Ke.stuffBits(r,A),I.getSize()+i>ue)throw new _("Data to large for user specified layer");if(l&&I.getSize()>A*64)throw new _("Data to large for user specified layer")}else{A=0,I=null;for(let ue=0;;ue++){if(ue>Ke.MAX_NB_BITS)throw new _("Data too large for an Aztec code");if(l=ue<=3,u=l?ue+1:ue,g=Ke.totalBitsInLayer(u,l),o>g)continue;(I==null||A!==Ke.WORD_SIZE[u])&&(A=Ke.WORD_SIZE[u],I=Ke.stuffBits(r,A));let Ge=g-g%A;if(!(l&&I.getSize()>A*64)&&I.getSize()+i<=Ge)break}}let y=Ke.generateCheckWords(I,g,A),N=I.getSize()/A,L=Ke.generateModeMessage(l,u,N),V=(l?11:14)+u*4,Z=new Int32Array(V),te;if(l){te=V;for(let ue=0;ue<Z.length;ue++)Z[ue]=ue}else{te=V+1+2*J.truncDivision(J.truncDivision(V,2)-1,15);let ue=J.truncDivision(V,2),Ge=J.truncDivision(te,2);for(let Pe=0;Pe<ue;Pe++){let Yt=Pe+J.truncDivision(Pe,15);Z[ue-Pe-1]=Ge-Yt-1,Z[ue+Pe]=Ge+Yt+1}}let de=new Ae(te);for(let ue=0,Ge=0;ue<u;ue++){let Pe=(u-ue)*4+(l?9:12);for(let Yt=0;Yt<Pe;Yt++){let on=Yt*2;for(let zt=0;zt<2;zt++)y.get(Ge+on+zt)&&de.set(Z[ue*2+zt],Z[ue*2+Yt]),y.get(Ge+Pe*2+on+zt)&&de.set(Z[ue*2+Yt],Z[V-1-ue*2-zt]),y.get(Ge+Pe*4+on+zt)&&de.set(Z[V-1-ue*2-zt],Z[V-1-ue*2-Yt]),y.get(Ge+Pe*6+on+zt)&&de.set(Z[V-1-ue*2-Yt],Z[ue*2+zt])}Ge+=Pe*8}if(Ke.drawModeMessage(de,l,te,L),l)Ke.drawBullsEye(de,J.truncDivision(te,2),5);else{Ke.drawBullsEye(de,J.truncDivision(te,2),7);for(let ue=0,Ge=0;ue<J.truncDivision(V,2)-1;ue+=15,Ge+=16)for(let Pe=J.truncDivision(te,2)&1;Pe<te;Pe+=2)de.set(J.truncDivision(te,2)-Ge,Pe),de.set(J.truncDivision(te,2)+Ge,Pe),de.set(Pe,J.truncDivision(te,2)-Ge),de.set(Pe,J.truncDivision(te,2)+Ge)}let ge=new es;return ge.setCompact(l),ge.setSize(te),ge.setLayers(u),ge.setCodeWords(N),ge.setMatrix(de),ge}static drawBullsEye(e,t,n){for(let r=0;r<n;r+=2)for(let i=t-r;i<=t+r;i++)e.set(i,t-r),e.set(i,t+r),e.set(t-r,i),e.set(t+r,i);e.set(t-n,t-n),e.set(t-n+1,t-n),e.set(t-n,t-n+1),e.set(t+n,t-n),e.set(t+n,t-n+1),e.set(t+n,t+n-1)}static generateModeMessage(e,t,n){let r=new Y;return e?(r.appendBits(t-1,2),r.appendBits(n-1,6),r=Ke.generateCheckWords(r,28,4)):(r.appendBits(t-1,5),r.appendBits(n-1,11),r=Ke.generateCheckWords(r,40,4)),r}static drawModeMessage(e,t,n,r){let i=J.truncDivision(n,2);if(t)for(let o=0;o<7;o++){let l=i-3+o;r.get(o)&&e.set(l,i-5),r.get(o+7)&&e.set(i+5,l),r.get(20-o)&&e.set(l,i+5),r.get(27-o)&&e.set(i-5,l)}else for(let o=0;o<10;o++){let l=i-5+o+J.truncDivision(o,5);r.get(o)&&e.set(l,i-7),r.get(o+10)&&e.set(i+7,l),r.get(29-o)&&e.set(l,i+7),r.get(39-o)&&e.set(i-7,l)}}static generateCheckWords(e,t,n){let r=e.getSize()/n,i=new fi(Ke.getGF(n)),o=J.truncDivision(t,n),l=Ke.bitsToWords(e,n,o);i.encode(l,o-r);let u=t%n,g=new Y;g.appendBits(0,u);for(const A of Array.from(l))g.appendBits(A,n);return g}static bitsToWords(e,t,n){let r=new Int32Array(n),i,o;for(i=0,o=e.getSize()/t;i<o;i++){let l=0;for(let u=0;u<t;u++)l|=e.get(i*t+u)?1<<t-u-1:0;r[i]=l}return r}static getGF(e){switch(e){case 4:return Ee.AZTEC_PARAM;case 6:return Ee.AZTEC_DATA_6;case 8:return Ee.AZTEC_DATA_8;case 10:return Ee.AZTEC_DATA_10;case 12:return Ee.AZTEC_DATA_12;default:throw new _("Unsupported word size "+e)}}static stuffBits(e,t){let n=new Y,r=e.getSize(),i=(1<<t)-2;for(let o=0;o<r;o+=t){let l=0;for(let u=0;u<t;u++)(o+u>=r||e.get(o+u))&&(l|=1<<t-1-u);(l&i)===i?(n.appendBits(l&i,t),o--):(l&i)===0?(n.appendBits(l|1,t),o--):n.appendBits(l,t)}return n}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Ke.DEFAULT_EC_PERCENT=33,Ke.DEFAULT_AZTEC_LAYERS=0,Ke.MAX_NB_BITS=32,Ke.MAX_NB_BITS_COMPACT=4,Ke.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Lr{encode(e,t,n,r){return this.encodeWithHints(e,t,n,r,null)}encodeWithHints(e,t,n,r,i){let o=di.ISO_8859_1,l=Ke.DEFAULT_EC_PERCENT,u=Ke.DEFAULT_AZTEC_LAYERS;return i!=null&&(i.has(Nt.CHARACTER_SET)&&(o=Ji.forName(i.get(Nt.CHARACTER_SET).toString())),i.has(Nt.ERROR_CORRECTION)&&(l=J.parseInt(i.get(Nt.ERROR_CORRECTION).toString())),i.has(Nt.AZTEC_LAYERS)&&(u=J.parseInt(i.get(Nt.AZTEC_LAYERS).toString()))),Lr.encodeLayers(e,t,n,r,o,l,u)}static encodeLayers(e,t,n,r,i,o,l){if(t!==Ce.AZTEC)throw new _("Can only encode AZTEC, but got "+t);let u=Ke.encode(ae.getBytes(e,i),o,l);return Lr.renderResult(u,n,r)}static renderResult(e,t,n){let r=e.getMatrix();if(r==null)throw new yt;let i=r.getWidth(),o=r.getHeight(),l=Math.max(t,i),u=Math.max(n,o),g=Math.min(l/i,u/o),A=(l-i*g)/2,I=(u-o*g)/2,y=new Ae(l,u);for(let N=0,L=I;N<o;N++,L+=g)for(let V=0,Z=A;V<i;V++,Z+=g)r.get(V,N)&&y.setRegion(Z,L,g,g);return y}}c.ArgumentException=C,c.ArithmeticException=Mt,c.AztecCode=es,c.AztecCodeReader=O,c.AztecCodeWriter=Lr,c.AztecDecoder=tt,c.AztecDetector=E,c.AztecDetectorResult=jt,c.AztecEncoder=Ke,c.AztecHighLevelEncoder=ur,c.AztecPoint=p,c.BarcodeFormat=Ce,c.Binarizer=P,c.BinaryBitmap=B,c.BitArray=Y,c.BitMatrix=Ae,c.BitSource=si,c.BrowserAztecCodeReader=X,c.BrowserBarcodeReader=xo,c.BrowserCodeReader=fe,c.BrowserDatamatrixCodeReader=po,c.BrowserMultiFormatReader=No,c.BrowserPDF417Reader=Ro,c.BrowserQRCodeReader=Oo,c.BrowserQRCodeSvgWriter=Mn,c.CharacterSetECI=k,c.ChecksumException=v,c.Code128Reader=H,c.Code39Reader=Re,c.DataMatrixDecodedBitStreamParser=En,c.DataMatrixReader=An,c.DecodeHintType=$,c.DecoderResult=ht,c.DefaultGridSampler=Tr,c.DetectorResult=wn,c.EAN13Reader=Tn,c.EncodeHintType=Nt,c.Exception=m,c.FormatException=U,c.GenericGF=Ee,c.GenericGFPoly=gt,c.GlobalHistogramBinarizer=Ne,c.GridSampler=nr,c.GridSamplerInstance=S,c.HTMLCanvasElementLuminanceSource=ze,c.HybridBinarizer=oe,c.ITFReader=ve,c.IllegalArgumentException=_,c.IllegalStateException=yt,c.InvertedLuminanceSource=et,c.LuminanceSource=De,c.MathUtils=Xe,c.MultiFormatOneDReader=Vn,c.MultiFormatReader=$i,c.MultiFormatWriter=Mo,c.NotFoundException=q,c.OneDReader=j,c.PDF417DecodedBitStreamParser=ee,c.PDF417DecoderErrorCorrection=zi,c.PDF417Reader=vt,c.PDF417ResultMetadata=Zi,c.PerspectiveTransform=At,c.PlanarYUVLuminanceSource=un,c.QRCodeByteMatrix=vr,c.QRCodeDataMask=Jt,c.QRCodeDecodedBitStreamParser=dt,c.QRCodeDecoderErrorCorrectionLevel=at,c.QRCodeDecoderFormatInformation=Vt,c.QRCodeEncoder=ut,c.QRCodeEncoderQRCode=Bn,c.QRCodeMaskUtil=wt,c.QRCodeMatrixUtil=Me,c.QRCodeMode=Be,c.QRCodeReader=Cn,c.QRCodeVersion=Oe,c.QRCodeWriter=Gn,c.RGBLuminanceSource=hi,c.RSS14Reader=xt,c.RSSExpandedReader=ce,c.ReaderException=Dr,c.ReedSolomonDecoder=Sn,c.ReedSolomonEncoder=fi,c.ReedSolomonException=je,c.Result=we,c.ResultMetadataType=lt,c.ResultPoint=Se,c.StringUtils=ae,c.UnsupportedOperationException=xe,c.VideoInputDevice=ye,c.WhiteRectangleDetector=Zt,c.WriterException=st,c.ZXingArrays=z,c.ZXingCharset=Ji,c.ZXingInteger=J,c.ZXingStandardCharsets=di,c.ZXingStringBuilder=ne,c.ZXingStringEncoding=pe,c.ZXingSystem=M,Object.defineProperty(c,"__esModule",{value:!0})})})(ct,ct.exports);const Ga=Il(ct.exports),Xa=Ho({__proto__:null,default:Ga},[ct.exports]);var Wa=function(){function a(s,c,f){if(this.formatMap=new Map([[Ie.QR_CODE,ct.exports.BarcodeFormat.QR_CODE],[Ie.AZTEC,ct.exports.BarcodeFormat.AZTEC],[Ie.CODABAR,ct.exports.BarcodeFormat.CODABAR],[Ie.CODE_39,ct.exports.BarcodeFormat.CODE_39],[Ie.CODE_93,ct.exports.BarcodeFormat.CODE_93],[Ie.CODE_128,ct.exports.BarcodeFormat.CODE_128],[Ie.DATA_MATRIX,ct.exports.BarcodeFormat.DATA_MATRIX],[Ie.MAXICODE,ct.exports.BarcodeFormat.MAXICODE],[Ie.ITF,ct.exports.BarcodeFormat.ITF],[Ie.EAN_13,ct.exports.BarcodeFormat.EAN_13],[Ie.EAN_8,ct.exports.BarcodeFormat.EAN_8],[Ie.PDF_417,ct.exports.BarcodeFormat.PDF_417],[Ie.RSS_14,ct.exports.BarcodeFormat.RSS_14],[Ie.RSS_EXPANDED,ct.exports.BarcodeFormat.RSS_EXPANDED],[Ie.UPC_A,ct.exports.BarcodeFormat.UPC_A],[Ie.UPC_E,ct.exports.BarcodeFormat.UPC_E],[Ie.UPC_EAN_EXTENSION,ct.exports.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Xa)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=c,this.logger=f;var h=this.createZXingFormats(s),d=new Map;d.set(ct.exports.DecodeHintType.POSSIBLE_FORMATS,h),this.hints=d}return a.prototype.decodeAsync=function(s){var c=this;return new Promise(function(f,h){try{f(c.decode(s))}catch(d){h(d)}})},a.prototype.decode=function(s){var c=new ct.exports.MultiFormatReader(this.verbose,this.hints),f=new ct.exports.HTMLCanvasElementLuminanceSource(s),h=new ct.exports.BinaryBitmap(new ct.exports.HybridBinarizer(f)),d=c.decode(h);return{text:d.text,format:Ws.create(this.toHtml5QrcodeSupportedFormats(d.format))}},a.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(c,f,h){s.set(c,f)}),s},a.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have "+s;return this.reverseFormatMap.get(s)},a.prototype.createZXingFormats=function(s){for(var c=[],f=0,h=s;f<h.length;f++){var d=h[f];this.formatMap.has(d)?c.push(this.formatMap.get(d)):this.logger.logError(d+" is not supported byZXingHtml5QrcodeShim")}return c},a}(),Ya=globalThis&&globalThis.__awaiter||function(a,s,c,f){function h(d){return d instanceof c?d:new c(function(w){w(d)})}return new(c||(c=Promise))(function(d,w){function x(_){try{C(f.next(_))}catch(B){w(B)}}function m(_){try{C(f.throw(_))}catch(B){w(B)}}function C(_){_.done?d(_.value):h(_.value).then(x,m)}C((f=f.apply(a,s||[])).next())})},za=globalThis&&globalThis.__generator||function(a,s){var c={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},f,h,d,w;return w={next:x(0),throw:x(1),return:x(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function x(C){return function(_){return m([C,_])}}function m(C){if(f)throw new TypeError("Generator is already executing.");for(;c;)try{if(f=1,h&&(d=C[0]&2?h.return:C[0]?h.throw||((d=h.return)&&d.call(h),0):h.next)&&!(d=d.call(h,C[1])).done)return d;switch(h=0,d&&(C=[C[0]&2,d.value]),C[0]){case 0:case 1:d=C;break;case 4:return c.label++,{value:C[1],done:!1};case 5:c.label++,h=C[1],C=[0];continue;case 7:C=c.ops.pop(),c.trys.pop();continue;default:if(d=c.trys,!(d=d.length>0&&d[d.length-1])&&(C[0]===6||C[0]===2)){c=0;continue}if(C[0]===3&&(!d||C[1]>d[0]&&C[1]<d[3])){c.label=C[1];break}if(C[0]===6&&c.label<d[1]){c.label=d[1],d=C;break}if(d&&c.label<d[2]){c.label=d[2],c.ops.push(C);break}d[2]&&c.ops.pop(),c.trys.pop();continue}C=s.call(a,c)}catch(_){C=[6,_],h=0}finally{f=d=0}if(C[0]&5)throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}},_s=function(){function a(s,c,f){if(this.formatMap=new Map([[Ie.QR_CODE,"qr_code"],[Ie.AZTEC,"aztec"],[Ie.CODABAR,"codabar"],[Ie.CODE_39,"code_39"],[Ie.CODE_93,"code_93"],[Ie.CODE_128,"code_128"],[Ie.DATA_MATRIX,"data_matrix"],[Ie.ITF,"itf"],[Ie.EAN_13,"ean_13"],[Ie.EAN_8,"ean_8"],[Ie.PDF_417,"pdf417"],[Ie.UPC_A,"upc_a"],[Ie.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!a.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=c,this.logger=f;var h=this.createBarcodeDetectorFormats(s);if(this.detector=new BarcodeDetector(h),!this.detector)throw"BarcodeDetector detector not supported"}return a.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var s=new BarcodeDetector({formats:["qr_code"]});return typeof s<"u"},a.prototype.decodeAsync=function(s){return Ya(this,void 0,void 0,function(){var c,f;return za(this,function(h){switch(h.label){case 0:return[4,this.detector.detect(s)];case 1:if(c=h.sent(),!c||c.length===0)throw"No barcode or QR code detected.";return f=this.selectLargestBarcode(c),[2,{text:f.rawValue,format:Ws.create(this.toHtml5QrcodeSupportedFormats(f.format))}]}})})},a.prototype.selectLargestBarcode=function(s){for(var c=null,f=0,h=0,d=s;h<d.length;h++){var w=d[h],x=w.boundingBox.width*w.boundingBox.height;x>f&&(f=x,c=w)}if(!c)throw"No largest barcode found";return c},a.prototype.createBarcodeDetectorFormats=function(s){for(var c=[],f=0,h=s;f<h.length;f++){var d=h[f];this.formatMap.has(d)?c.push(this.formatMap.get(d)):this.logger.warn(d+" is not supported byBarcodeDetectorDelegate")}return{formats:c}},a.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have "+s;return this.reverseFormatMap.get(s)},a.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(c,f,h){s.set(c,f)}),s},a}(),ja=function(){function a(s,c,f,h){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.verbose=c,h.useBarCodeDetectorIfSupported===!0&&_s.isSupported()?this.decoder=new _s(s,c,f):this.decoder=new Wa(s,c,f)}return a.prototype.decodeAsync=function(s){var c=this,f=performance.now();return this.decoder.decodeAsync(s).finally(function(){if(c.verbose){var h=performance.now()-f;c.executionResults.push(h),c.executions++,c.possiblyFlushPerformanceReport()}})},a.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var s=0,c=0,f=this.executionResults;c<f.length;c++){var h=f[c];s+=h}var d=s/this.executionResults.length;console.log(d+" ms for "+this.executionResults.length+" last runs."),this.executions=0,this.executionResults=[]}},a}(),Za=function(){function a(){}return a.createExperimentalFeaturesConfig=function(s){return s?(s.useBarCodeDetectorIfSupported!==!0&&(s.useBarCodeDetectorIfSupported=!1),s):{useBarCodeDetectorIfSupported:!1}},a}(),pt;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.NOT_STARTED=1]="NOT_STARTED",a[a.SCANNING=2]="SCANNING",a[a.PAUSED=3]="PAUSED"})(pt||(pt={}));var Ka=function(){function a(){this.state=pt.NOT_STARTED,this.onGoingTransactionNewState=pt.UNKNOWN}return a.prototype.directTransition=function(s){this.failIfTransitionOngoing(),this.validateTransition(s),this.state=s},a.prototype.startTransition=function(s){return this.failIfTransitionOngoing(),this.validateTransition(s),this.onGoingTransactionNewState=s,this},a.prototype.execute=function(){if(this.onGoingTransactionNewState===pt.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var s=this.onGoingTransactionNewState;this.onGoingTransactionNewState=pt.UNKNOWN,this.directTransition(s)},a.prototype.cancel=function(){if(this.onGoingTransactionNewState===pt.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=pt.UNKNOWN},a.prototype.getState=function(){return this.state},a.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==pt.UNKNOWN)throw"Cannnot transition to a new state, already under transition"},a.prototype.validateTransition=function(s){switch(this.state){case pt.UNKNOWN:throw"Transition from unknown is not allowed";case pt.NOT_STARTED:this.failIfNewStateIs(s,[pt.PAUSED]);break;case pt.SCANNING:break;case pt.PAUSED:break}},a.prototype.failIfNewStateIs=function(s,c){for(var f=0,h=c;f<h.length;f++){var d=h[f];if(s===d)throw"Cannot transition from "+this.state+" to "+s}},a}(),qa=function(){function a(s){this.stateManager=s}return a.prototype.startTransition=function(s){return this.stateManager.startTransition(s)},a.prototype.directTransition=function(s){this.stateManager.directTransition(s)},a.prototype.getState=function(){return this.stateManager.getState()},a.prototype.canScanFile=function(){return this.stateManager.getState()===pt.NOT_STARTED},a.prototype.isScanning=function(){return this.stateManager.getState()!==pt.NOT_STARTED},a.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===pt.SCANNING},a.prototype.isPaused=function(){return this.stateManager.getState()===pt.PAUSED},a}(),Qa=function(){function a(){}return a.create=function(){return new qa(new Ka)},a}(),$a=globalThis&&globalThis.__extends||function(){var a=function(s,c){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,h){f.__proto__=h}||function(f,h){for(var d in h)Object.prototype.hasOwnProperty.call(h,d)&&(f[d]=h[d])},a(s,c)};return function(s,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(s,c);function f(){this.constructor=s}s.prototype=c===null?Object.create(c):(f.prototype=c.prototype,new f)}}(),nn=function(a){$a(s,a);function s(){return a!==null&&a.apply(this,arguments)||this}return s.DEFAULT_WIDTH=300,s.DEFAULT_WIDTH_OFFSET=2,s.FILE_SCAN_MIN_HEIGHT=300,s.MIN_QR_BOX_SIZE=50,s.SHADED_LEFT=1,s.SHADED_RIGHT=2,s.SHADED_TOP=3,s.SHADED_BOTTOM=4,s.SHADED_REGION_ELEMENT_ID="qr-shaded-region",s.VERBOSE=!1,s.BORDER_SHADER_DEFAULT_COLOR="#ffffff",s.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",s}(Ua),Ja=function(){function a(s,c){this.logger=c,this.fps=nn.SCAN_DEFAULT_FPS,s?(s.fps&&(this.fps=s.fps),this.disableFlip=s.disableFlip===!0,this.qrbox=s.qrbox,this.aspectRatio=s.aspectRatio,this.videoConstraints=s.videoConstraints):this.disableFlip=nn.DEFAULT_DISABLE_FLIP}return a.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Ys.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},a.prototype.isShadedBoxEnabled=function(){return!xr(this.qrbox)},a.create=function(s,c){return new a(s,c)},a}(),e1=function(){function a(s,c){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.videoElement=null,this.localMediaStream=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(s))throw"HTML Element with id="+s+" not found";this.elementId=s,this.verbose=!1;var f;typeof c=="boolean"?this.verbose=c===!0:c&&(this.verbose=c.verbose===!0,f=c.experimentalFeatures),this.logger=new Ha(this.verbose),this.qrcode=new ja(this.getSupportedFormats(c),this.verbose,this.logger,Za.createExperimentalFeaturesConfig(f)),this.foreverScanTimeout,this.localMediaStream,this.shouldScan=!0,this.stateManagerProxy=Qa.create()}return a.prototype.start=function(s,c,f,h){if(!s)throw"cameraIdOrConfig is required";if(!f||typeof f!="function")throw"qrCodeSuccessCallback is required and should be a function.";h||(h=this.verbose?this.logger.log:function(){});var d=Ja.create(c,this.logger);this.clearElement();var w=!1;d.videoConstraints&&(d.isMediaStreamConstraintsValid()?w=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var x=w;d.isShadedBoxEnabled();var m=document.getElementById(this.elementId),C=m.clientWidth?m.clientWidth:nn.DEFAULT_WIDTH;m.style.position="relative",this.shouldScan=!0,this.element=m;var _=this,B=this.stateManagerProxy.startTransition(pt.SCANNING);return new Promise(function(v,P){var M=x?d.videoConstraints:_.createVideoConstraints(s);if(!M){B.cancel(),P("videoConstraints should be defined");return}navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!1,video:M}).then(function(F){_.onMediaStreamReceived(F,d,x,C,f,h).then(function(W){B.execute(),_.isScanning=!0,v(null)}).catch(function(W){B.cancel(),P(W)})}).catch(function(F){B.cancel(),P(hr.errorGettingUserMedia(F))}):(B.cancel(),P(hr.cameraStreamingNotSupported()))})},a.prototype.pause=function(s){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(pt.PAUSED),this.showPausedState(),(xr(s)||s!==!0)&&(s=!1),s&&this.videoElement&&this.videoElement.pause()},a.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.videoElement)throw"VideoElement doesn't exist while trying resume()";var s=this,c=function(){s.stateManagerProxy.directTransition(pt.SCANNING),s.hidePausedState()},f=this.videoElement.paused;if(!f){c();return}var h=function(){var d;setTimeout(c,200),(d=s.videoElement)===null||d===void 0||d.removeEventListener("playing",h)};this.videoElement.addEventListener("playing",h),this.videoElement.play()},a.prototype.getState=function(){return this.stateManagerProxy.getState()},a.prototype.stop=function(){var s=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var c=this.stateManagerProxy.startTransition(pt.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var f=function(){if(!!s.element){var h=document.getElementById(nn.SHADED_REGION_ELEMENT_ID);h&&s.element.removeChild(h)}};return new Promise(function(h,d){var w=function(){s.localMediaStream=null,s.element&&(s.element.removeChild(s.videoElement),s.element.removeChild(s.canvasElement)),f(),s.qrRegion&&(s.qrRegion=null),s.context&&(s.context=null),c.execute(),s.hidePausedState(),s.isScanning=!1,h()};s.localMediaStream||w();var x=s.localMediaStream.getVideoTracks().length,m=0;s.localMediaStream.getVideoTracks().forEach(function(C){s.localMediaStream.removeTrack(C),C.stop(),++m,m>=x&&w()})})},a.prototype.scanFile=function(s,c){return this.scanFileV2(s,c).then(function(f){return f.decodedText})},a.prototype.scanFileV2=function(s,c){var f=this;if(!s||!(s instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(xr(c)&&(c=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(h,d){f.possiblyCloseLastScanImageFile(),f.clearElement(),f.lastScanImageFile=URL.createObjectURL(s);var w=new Image;w.onload=function(){var x=w.width,m=w.height,C=document.getElementById(f.elementId),_=C.clientWidth?C.clientWidth:nn.DEFAULT_WIDTH,B=Math.max(C.clientHeight?C.clientHeight:m,nn.FILE_SCAN_MIN_HEIGHT),v=f.computeCanvasDrawConfig(x,m,_,B);if(c){var P=f.createCanvasElement(_,B,"qr-canvas-visible");P.style.display="inline-block",C.appendChild(P);var M=P.getContext("2d");if(!M)throw"Unable to get 2d context from canvas";M.canvas.width=_,M.canvas.height=B,M.drawImage(w,0,0,x,m,v.x,v.y,v.width,v.height)}var F=f.createCanvasElement(v.width,v.height);C.appendChild(F);var W=F.getContext("2d");if(!W)throw"Unable to get 2d context from canvas";W.canvas.width=v.width,W.canvas.height=v.height,W.drawImage(w,0,0,x,m,0,0,v.width,v.height);try{f.qrcode.decodeAsync(F).then(function(z){h(Is.createFromQrcodeResult(z))}).catch(d)}catch(z){d("QR code parse error, error = "+z)}},w.onerror=d,w.onabort=d,w.onstalled=d,w.onsuspend=d,w.src=URL.createObjectURL(s)})},a.prototype.clear=function(){this.clearElement()},a.getCameras=function(){if(navigator.mediaDevices)return a.getCamerasFromMediaDevices();var s=MediaStreamTrack;if(MediaStreamTrack&&s.getSources)return a.getCamerasFromMediaStreamTrack();var c=function(){if(location.protocol==="https:")return!0;var h=location.host.split(":")[0];return h==="127.0.0.1"||h==="localhost"},f=hr.unableToQuerySupportedDevices();return c()||(f=hr.insecureContextCameraQueryError()),Promise.reject(f)},a.prototype.getRunningTrackCapabilities=function(){if(this.localMediaStream==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";if(this.localMediaStream.getVideoTracks().length===0)throw"No video tracks found";var s=this.localMediaStream.getVideoTracks()[0];return s.getCapabilities()},a.prototype.applyVideoConstraints=function(s){var c=this;if(s){if(!Ys.isMediaStreamConstraintsValid(s,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";if(this.localMediaStream===null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";if(this.localMediaStream.getVideoTracks().length===0)throw"No video tracks found";return new Promise(function(f,h){if("aspectRatio"in s){h("Chaning 'aspectRatio' in run-time is not yet supported.");return}var d=c.localMediaStream.getVideoTracks()[0];d.applyConstraints(s).then(function(w){f(w)}).catch(function(w){h(w)})})},a.getCamerasFromMediaDevices=function(){return new Promise(function(s,c){navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(function(f){var h=function(d){for(var w=d.getVideoTracks(),x=0,m=w;x<m.length;x++){var C=m[x];C.enabled=!1,C.stop(),d.removeTrack(C)}};navigator.mediaDevices.enumerateDevices().then(function(d){for(var w=[],x=0,m=d;x<m.length;x++){var C=m[x];C.kind==="videoinput"&&w.push({id:C.deviceId,label:C.label})}h(f),s(w)}).catch(function(d){c(d.name+" : "+d.message)})}).catch(function(f){c(f.name+" : "+f.message)})})},a.getCamerasFromMediaStreamTrack=function(){return new Promise(function(s,c){var f=function(d){for(var w=[],x=0,m=d;x<m.length;x++){var C=m[x];C.kind==="video"&&w.push({id:C.id,label:C.label})}s(w)},h=MediaStreamTrack;h.getSources(f)})},a.prototype.getSupportedFormats=function(s){var c=[Ie.QR_CODE,Ie.AZTEC,Ie.CODABAR,Ie.CODE_39,Ie.CODE_93,Ie.CODE_128,Ie.DATA_MATRIX,Ie.MAXICODE,Ie.ITF,Ie.EAN_13,Ie.EAN_8,Ie.PDF_417,Ie.RSS_14,Ie.RSS_EXPANDED,Ie.UPC_A,Ie.UPC_E,Ie.UPC_EAN_EXTENSION];if(!s||typeof s=="boolean"||!s.formatsToSupport)return c;if(!Array.isArray(s.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(s.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var f=[],h=0,d=s.formatsToSupport;h<d.length;h++){var w=d[h];Fa(w)?f.push(w):this.logger.warn("Invalid format: "+w+" passed in config, ignoring.")}if(f.length===0)throw"None of formatsToSupport match supported values.";return f},a.prototype.validateQrboxSize=function(s,c,f){var h=this,d=f.qrbox;this.validateQrboxConfig(d);var w=this.toQrdimensions(s,c,d),x=function(C){if(C<nn.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+(" "+nn.MIN_QR_BOX_SIZE+"px.")},m=function(C){return C>s&&(h.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),C=s),C};x(w.width),x(w.height),w.width=m(w.width)},a.prototype.validateQrboxConfig=function(s){if(typeof s!="number"&&typeof s!="function"&&(s.width===void 0||s.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},a.prototype.toQrdimensions=function(s,c,f){if(typeof f=="number")return{width:f,height:f};if(typeof f=="function")try{return f(s,c)}catch(h){throw new Error("qrbox config was passed as a function but it failed with unknown error"+h)}return f},a.prototype.setupUi=function(s,c,f){f.isShadedBoxEnabled()&&this.validateQrboxSize(s,c,f);var h=xr(f.qrbox)?{width:s,height:c}:f.qrbox;this.validateQrboxConfig(h);var d=this.toQrdimensions(s,c,h);d.height>c&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var w=f.isShadedBoxEnabled()&&d.height<=c,x={x:0,y:0,width:s,height:c},m=w?this.getShadedRegionBounds(s,c,d):x,C=this.createCanvasElement(m.width,m.height),_=C.getContext("2d");_.canvas.width=m.width,_.canvas.height=m.height,this.element.append(C),w&&this.possiblyInsertShadingElement(this.element,s,c,d),this.createScannerPausedUiElement(this.element),this.qrRegion=m,this.context=_,this.canvasElement=C},a.prototype.createScannerPausedUiElement=function(s){var c=document.createElement("div");c.innerText="Scanner paused",c.style.display="none",c.style.position="absolute",c.style.top="0px",c.style.zIndex="1",c.style.background="yellow",c.style.textAlign="center",c.style.width="100%",s.appendChild(c),this.scannerPausedUiElement=c},a.prototype.scanContext=function(s,c){var f=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(h){return s(h.text,Is.createFromQrcodeResult(h)),f.possiblyUpdateShaders(!0),!0}).catch(function(h){f.possiblyUpdateShaders(!1);var d=hr.codeParseError(h);return c(d,Va.createFrom(d)),!1})},a.prototype.foreverScan=function(s,c,f){var h=this;if(!!this.shouldScan&&!!this.localMediaStream){var d=this.videoElement,w=d.videoWidth/d.clientWidth,x=d.videoHeight/d.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var m=this.qrRegion.width*w,C=this.qrRegion.height*x,_=this.qrRegion.x*w,B=this.qrRegion.y*x;this.context.drawImage(d,_,B,m,C,0,0,this.qrRegion.width,this.qrRegion.height);var v=function(){h.foreverScanTimeout=setTimeout(function(){h.foreverScan(s,c,f)},h.getTimeoutFps(s.fps))};this.scanContext(c,f).then(function(P){!P&&s.disableFlip!==!0?(h.context.translate(h.context.canvas.width,0),h.context.scale(-1,1),h.scanContext(c,f).finally(function(){v()})):v()}).catch(function(P){h.logger.logError("Error happend while scanning context",P),v()})}},a.prototype.onMediaStreamReceived=function(s,c,f,h,d,w){var x=this,m=this;return new Promise(function(C,_){var B=function(){var M=x.createVideoElement(h);m.element.append(M),M.onabort=_,M.onerror=_;var F=function(){var W=M.clientWidth,z=M.clientHeight;m.setupUi(W,z,c),m.foreverScan(c,d,w),M.removeEventListener("playing",F),C(null)};M.addEventListener("playing",F),M.srcObject=s,M.play(),m.videoElement=M};if(m.localMediaStream=s,f||!c.aspectRatio)B();else{var v={aspectRatio:c.aspectRatio},P=s.getVideoTracks()[0];P.applyConstraints(v).then(function(M){return B()}).catch(function(M){m.logger.logErrors(["[Html5Qrcode] Constriants could not be satisfied, ignoring constraints",M]),B()})}})},a.prototype.createVideoConstraints=function(s){if(typeof s=="string")return{deviceId:{exact:s}};if(typeof s=="object"){var c="facingMode",f="deviceId",h={user:!0,environment:!0},d="exact",w=function(M){if(M in h)return!0;throw"config has invalid 'facingMode' value = "+("'"+M+"'")},x=Object.keys(s);if(x.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+(" if passed as an object, found "+x.length+" keys");var m=Object.keys(s)[0];if(m!==c&&m!==f)throw"Only '"+c+"' and '"+f+"'  are supported for 'cameraIdOrConfig'";if(m===c){var C=s.facingMode;if(typeof C=="string"){if(w(C))return{facingMode:C}}else if(typeof C=="object")if(d in C){if(w(C[""+d]))return{facingMode:{exact:C[""+d]}}}else throw"'facingMode' should be string or object with"+(" "+d+" as key.");else{var _=typeof C;throw"Invalid type of 'facingMode' = "+_}}else{var B=s.deviceId;if(typeof B=="string")return{deviceId:B};if(typeof B=="object"){if(d in B)return{deviceId:{exact:B[""+d]}};throw"'deviceId' should be string or object with"+(" "+d+" as key.")}else{var v=typeof B;throw"Invalid type of 'deviceId' = "+v}}}var P=typeof s;throw"Invalid type of 'cameraIdOrConfig' = "+P},a.prototype.computeCanvasDrawConfig=function(s,c,f,h){if(s<=f&&c<=h){var d=(f-s)/2,w=(h-c)/2;return{x:d,y:w,width:s,height:c}}else{var x=s,m=c;return s>f&&(c=f/s*c,s=f),c>h&&(s=h/c*s,c=h),this.logger.log("Image downsampled from "+(x+"X"+m)+(" to "+s+"X"+c+".")),this.computeCanvasDrawConfig(s,c,f,h)}},a.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var s=document.getElementById(this.elementId);s&&(s.innerHTML="")},a.prototype.createVideoElement=function(s){var c=document.createElement("video");return c.style.width=s+"px",c.muted=!0,c.setAttribute("muted","true"),c.playsInline=!0,c},a.prototype.possiblyUpdateShaders=function(s){this.qrMatch!==s&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(c){c.style.backgroundColor=s?nn.BORDER_SHADER_MATCH_COLOR:nn.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=s)},a.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},a.prototype.createCanvasElement=function(s,c,f){var h=s,d=c,w=document.createElement("canvas");return w.style.width=h+"px",w.style.height=d+"px",w.style.display="none",w.id=xr(f)?"qr-canvas":f,w},a.prototype.getShadedRegionBounds=function(s,c,f){if(f.width>s||f.height>c)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(s-f.width)/2,y:(c-f.height)/2,width:f.width,height:f.height}},a.prototype.possiblyInsertShadingElement=function(s,c,f,h){if(!(c-h.width<1||f-h.height<1)){var d=document.createElement("div");d.style.position="absolute";var w=(c-h.width)/2,x=(f-h.height)/2;if(d.style.borderLeft=w+"px solid #0000007a",d.style.borderRight=w+"px solid #0000007a",d.style.borderTop=x+"px solid #0000007a",d.style.borderBottom=x+"px solid #0000007a",d.style.boxSizing="border-box",d.style.top="0px",d.style.bottom="0px",d.style.left="0px",d.style.right="0px",d.id=""+nn.SHADED_REGION_ELEMENT_ID,c-h.width<11||f-h.height<11)this.hasBorderShaders=!1;else{var m=5,C=40;this.insertShaderBorders(d,C,m,-m,0,!0),this.insertShaderBorders(d,C,m,-m,0,!1),this.insertShaderBorders(d,C,m,h.height+m,0,!0),this.insertShaderBorders(d,C,m,h.height+m,0,!1),this.insertShaderBorders(d,m,C+m,-m,-m,!0),this.insertShaderBorders(d,m,C+m,h.height+m-C,-m,!0),this.insertShaderBorders(d,m,C+m,-m,-m,!1),this.insertShaderBorders(d,m,C+m,h.height+m-C,-m,!1),this.hasBorderShaders=!0}s.append(d)}},a.prototype.insertShaderBorders=function(s,c,f,h,d,w){var x=document.createElement("div");x.style.position="absolute",x.style.backgroundColor=nn.BORDER_SHADER_DEFAULT_COLOR,x.style.width=c+"px",x.style.height=f+"px",x.style.top=h+"px",w?x.style.left=d+"px":x.style.right=d+"px",this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(x),s.appendChild(x)},a.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},a.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},a.prototype.getTimeoutFps=function(s){return 1e3/s},a}(),ys;(function(a){a[a.STATUS_DEFAULT=0]="STATUS_DEFAULT",a[a.STATUS_SUCCESS=1]="STATUS_SUCCESS",a[a.STATUS_WARNING=2]="STATUS_WARNING",a[a.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(ys||(ys={}));function t1(a){let s,c,f,h,d,w,x,m,C,_,B,v;return{c(){s=G("main"),c=G("textarea"),f=le(),h=G("input"),d=le(),w=G("div"),w.innerHTML='<div id="reader"></div>',x=le(),m=G("span"),C=le(),_=G("button"),_.textContent="DONE",D(c,"class","mt-6 w-11/12 h-16"),c.readOnly=!0,c.value=a[0],D(h,"placeholder","title"),D(h,"class","row-start-2 w-11/12 h-full rounded-xl"),D(w,"class","w-64 h-64"),D(m,"id","error"),D(_,"class","w-full h-full bg-bitcoin"),D(s,"class","grid items-center justify-items-center h-full w-full")},m(P,M){ie(P,s,M),R(s,c),R(s,f),R(s,h),Ze(h,a[1]),R(s,d),R(s,w),R(s,x),R(s,m),R(s,C),R(s,_),B||(v=[Te(h,"input",a[4]),Te(_,"click",a[2])],B=!0)},p(P,[M]){M&1&&(c.value=P[0]),M&2&&h.value!==P[1]&&Ze(h,P[1])},i:_e,o:_e,d(P){P&&re(s),B=!1,Pt(v)}}}function n1(a,s,c){let{params:f={save:""}}=s,h,d="",w="",x=()=>{};er(()=>{x=async()=>{c(0,d=""),h=new e1("reader");const F=async z=>{c(0,d=z)},W={fps:30,qrbox:{width:200,height:200}};h.start({facingMode:"environment"},W,F)},x()});const m=F=>F.split("://")[1]?F.split("://")[0]+"://":"",C=F=>F.split("://")[1]?F.split("://")[1]:F,_=F=>(F=F.toLowerCase(),F.indexOf(":")!==-1&&(F=F.split(":")[1]),F.slice(0,6)==="lnurl1"),B=F=>{if(F.split("@").length!==2)return!1;const W=F.split("@");return!!W[0].trim()&&!!W[1].trim()},v=F=>_(F)?"lnurl":B(F)?"lnAddress":"unknown",P=async()=>{if(await h.stop(),h=null,f.save==="decoder")if(d){document.location.href=`/#/lnurl/${d}`;return}else{window.history.back();return}else if(f.save==="shorter")if(d){document.location.href=`/#/shorter/${d}`;return}else{window.history.back();return}d?(localStorage.setItem(`lnrecord${encodeURIComponent(C(d))}`,C(d)),localStorage.setItem(`info${encodeURIComponent(C(d))}`,JSON.stringify({title:w||C(d),prefix:m(d),type:v(C(d))})),document.location.href=`/#/manage/${encodeURIComponent(encodeURIComponent(C(d)))}`):document.location.href="/#/home"};function M(){w=this.value,c(1,w)}return a.$$set=F=>{"params"in F&&c(3,f=F.params)},[d,w,P,f,M]}class r1 extends _t{constructor(s){super(),It(this,s,n1,t1,Et,{params:3})}}var tr={},i1=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},zs={},qt={};let Pi;const s1=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];qt.getSymbolSize=function(s){if(!s)throw new Error('"version" cannot be null or undefined');if(s<1||s>40)throw new Error('"version" should be in range from 1 to 40');return s*4+17};qt.getSymbolTotalCodewords=function(s){return s1[s]};qt.getBCHDigit=function(a){let s=0;for(;a!==0;)s++,a>>>=1;return s};qt.setToSJISFunction=function(s){if(typeof s!="function")throw new Error('"toSJISFunc" is not a valid function.');Pi=s};qt.isKanjiModeEnabled=function(){return typeof Pi<"u"};qt.toSJIS=function(s){return Pi(s)};var qr={};(function(a){a.L={bit:1},a.M={bit:0},a.Q={bit:3},a.H={bit:2};function s(c){if(typeof c!="string")throw new Error("Param is not a string");switch(c.toLowerCase()){case"l":case"low":return a.L;case"m":case"medium":return a.M;case"q":case"quartile":return a.Q;case"h":case"high":return a.H;default:throw new Error("Unknown EC Level: "+c)}}a.isValid=function(f){return f&&typeof f.bit<"u"&&f.bit>=0&&f.bit<4},a.from=function(f,h){if(a.isValid(f))return f;try{return s(f)}catch{return h}}})(qr);function js(){this.buffer=[],this.length=0}js.prototype={get:function(a){const s=Math.floor(a/8);return(this.buffer[s]>>>7-a%8&1)===1},put:function(a,s){for(let c=0;c<s;c++)this.putBit((a>>>s-c-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(a){const s=Math.floor(this.length/8);this.buffer.length<=s&&this.buffer.push(0),a&&(this.buffer[s]|=128>>>this.length%8),this.length++}};var o1=js;function Sr(a){if(!a||a<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=a,this.data=new Uint8Array(a*a),this.reservedBit=new Uint8Array(a*a)}Sr.prototype.set=function(a,s,c,f){const h=a*this.size+s;this.data[h]=c,f&&(this.reservedBit[h]=!0)};Sr.prototype.get=function(a,s){return this.data[a*this.size+s]};Sr.prototype.xor=function(a,s,c){this.data[a*this.size+s]^=c};Sr.prototype.isReserved=function(a,s){return this.reservedBit[a*this.size+s]};var l1=Sr,Zs={};(function(a){const s=qt.getSymbolSize;a.getRowColCoords=function(f){if(f===1)return[];const h=Math.floor(f/7)+2,d=s(f),w=d===145?26:Math.ceil((d-13)/(2*h-2))*2,x=[d-7];for(let m=1;m<h-1;m++)x[m]=x[m-1]-w;return x.push(6),x.reverse()},a.getPositions=function(f){const h=[],d=a.getRowColCoords(f),w=d.length;for(let x=0;x<w;x++)for(let m=0;m<w;m++)x===0&&m===0||x===0&&m===w-1||x===w-1&&m===0||h.push([d[x],d[m]]);return h}})(Zs);var Ks={};const a1=qt.getSymbolSize,Ss=7;Ks.getPositions=function(s){const c=a1(s);return[[0,0],[c-Ss,0],[0,c-Ss]]};var qs={};(function(a){a.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const s={N1:3,N2:3,N3:40,N4:10};a.isValid=function(h){return h!=null&&h!==""&&!isNaN(h)&&h>=0&&h<=7},a.from=function(h){return a.isValid(h)?parseInt(h,10):void 0},a.getPenaltyN1=function(h){const d=h.size;let w=0,x=0,m=0,C=null,_=null;for(let B=0;B<d;B++){x=m=0,C=_=null;for(let v=0;v<d;v++){let P=h.get(B,v);P===C?x++:(x>=5&&(w+=s.N1+(x-5)),C=P,x=1),P=h.get(v,B),P===_?m++:(m>=5&&(w+=s.N1+(m-5)),_=P,m=1)}x>=5&&(w+=s.N1+(x-5)),m>=5&&(w+=s.N1+(m-5))}return w},a.getPenaltyN2=function(h){const d=h.size;let w=0;for(let x=0;x<d-1;x++)for(let m=0;m<d-1;m++){const C=h.get(x,m)+h.get(x,m+1)+h.get(x+1,m)+h.get(x+1,m+1);(C===4||C===0)&&w++}return w*s.N2},a.getPenaltyN3=function(h){const d=h.size;let w=0,x=0,m=0;for(let C=0;C<d;C++){x=m=0;for(let _=0;_<d;_++)x=x<<1&2047|h.get(C,_),_>=10&&(x===1488||x===93)&&w++,m=m<<1&2047|h.get(_,C),_>=10&&(m===1488||m===93)&&w++}return w*s.N3},a.getPenaltyN4=function(h){let d=0;const w=h.data.length;for(let m=0;m<w;m++)d+=h.data[m];return Math.abs(Math.ceil(d*100/w/5)-10)*s.N4};function c(f,h,d){switch(f){case a.Patterns.PATTERN000:return(h+d)%2===0;case a.Patterns.PATTERN001:return h%2===0;case a.Patterns.PATTERN010:return d%3===0;case a.Patterns.PATTERN011:return(h+d)%3===0;case a.Patterns.PATTERN100:return(Math.floor(h/2)+Math.floor(d/3))%2===0;case a.Patterns.PATTERN101:return h*d%2+h*d%3===0;case a.Patterns.PATTERN110:return(h*d%2+h*d%3)%2===0;case a.Patterns.PATTERN111:return(h*d%3+(h+d)%2)%2===0;default:throw new Error("bad maskPattern:"+f)}}a.applyMask=function(h,d){const w=d.size;for(let x=0;x<w;x++)for(let m=0;m<w;m++)d.isReserved(m,x)||d.xor(m,x,c(h,m,x))},a.getBestMask=function(h,d){const w=Object.keys(a.Patterns).length;let x=0,m=1/0;for(let C=0;C<w;C++){d(C),a.applyMask(C,h);const _=a.getPenaltyN1(h)+a.getPenaltyN2(h)+a.getPenaltyN3(h)+a.getPenaltyN4(h);a.applyMask(C,h),_<m&&(m=_,x=C)}return x}})(qs);var Qr={};const _n=qr,Ur=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Vr=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Qr.getBlocksCount=function(s,c){switch(c){case _n.L:return Ur[(s-1)*4+0];case _n.M:return Ur[(s-1)*4+1];case _n.Q:return Ur[(s-1)*4+2];case _n.H:return Ur[(s-1)*4+3];default:return}};Qr.getTotalCodewordsCount=function(s,c){switch(c){case _n.L:return Vr[(s-1)*4+0];case _n.M:return Vr[(s-1)*4+1];case _n.Q:return Vr[(s-1)*4+2];case _n.H:return Vr[(s-1)*4+3];default:return}};var Qs={},$r={};const wr=new Uint8Array(512),zr=new Uint8Array(256);(function(){let s=1;for(let c=0;c<255;c++)wr[c]=s,zr[s]=c,s<<=1,s&256&&(s^=285);for(let c=255;c<512;c++)wr[c]=wr[c-255]})();$r.log=function(s){if(s<1)throw new Error("log("+s+")");return zr[s]};$r.exp=function(s){return wr[s]};$r.mul=function(s,c){return s===0||c===0?0:wr[zr[s]+zr[c]]};(function(a){const s=$r;a.mul=function(f,h){const d=new Uint8Array(f.length+h.length-1);for(let w=0;w<f.length;w++)for(let x=0;x<h.length;x++)d[w+x]^=s.mul(f[w],h[x]);return d},a.mod=function(f,h){let d=new Uint8Array(f);for(;d.length-h.length>=0;){const w=d[0];for(let m=0;m<h.length;m++)d[m]^=s.mul(h[m],w);let x=0;for(;x<d.length&&d[x]===0;)x++;d=d.slice(x)}return d},a.generateECPolynomial=function(f){let h=new Uint8Array([1]);for(let d=0;d<f;d++)h=a.mul(h,new Uint8Array([1,s.exp(d)]));return h}})(Qs);const $s=Qs;function Fi(a){this.genPoly=void 0,this.degree=a,this.degree&&this.initialize(this.degree)}Fi.prototype.initialize=function(s){this.degree=s,this.genPoly=$s.generateECPolynomial(this.degree)};Fi.prototype.encode=function(s){if(!this.genPoly)throw new Error("Encoder not initialized");const c=new Uint8Array(s.length+this.degree);c.set(s);const f=$s.mod(c,this.genPoly),h=this.degree-f.length;if(h>0){const d=new Uint8Array(this.degree);return d.set(f,h),d}return f};var c1=Fi,Js={},yn={},Ui={};Ui.isValid=function(s){return!isNaN(s)&&s>=1&&s<=40};var gn={};const eo="[0-9]+",u1="[A-Z $%*+\\-./:]+";let Cr="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Cr=Cr.replace(/u/g,"\\u");const f1="(?:(?![A-Z0-9 $%*+\\-./:]|"+Cr+`)(?:.|[\r
]))+`;gn.KANJI=new RegExp(Cr,"g");gn.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");gn.BYTE=new RegExp(f1,"g");gn.NUMERIC=new RegExp(eo,"g");gn.ALPHANUMERIC=new RegExp(u1,"g");const h1=new RegExp("^"+Cr+"$"),d1=new RegExp("^"+eo+"$"),g1=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");gn.testKanji=function(s){return h1.test(s)};gn.testNumeric=function(s){return d1.test(s)};gn.testAlphanumeric=function(s){return g1.test(s)};(function(a){const s=Ui,c=gn;a.NUMERIC={id:"Numeric",bit:1<<0,ccBits:[10,12,14]},a.ALPHANUMERIC={id:"Alphanumeric",bit:1<<1,ccBits:[9,11,13]},a.BYTE={id:"Byte",bit:1<<2,ccBits:[8,16,16]},a.KANJI={id:"Kanji",bit:1<<3,ccBits:[8,10,12]},a.MIXED={bit:-1},a.getCharCountIndicator=function(d,w){if(!d.ccBits)throw new Error("Invalid mode: "+d);if(!s.isValid(w))throw new Error("Invalid version: "+w);return w>=1&&w<10?d.ccBits[0]:w<27?d.ccBits[1]:d.ccBits[2]},a.getBestModeForData=function(d){return c.testNumeric(d)?a.NUMERIC:c.testAlphanumeric(d)?a.ALPHANUMERIC:c.testKanji(d)?a.KANJI:a.BYTE},a.toString=function(d){if(d&&d.id)return d.id;throw new Error("Invalid mode")},a.isValid=function(d){return d&&d.bit&&d.ccBits};function f(h){if(typeof h!="string")throw new Error("Param is not a string");switch(h.toLowerCase()){case"numeric":return a.NUMERIC;case"alphanumeric":return a.ALPHANUMERIC;case"kanji":return a.KANJI;case"byte":return a.BYTE;default:throw new Error("Unknown mode: "+h)}}a.from=function(d,w){if(a.isValid(d))return d;try{return f(d)}catch{return w}}})(yn);(function(a){const s=qt,c=Qr,f=qr,h=yn,d=Ui,w=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,x=s.getBCHDigit(w);function m(v,P,M){for(let F=1;F<=40;F++)if(P<=a.getCapacity(F,M,v))return F}function C(v,P){return h.getCharCountIndicator(v,P)+4}function _(v,P){let M=0;return v.forEach(function(F){M+=C(F.mode,P)+F.getBitsLength()}),M}function B(v,P){for(let M=1;M<=40;M++)if(_(v,M)<=a.getCapacity(M,P,h.MIXED))return M}a.from=function(P,M){return d.isValid(P)?parseInt(P,10):M},a.getCapacity=function(P,M,F){if(!d.isValid(P))throw new Error("Invalid QR Code version");typeof F>"u"&&(F=h.BYTE);const W=s.getSymbolTotalCodewords(P),z=c.getTotalCodewordsCount(P,M),J=(W-z)*8;if(F===h.MIXED)return J;const Y=J-C(F,P);switch(F){case h.NUMERIC:return Math.floor(Y/10*3);case h.ALPHANUMERIC:return Math.floor(Y/11*2);case h.KANJI:return Math.floor(Y/13);case h.BYTE:default:return Math.floor(Y/8)}},a.getBestVersionForData=function(P,M){let F;const W=f.from(M,f.M);if(Array.isArray(P)){if(P.length>1)return B(P,W);if(P.length===0)return 1;F=P[0]}else F=P;return m(F.mode,F.getLength(),W)},a.getEncodedBits=function(P){if(!d.isValid(P)||P<7)throw new Error("Invalid QR Code version");let M=P<<12;for(;s.getBCHDigit(M)-x>=0;)M^=w<<s.getBCHDigit(M)-x;return P<<12|M}})(Js);var to={};const Ni=qt,no=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,x1=1<<14|1<<12|1<<10|1<<4|1<<1,Ts=Ni.getBCHDigit(no);to.getEncodedBits=function(s,c){const f=s.bit<<3|c;let h=f<<10;for(;Ni.getBCHDigit(h)-Ts>=0;)h^=no<<Ni.getBCHDigit(h)-Ts;return(f<<10|h)^x1};var ro={};const w1=yn;function qn(a){this.mode=w1.NUMERIC,this.data=a.toString()}qn.getBitsLength=function(s){return 10*Math.floor(s/3)+(s%3?s%3*3+1:0)};qn.prototype.getLength=function(){return this.data.length};qn.prototype.getBitsLength=function(){return qn.getBitsLength(this.data.length)};qn.prototype.write=function(s){let c,f,h;for(c=0;c+3<=this.data.length;c+=3)f=this.data.substr(c,3),h=parseInt(f,10),s.put(h,10);const d=this.data.length-c;d>0&&(f=this.data.substr(c),h=parseInt(f,10),s.put(h,d*3+1))};var p1=qn;const m1=yn,Ai=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Qn(a){this.mode=m1.ALPHANUMERIC,this.data=a}Qn.getBitsLength=function(s){return 11*Math.floor(s/2)+6*(s%2)};Qn.prototype.getLength=function(){return this.data.length};Qn.prototype.getBitsLength=function(){return Qn.getBitsLength(this.data.length)};Qn.prototype.write=function(s){let c;for(c=0;c+2<=this.data.length;c+=2){let f=Ai.indexOf(this.data[c])*45;f+=Ai.indexOf(this.data[c+1]),s.put(f,11)}this.data.length%2&&s.put(Ai.indexOf(this.data[c]),6)};var E1=Qn,A1=function(s){for(var c=[],f=s.length,h=0;h<f;h++){var d=s.charCodeAt(h);if(d>=55296&&d<=56319&&f>h+1){var w=s.charCodeAt(h+1);w>=56320&&w<=57343&&(d=(d-55296)*1024+w-56320+65536,h+=1)}if(d<128){c.push(d);continue}if(d<2048){c.push(d>>6|192),c.push(d&63|128);continue}if(d<55296||d>=57344&&d<65536){c.push(d>>12|224),c.push(d>>6&63|128),c.push(d&63|128);continue}if(d>=65536&&d<=1114111){c.push(d>>18|240),c.push(d>>12&63|128),c.push(d>>6&63|128),c.push(d&63|128);continue}c.push(239,191,189)}return new Uint8Array(c).buffer};const C1=A1,b1=yn;function $n(a){this.mode=b1.BYTE,typeof a=="string"&&(a=C1(a)),this.data=new Uint8Array(a)}$n.getBitsLength=function(s){return s*8};$n.prototype.getLength=function(){return this.data.length};$n.prototype.getBitsLength=function(){return $n.getBitsLength(this.data.length)};$n.prototype.write=function(a){for(let s=0,c=this.data.length;s<c;s++)a.put(this.data[s],8)};var I1=$n;const _1=yn,y1=qt;function Jn(a){this.mode=_1.KANJI,this.data=a}Jn.getBitsLength=function(s){return s*13};Jn.prototype.getLength=function(){return this.data.length};Jn.prototype.getBitsLength=function(){return Jn.getBitsLength(this.data.length)};Jn.prototype.write=function(a){let s;for(s=0;s<this.data.length;s++){let c=y1.toSJIS(this.data[s]);if(c>=33088&&c<=40956)c-=33088;else if(c>=57408&&c<=60351)c-=49472;else throw new Error("Invalid SJIS character: "+this.data[s]+`
Make sure your charset is UTF-8`);c=(c>>>8&255)*192+(c&255),a.put(c,13)}};var S1=Jn,io={exports:{}};(function(a){var s={single_source_shortest_paths:function(c,f,h){var d={},w={};w[f]=0;var x=s.PriorityQueue.make();x.push(f,0);for(var m,C,_,B,v,P,M,F,W;!x.empty();){m=x.pop(),C=m.value,B=m.cost,v=c[C]||{};for(_ in v)v.hasOwnProperty(_)&&(P=v[_],M=B+P,F=w[_],W=typeof w[_]>"u",(W||F>M)&&(w[_]=M,x.push(_,M),d[_]=C))}if(typeof h<"u"&&typeof w[h]>"u"){var z=["Could not find a path from ",f," to ",h,"."].join("");throw new Error(z)}return d},extract_shortest_path_from_predecessor_list:function(c,f){for(var h=[],d=f;d;)h.push(d),c[d],d=c[d];return h.reverse(),h},find_path:function(c,f,h){var d=s.single_source_shortest_paths(c,f,h);return s.extract_shortest_path_from_predecessor_list(d,h)},PriorityQueue:{make:function(c){var f=s.PriorityQueue,h={},d;c=c||{};for(d in f)f.hasOwnProperty(d)&&(h[d]=f[d]);return h.queue=[],h.sorter=c.sorter||f.default_sorter,h},default_sorter:function(c,f){return c.cost-f.cost},push:function(c,f){var h={value:c,cost:f};this.queue.push(h),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};a.exports=s})(io);(function(a){const s=yn,c=p1,f=E1,h=I1,d=S1,w=gn,x=qt,m=io.exports;function C(z){return unescape(encodeURIComponent(z)).length}function _(z,J,Y){const Q=[];let $;for(;($=z.exec(Y))!==null;)Q.push({data:$[0],index:$.index,mode:J,length:$[0].length});return Q}function B(z){const J=_(w.NUMERIC,s.NUMERIC,z),Y=_(w.ALPHANUMERIC,s.ALPHANUMERIC,z);let Q,$;return x.isKanjiModeEnabled()?(Q=_(w.BYTE,s.BYTE,z),$=_(w.KANJI,s.KANJI,z)):(Q=_(w.BYTE_KANJI,s.BYTE,z),$=[]),J.concat(Y,Q,$).sort(function(se,k){return se.index-k.index}).map(function(se){return{data:se.data,mode:se.mode,length:se.length}})}function v(z,J){switch(J){case s.NUMERIC:return c.getBitsLength(z);case s.ALPHANUMERIC:return f.getBitsLength(z);case s.KANJI:return d.getBitsLength(z);case s.BYTE:return h.getBitsLength(z)}}function P(z){return z.reduce(function(J,Y){const Q=J.length-1>=0?J[J.length-1]:null;return Q&&Q.mode===Y.mode?(J[J.length-1].data+=Y.data,J):(J.push(Y),J)},[])}function M(z){const J=[];for(let Y=0;Y<z.length;Y++){const Q=z[Y];switch(Q.mode){case s.NUMERIC:J.push([Q,{data:Q.data,mode:s.ALPHANUMERIC,length:Q.length},{data:Q.data,mode:s.BYTE,length:Q.length}]);break;case s.ALPHANUMERIC:J.push([Q,{data:Q.data,mode:s.BYTE,length:Q.length}]);break;case s.KANJI:J.push([Q,{data:Q.data,mode:s.BYTE,length:C(Q.data)}]);break;case s.BYTE:J.push([{data:Q.data,mode:s.BYTE,length:C(Q.data)}])}}return J}function F(z,J){const Y={},Q={start:{}};let $=["start"];for(let U=0;U<z.length;U++){const se=z[U],k=[];for(let xe=0;xe<se.length;xe++){const pe=se[xe],ae=""+U+xe;k.push(ae),Y[ae]={node:pe,lastCount:0},Q[ae]={};for(let ne=0;ne<$.length;ne++){const Ae=$[ne];Y[Ae]&&Y[Ae].node.mode===pe.mode?(Q[Ae][ae]=v(Y[Ae].lastCount+pe.length,pe.mode)-v(Y[Ae].lastCount,pe.mode),Y[Ae].lastCount+=pe.length):(Y[Ae]&&(Y[Ae].lastCount=pe.length),Q[Ae][ae]=v(pe.length,pe.mode)+4+s.getCharCountIndicator(pe.mode,J))}}$=k}for(let U=0;U<$.length;U++)Q[$[U]].end=0;return{map:Q,table:Y}}function W(z,J){let Y;const Q=s.getBestModeForData(z);if(Y=s.from(J,Q),Y!==s.BYTE&&Y.bit<Q.bit)throw new Error('"'+z+'" cannot be encoded with mode '+s.toString(Y)+`.
 Suggested mode is: `+s.toString(Q));switch(Y===s.KANJI&&!x.isKanjiModeEnabled()&&(Y=s.BYTE),Y){case s.NUMERIC:return new c(z);case s.ALPHANUMERIC:return new f(z);case s.KANJI:return new d(z);case s.BYTE:return new h(z)}}a.fromArray=function(J){return J.reduce(function(Y,Q){return typeof Q=="string"?Y.push(W(Q,null)):Q.data&&Y.push(W(Q.data,Q.mode)),Y},[])},a.fromString=function(J,Y){const Q=B(J,x.isKanjiModeEnabled()),$=M(Q),U=F($,Y),se=m.find_path(U.map,"start","end"),k=[];for(let xe=1;xe<se.length-1;xe++)k.push(U.table[se[xe]].node);return a.fromArray(P(k))},a.rawSplit=function(J){return a.fromArray(B(J,x.isKanjiModeEnabled()))}})(ro);const Jr=qt,Ci=qr,T1=o1,N1=l1,R1=Zs,O1=Ks,Ri=qs,Oi=Qr,B1=c1,jr=Js,M1=to,D1=yn,bi=ro;function v1(a,s){const c=a.size,f=O1.getPositions(s);for(let h=0;h<f.length;h++){const d=f[h][0],w=f[h][1];for(let x=-1;x<=7;x++)if(!(d+x<=-1||c<=d+x))for(let m=-1;m<=7;m++)w+m<=-1||c<=w+m||(x>=0&&x<=6&&(m===0||m===6)||m>=0&&m<=6&&(x===0||x===6)||x>=2&&x<=4&&m>=2&&m<=4?a.set(d+x,w+m,!0,!0):a.set(d+x,w+m,!1,!0))}}function k1(a){const s=a.size;for(let c=8;c<s-8;c++){const f=c%2===0;a.set(c,6,f,!0),a.set(6,c,f,!0)}}function L1(a,s){const c=R1.getPositions(s);for(let f=0;f<c.length;f++){const h=c[f][0],d=c[f][1];for(let w=-2;w<=2;w++)for(let x=-2;x<=2;x++)w===-2||w===2||x===-2||x===2||w===0&&x===0?a.set(h+w,d+x,!0,!0):a.set(h+w,d+x,!1,!0)}}function P1(a,s){const c=a.size,f=jr.getEncodedBits(s);let h,d,w;for(let x=0;x<18;x++)h=Math.floor(x/3),d=x%3+c-8-3,w=(f>>x&1)===1,a.set(h,d,w,!0),a.set(d,h,w,!0)}function Ii(a,s,c){const f=a.size,h=M1.getEncodedBits(s,c);let d,w;for(d=0;d<15;d++)w=(h>>d&1)===1,d<6?a.set(d,8,w,!0):d<8?a.set(d+1,8,w,!0):a.set(f-15+d,8,w,!0),d<8?a.set(8,f-d-1,w,!0):d<9?a.set(8,15-d-1+1,w,!0):a.set(8,15-d-1,w,!0);a.set(f-8,8,1,!0)}function F1(a,s){const c=a.size;let f=-1,h=c-1,d=7,w=0;for(let x=c-1;x>0;x-=2)for(x===6&&x--;;){for(let m=0;m<2;m++)if(!a.isReserved(h,x-m)){let C=!1;w<s.length&&(C=(s[w]>>>d&1)===1),a.set(h,x-m,C),d--,d===-1&&(w++,d=7)}if(h+=f,h<0||c<=h){h-=f,f=-f;break}}}function U1(a,s,c){const f=new T1;c.forEach(function(m){f.put(m.mode.bit,4),f.put(m.getLength(),D1.getCharCountIndicator(m.mode,a)),m.write(f)});const h=Jr.getSymbolTotalCodewords(a),d=Oi.getTotalCodewordsCount(a,s),w=(h-d)*8;for(f.getLengthInBits()+4<=w&&f.put(0,4);f.getLengthInBits()%8!==0;)f.putBit(0);const x=(w-f.getLengthInBits())/8;for(let m=0;m<x;m++)f.put(m%2?17:236,8);return V1(f,a,s)}function V1(a,s,c){const f=Jr.getSymbolTotalCodewords(s),h=Oi.getTotalCodewordsCount(s,c),d=f-h,w=Oi.getBlocksCount(s,c),x=f%w,m=w-x,C=Math.floor(f/w),_=Math.floor(d/w),B=_+1,v=C-_,P=new B1(v);let M=0;const F=new Array(w),W=new Array(w);let z=0;const J=new Uint8Array(a.buffer);for(let se=0;se<w;se++){const k=se<m?_:B;F[se]=J.slice(M,M+k),W[se]=P.encode(F[se]),M+=k,z=Math.max(z,k)}const Y=new Uint8Array(f);let Q=0,$,U;for($=0;$<z;$++)for(U=0;U<w;U++)$<F[U].length&&(Y[Q++]=F[U][$]);for($=0;$<v;$++)for(U=0;U<w;U++)Y[Q++]=W[U][$];return Y}function H1(a,s,c,f){let h;if(Array.isArray(a))h=bi.fromArray(a);else if(typeof a=="string"){let C=s;if(!C){const _=bi.rawSplit(a);C=jr.getBestVersionForData(_,c)}h=bi.fromString(a,C||40)}else throw new Error("Invalid data");const d=jr.getBestVersionForData(h,c);if(!d)throw new Error("The amount of data is too big to be stored in a QR Code");if(!s)s=d;else if(s<d)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+d+`.
`);const w=U1(s,c,h),x=Jr.getSymbolSize(s),m=new N1(x);return v1(m,s),k1(m),L1(m,s),Ii(m,c,0),s>=7&&P1(m,s),F1(m,w),isNaN(f)&&(f=Ri.getBestMask(m,Ii.bind(null,m,c))),Ri.applyMask(f,m),Ii(m,c,f),{modules:m,version:s,errorCorrectionLevel:c,maskPattern:f,segments:h}}zs.create=function(s,c){if(typeof s>"u"||s==="")throw new Error("No input text");let f=Ci.M,h,d;return typeof c<"u"&&(f=Ci.from(c.errorCorrectionLevel,Ci.M),h=jr.from(c.version),d=Ri.from(c.maskPattern),c.toSJISFunc&&Jr.setToSJISFunction(c.toSJISFunc)),H1(s,h,f,d)};var so={},Vi={};(function(a){function s(c){if(typeof c=="number"&&(c=c.toString()),typeof c!="string")throw new Error("Color should be defined as hex string");let f=c.slice().replace("#","").split("");if(f.length<3||f.length===5||f.length>8)throw new Error("Invalid hex color: "+c);(f.length===3||f.length===4)&&(f=Array.prototype.concat.apply([],f.map(function(d){return[d,d]}))),f.length===6&&f.push("F","F");const h=parseInt(f.join(""),16);return{r:h>>24&255,g:h>>16&255,b:h>>8&255,a:h&255,hex:"#"+f.slice(0,6).join("")}}a.getOptions=function(f){f||(f={}),f.color||(f.color={});const h=typeof f.margin>"u"||f.margin===null||f.margin<0?4:f.margin,d=f.width&&f.width>=21?f.width:void 0,w=f.scale||4;return{width:d,scale:d?4:w,margin:h,color:{dark:s(f.color.dark||"#000000ff"),light:s(f.color.light||"#ffffffff")},type:f.type,rendererOpts:f.rendererOpts||{}}},a.getScale=function(f,h){return h.width&&h.width>=f+h.margin*2?h.width/(f+h.margin*2):h.scale},a.getImageWidth=function(f,h){const d=a.getScale(f,h);return Math.floor((f+h.margin*2)*d)},a.qrToImageData=function(f,h,d){const w=h.modules.size,x=h.modules.data,m=a.getScale(w,d),C=Math.floor((w+d.margin*2)*m),_=d.margin*m,B=[d.color.light,d.color.dark];for(let v=0;v<C;v++)for(let P=0;P<C;P++){let M=(v*C+P)*4,F=d.color.light;if(v>=_&&P>=_&&v<C-_&&P<C-_){const W=Math.floor((v-_)/m),z=Math.floor((P-_)/m);F=B[x[W*w+z]?1:0]}f[M++]=F.r,f[M++]=F.g,f[M++]=F.b,f[M]=F.a}}})(Vi);(function(a){const s=Vi;function c(h,d,w){h.clearRect(0,0,d.width,d.height),d.style||(d.style={}),d.height=w,d.width=w,d.style.height=w+"px",d.style.width=w+"px"}function f(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}a.render=function(d,w,x){let m=x,C=w;typeof m>"u"&&(!w||!w.getContext)&&(m=w,w=void 0),w||(C=f()),m=s.getOptions(m);const _=s.getImageWidth(d.modules.size,m),B=C.getContext("2d"),v=B.createImageData(_,_);return s.qrToImageData(v.data,d,m),c(B,C,_),B.putImageData(v,0,0),C},a.renderToDataURL=function(d,w,x){let m=x;typeof m>"u"&&(!w||!w.getContext)&&(m=w,w=void 0),m||(m={});const C=a.render(d,w,m),_=m.type||"image/png",B=m.rendererOpts||{};return C.toDataURL(_,B.quality)}})(so);var oo={};const G1=Vi;function Ns(a,s){const c=a.a/255,f=s+'="'+a.hex+'"';return c<1?f+" "+s+'-opacity="'+c.toFixed(2).slice(1)+'"':f}function _i(a,s,c){let f=a+s;return typeof c<"u"&&(f+=" "+c),f}function X1(a,s,c){let f="",h=0,d=!1,w=0;for(let x=0;x<a.length;x++){const m=Math.floor(x%s),C=Math.floor(x/s);!m&&!d&&(d=!0),a[x]?(w++,x>0&&m>0&&a[x-1]||(f+=d?_i("M",m+c,.5+C+c):_i("m",h,0),h=0,d=!1),m+1<s&&a[x+1]||(f+=_i("h",w),w=0)):h++}return f}oo.render=function(s,c,f){const h=G1.getOptions(c),d=s.modules.size,w=s.modules.data,x=d+h.margin*2,m=h.color.light.a?"<path "+Ns(h.color.light,"fill")+' d="M0 0h'+x+"v"+x+'H0z"/>':"",C="<path "+Ns(h.color.dark,"stroke")+' d="'+X1(w,d,h.margin)+'"/>',_='viewBox="0 0 '+x+" "+x+'"',B=h.width?'width="'+h.width+'" height="'+h.width+'" ':"",v='<svg xmlns="http://www.w3.org/2000/svg" '+B+_+' shape-rendering="crispEdges">'+m+C+`</svg>
`;return typeof f=="function"&&f(null,v),v};const W1=i1,Bi=zs,lo=so,Y1=oo;function Hi(a,s,c,f,h){const d=[].slice.call(arguments,1),w=d.length,x=typeof d[w-1]=="function";if(!x&&!W1())throw new Error("Callback required as last argument");if(x){if(w<2)throw new Error("Too few arguments provided");w===2?(h=c,c=s,s=f=void 0):w===3&&(s.getContext&&typeof h>"u"?(h=f,f=void 0):(h=f,f=c,c=s,s=void 0))}else{if(w<1)throw new Error("Too few arguments provided");return w===1?(c=s,s=f=void 0):w===2&&!s.getContext&&(f=c,c=s,s=void 0),new Promise(function(m,C){try{const _=Bi.create(c,f);m(a(_,s,f))}catch(_){C(_)}})}try{const m=Bi.create(c,f);h(null,a(m,s,f))}catch(m){h(m)}}tr.create=Bi.create;tr.toCanvas=Hi.bind(null,lo.render);tr.toDataURL=Hi.bind(null,lo.renderToDataURL);tr.toString=Hi.bind(null,function(a,s,c){return Y1.render(a,c)});function z1(a){let s,c,f,h,d,w,x,m,C;return{c(){s=G("main"),c=G("textarea"),h=le(),d=G("canvas"),w=le(),x=G("button"),x.textContent="DONE",D(c,"class","row-start-2 w-11/12 h-full"),c.readOnly=!0,c.value=f=decodeURIComponent(a[0].record),D(d,"id","canvas"),D(d,"class","row-start-4"),D(x,"class","row-start-8 w-full h-full bg-bitcoin"),D(s,"class","grid grid-rows-8 justify-items-center items-center")},m(_,B){ie(_,s,B),R(s,c),R(s,h),R(s,d),R(s,w),R(s,x),m||(C=Te(x,"click",a[1]),m=!0)},p(_,[B]){B&1&&f!==(f=decodeURIComponent(_[0].record))&&(c.value=f)},i:_e,o:_e,d(_){_&&re(s),m=!1,C()}}}function j1(a,s,c){let{params:f={}}=s;er(()=>{tr.toCanvas(document.getElementById("canvas"),decodeURIComponent(f.record),{width:250,errorCorrectionLevel:"H"},d=>{d&&console.error(d)})});const h=()=>window.history.back();return a.$$set=d=>{"params"in d&&c(0,f=d.params)},[f,h]}class Z1 extends _t{constructor(s){super(),It(this,s,j1,z1,Et,{params:0})}}function K1(a){let s;return{c(){s=G("h1"),s.textContent="NFC is not supported in your browser/device"},m(c,f){ie(c,s,f)},p:_e,i:_e,o:_e,d(c){c&&re(s)}}}function q1(a){let s,c,f,h;const d=[$1,Q1],w=[];function x(m,C){return m[3]?0:1}return s=x(a),c=w[s]=d[s](a),{c(){c.c(),f=Ft()},m(m,C){w[s].m(m,C),ie(m,f,C),h=!0},p(m,C){let _=s;s=x(m),s!==_&&(vn(),Ye(w[_],1,1,()=>{w[_]=null}),kn(),c=w[s],c||(c=w[s]=d[s](m),c.c()),He(c,1),c.m(f.parentNode,f))},i(m){h||(He(c),h=!0)},o(m){Ye(c),h=!1},d(m){w[s].d(m),m&&re(f)}}}function Q1(a){let s;return{c(){s=G("h1"),s.textContent="tap write to start",D(s,"class","row-start-4")},m(c,f){ie(c,s,f)},i:_e,o:_e,d(c){c&&re(s)}}}function $1(a){let s,c,f,h,d,w,x,m;return x=new Xs({}),{c(){s=G("div"),c=G("span"),f=le(),h=G("h1"),h.textContent="Tap NFC tag to write",d=le(),w=G("div"),Rt(x.$$.fragment),D(c,"id","error"),D(c,"class","text-red-700"),D(w,"class","w-1/4 mt-4"),D(s,"class","grid items-center justify-items-center text-center")},m(C,_){ie(C,s,_),R(s,c),R(s,f),R(s,h),R(s,d),R(s,w),Ct(x,w,null),m=!0},i(C){m||(He(x.$$.fragment,C),m=!0)},o(C){Ye(x.$$.fragment,C),m=!1},d(C){C&&re(s),bt(x)}}}function J1(a){let s,c,f,h,d,w,x,m,C,_,B,v,P,M,F;const W=[q1,K1],z=[];function J(Y,Q){return"NDEFReader"in window?0:1}return C=J(),_=z[C]=W[C](a),{c(){s=G("main"),c=G("textarea"),h=le(),d=G("input"),w=le(),x=G("button"),x.textContent="write",m=le(),_.c(),B=le(),v=G("button"),v.textContent="DONE",D(c,"class","row-start-1 w-11/12 h-24"),c.readOnly=!0,c.value=f=decodeURIComponent(a[0].record),D(d,"placeholder","prefix (lightning://)"),D(d,"class","w-11/12 h-1/2 rounded-xl"),D(x,"class","bg-bitcoin w-1/2 h-1/2 rounded-xl"),D(v,"class","row-start-6 w-full h-full bg-bitcoin"),D(s,"class","grid items-center justify-items-center w-full h-full")},m(Y,Q){ie(Y,s,Q),R(s,c),R(s,h),R(s,d),Ze(d,a[1]),R(s,w),R(s,x),R(s,m),z[C].m(s,null),R(s,B),R(s,v),P=!0,M||(F=[Te(d,"input",a[4]),Te(x,"click",function(){Zr(a[2])&&a[2].apply(this,arguments)}),Te(v,"click",a[5])],M=!0)},p(Y,[Q]){a=Y,(!P||Q&1&&f!==(f=decodeURIComponent(a[0].record)))&&(c.value=f),Q&2&&d.value!==a[1]&&Ze(d,a[1]),_.p(a,Q)},i(Y){P||(He(_),P=!0)},o(Y){Ye(_),P=!1},d(Y){Y&&re(s),z[C].d(),M=!1,Pt(F)}}}function e0(a,s,c){let{params:f={}}=s,h="";localStorage.getItem(`info${f.record}`)&&(h=JSON.parse(localStorage.getItem(`info${f.record}`)).prefix);let d=()=>{},w;er(()=>{c(2,d=async()=>{if(!w&&"NDEFReader"in window){c(3,w=new window.NDEFReader);try{h?await w.write({records:[{recordType:"url",data:`${h.replace("://","")}://${decodeURIComponent(f.record)}`}]}):await w.write(decodeURIComponent(f.record)),document.getElementById("error").innerText=""}catch(C){alert(C),c(3,w=null)}}})});function x(){h=this.value,c(1,h)}const m=()=>window.history.back();return a.$$set=C=>{"params"in C&&c(0,f=C.params)},[f,h,d,w,x,m]}class t0 extends _t{constructor(s){super(),It(this,s,e0,J1,Et,{params:0})}}function n0(a){let s,c,f,h,d,w;return{c(){s=G("main"),c=G("div"),f=le(),h=G("button"),h.textContent="DONE",D(c,"id","keys"),D(c,"class","row-start-1 row-span-11 overflow-y-scroll w-full h-full grid items-center justify-items-center"),D(h,"class","row-start-12 w-full h-full bg-bitcoin"),D(s,"class","grid grid-rows-12 h-full justify-items-center items-center")},m(x,m){ie(x,s,m),R(s,c),R(s,f),R(s,h),d||(w=Te(h,"click",a[0]),d=!0)},p:_e,i:_e,o:_e,d(x){x&&re(s),d=!1,w()}}}function r0(a){return er(()=>{Object.keys(localStorage).filter(c=>c.startsWith("user")).forEach(c=>{let f=JSON.parse(localStorage.getItem(c));document.getElementById("keys").innerHTML+=`<div class="border border-bitcoin p-4 rounded-xl w-11/12 mt-4 select-text">server: ${f.server}<br>title: ${f.title}<br>
user id: ${f.data.id}<br>
wallet id: ${f.data.wallets[0].id}<br>
invoice key: ${f.data.wallets[0].inkey}<br>
admin key: ${f.data.wallets[0].adminkey}<br>
link: <a class="text-bitcoin" href="${f.server}/wallet?usr=${f.data.id}">${f.server}/wallet?usr=${f.data.id}<a/></p>
<button class="bg-red-500 rounded-xl w-1/4 h-full" onclick="localStorage.removeItem('${c}'); location.reload()">delete</button>`})}),[()=>document.location.href="/#/home"]}class i0 extends _t{constructor(s){super(),It(this,s,r0,n0,Et,{})}}function s0(a){let s,c,f,h,d,w,x,m,C,_,B,v,P,M,F,W,z,J,Y,Q,$,U,se;return M=new Ir({props:{value:a[1]}}),{c(){s=G("main"),c=G("div"),f=G("button"),f.innerHTML='<img alt="paste" src="paste.svg"/>',h=le(),d=G("a"),d.innerHTML='<img alt="qr" src="qr.svg"/>',w=le(),x=G("a"),x.innerHTML='<img alt="nfc" src="nfc.svg"/>',m=le(),C=G("input"),_=le(),B=G("input"),v=le(),P=G("div"),Rt(M.$$.fragment),F=le(),W=G("button"),W.textContent="fetch data",z=le(),J=G("textarea"),Y=le(),Q=G("button"),Q.textContent="DONE",D(f,"class","w-6"),D(d,"href","/#/qr/decoder"),D(d,"class","w-6"),D(x,"href","/#/nfc/decoder"),D(x,"class","w-6"),D(c,"class","row-start-1 border border-bitcoin w-11/12 h-1/2 rounded-xl p-2 inline-grid grid-cols-3 gap-4 items-center justify-items-center"),D(C,"class","row-start-2 w-11/12 h-3/4 overflow-x-scroll rounded-xl border border-bitcoin p-2"),D(C,"placeholder","input ulr/lnurl/ln address"),B.readOnly=!0,D(B,"class","row-start-3 w-11/12 h-3/4 overflow-x-scroll rounded-xl border border-bitcoin p-2"),D(B,"placeholder","output"),D(P,"class","row-start-4 border border-bitcoin w-11/12 h-1/2 rounded-xl p-2"),D(W,"class","row-start-5 bg-bitcoin rounded-xl w-11/12 h-1/2"),D(J,"class","row-start-6 row-span-3 w-11/12 h-3/4"),J.value=a[2],D(Q,"class","row-start-10 w-full h-full bg-bitcoin"),D(s,"class","grid grid-rows-10 items-center justify-items-center")},m(k,xe){ie(k,s,xe),R(s,c),R(c,f),R(c,h),R(c,d),R(c,w),R(c,x),R(s,m),R(s,C),Ze(C,a[0]),R(s,_),R(s,B),Ze(B,a[1]),R(s,v),R(s,P),Ct(M,P,null),R(s,F),R(s,W),R(s,z),R(s,J),R(s,Y),R(s,Q),$=!0,U||(se=[Te(f,"click",a[5]),Te(C,"input",a[7]),Te(C,"input",a[3]),Te(B,"input",a[8]),Te(B,"input",a[3]),Te(W,"click",a[4]),Te(Q,"click",a[9])],U=!0)},p(k,[xe]){xe&1&&C.value!==k[0]&&Ze(C,k[0]),xe&2&&B.value!==k[1]&&Ze(B,k[1]);const pe={};xe&2&&(pe.value=k[1]),M.$set(pe),(!$||xe&4)&&(J.value=k[2])},i(k){$||(He(M.$$.fragment,k),$=!0)},o(k){Ye(M.$$.fragment,k),$=!1},d(k){k&&re(s),bt(M),U=!1,Pt(se)}}}function o0(a,s,c){const{Buffer:f}=_r;let{params:h={text:"",io:""}}=s,d="",w="";const x=Y=>{if(Y.split("@").length!==2)return!1;const Q=Y.split("@");return!!Q[0].trim()&&!!Q[1].trim()},m=Y=>`https://${Y.split("@")[1]}/.well-known/lnurlp/${Y.split("@")[0]}`,C=Y=>(Y=d.toLowerCase(),Y.indexOf(":")!==-1&&(Y=Y.split(":")[1]),Y.slice(0,6)==="lnurl1"),_=Y=>{Y.preventDefault(),C(d)?c(1,w=B(d)):x(d)?c(1,w=m(d)):c(1,w=v(d)),window.location.href=`/#/lnurl/o/${encodeURIComponent(w)}`},B=Y=>{let Q=Y.split(/[:=]/);Y=Q.length===2?Q[1]:Y;let $=Lt.decode(Y,1500),U=Lt.fromWords($.words);return f.from(U).toString()},v=Y=>{let Q=Lt.toWords(f.from(Y,"utf8"));return Lt.encode("lnurl",Q,1500)};let P="";const M=async()=>{c(2,P=await fetch(w).then(Y=>Y.text()))},F=async()=>{c(0,d=await navigator.clipboard.readText())};h.io==="i"?(d=h.text.split("://")[1]?h.text.split("://")[1]:h.text,C(d)?w=B(d):x(d)?w=m(d):w=v(d)):h.io==="o"&&(w=h.text.split("://")[1]?h.text.split("://")[1]:h.text,C(w)?d=B(w):x(w)?d=m(w):d=B(w));function W(){d=this.value,c(0,d)}function z(){w=this.value,c(1,w)}const J=()=>window.location.href="/#/home";return a.$$set=Y=>{"params"in Y&&c(6,h=Y.params)},[d,w,P,_,M,F,h,W,z,J]}class l0 extends _t{constructor(s){super(),It(this,s,o0,s0,Et,{params:6})}}function a0(a){let s,c,f,h,d,w,x,m,C,_,B=a[0].sats+"",v,P,M,F,W,z,J,Y,Q,$;return W=new Ir({props:{value:a[0].invoice}}),{c(){s=G("main"),c=G("h3"),c.textContent="Pay invoice to fill LNURL",f=le(),h=G("textarea"),w=le(),x=G("canvas"),m=le(),C=G("h3"),_=me("max "),v=me(B),P=me(" sats"),M=le(),F=G("div"),Rt(W.$$.fragment),z=le(),J=G("button"),J.textContent="DONE",D(c,"class","row-start-1 text-xl"),D(h,"class","row-start-2 h-full w-11/12 w-full"),h.readOnly=!0,h.value=d=decodeURIComponent(a[0].invoice),D(x,"id","canvas"),D(x,"class","row-start-4"),D(C,"class","row-start-6 text-3xl"),D(F,"class","row-start-7 bg-none border border-bitcoin rounded-xl w-11/12 h-16 mt-2 p-2 inline-flex flex-wrap gap-12 items-center justify-center"),D(J,"class","row-start-8 w-full h-full bg-bitcoin"),D(s,"class","grid grid-rows-8 justify-items-center items-center")},m(U,se){ie(U,s,se),R(s,c),R(s,f),R(s,h),R(s,w),R(s,x),R(s,m),R(s,C),R(C,_),R(C,v),R(C,P),R(s,M),R(s,F),Ct(W,F,null),R(s,z),R(s,J),Y=!0,Q||($=Te(J,"click",a[1]),Q=!0)},p(U,[se]){(!Y||se&1&&d!==(d=decodeURIComponent(U[0].invoice)))&&(h.value=d),(!Y||se&1)&&B!==(B=U[0].sats+"")&&Je(v,B);const k={};se&1&&(k.value=U[0].invoice),W.$set(k)},i(U){Y||(He(W.$$.fragment,U),Y=!0)},o(U){Ye(W.$$.fragment,U),Y=!1},d(U){U&&re(s),bt(W),Q=!1,$()}}}function c0(a,s,c){let{params:f={invoice:"",sats:"",record:""}}=s;er(()=>{tr.toCanvas(document.getElementById("canvas"),decodeURIComponent(f.invoice),{width:250,errorCorrectionLevel:"H"},d=>{d&&console.error(d)})});const h=()=>document.location.href=`/#/manage/${encodeURIComponent(f.record)}`;return a.$$set=d=>{"params"in d&&c(0,f=d.params)},[f,h]}class u0 extends _t{constructor(s){super(),It(this,s,c0,a0,Et,{params:0})}}function f0(a){let s,c,f,h,d,w,x,m,C,_,B,v,P,M,F,W,z,J,Y,Q,$,U,se,k,xe,pe;return W=new Ir({props:{value:a[1]}}),{c(){s=G("main"),c=G("div"),f=G("button"),f.innerHTML='<img alt="paste" src="paste.svg"/>',h=le(),d=G("a"),d.innerHTML='<img alt="qr" src="qr.svg"/>',w=le(),x=G("a"),x.innerHTML='<img alt="nfc" src="nfc.svg"/>',m=le(),C=G("input"),_=le(),B=G("button"),B.textContent="short it",v=le(),P=G("input"),M=le(),F=G("div"),Rt(W.$$.fragment),z=le(),J=G("div"),Y=G("a"),Q=me("save"),U=le(),se=G("button"),se.textContent="DONE",D(f,"class","w-6"),D(d,"href","/#/qr/shorter"),D(d,"class","w-6"),D(x,"href","/#/nfc/shorter"),D(x,"class","w-6"),D(c,"class","row-start-1 row-span-2 border border-bitcoin w-11/12 h-1/2 rounded-xl p-2 inline-grid grid-cols-3 gap-4 items-center justify-items-center"),D(C,"class","row-start-3 row-span-2 w-11/12 h-3/4 overflow-x-scroll rounded-xl border border-bitcoin p-2"),D(C,"placeholder","long lnurl"),D(B,"class","row-start-5 row-span-2 bg-bitcoin rounded-xl w-11/12 h-1/2"),P.readOnly=!0,D(P,"class","row-start-7 row-span-2 w-11/12 h-3/4 overflow-x-scroll rounded-xl border border-bitcoin p-2"),D(P,"placeholder","short lnurl"),D(F,"class","row-start-9 row-span-2 border border-bitcoin w-11/12 h-1/2 rounded-xl p-2"),D(Y,"href",$="/#/manual/"+a[1]+"/shortLNURL/true"),D(J,"class","inline-grid items-center w-1/2 h-1/2 bg-bitcoin rounded-xl text-center"),D(se,"class","row-start-12 w-full h-full bg-bitcoin"),D(s,"class","grid grid-rows-12 items-center justify-items-center")},m(ae,ne){ie(ae,s,ne),R(s,c),R(c,f),R(c,h),R(c,d),R(c,w),R(c,x),R(s,m),R(s,C),Ze(C,a[0]),R(s,_),R(s,B),R(s,v),R(s,P),Ze(P,a[1]),R(s,M),R(s,F),Ct(W,F,null),R(s,z),R(s,J),R(J,Y),R(Y,Q),R(s,U),R(s,se),k=!0,xe||(pe=[Te(f,"click",a[4]),Te(C,"input",a[6]),Te(C,"input",a[3]),Te(B,"click",a[2]),Te(P,"input",a[7]),Te(se,"click",a[8])],xe=!0)},p(ae,[ne]){ne&1&&C.value!==ae[0]&&Ze(C,ae[0]),ne&2&&P.value!==ae[1]&&Ze(P,ae[1]);const Ae={};ne&2&&(Ae.value=ae[1]),W.$set(Ae),(!k||ne&2&&$!==($="/#/manual/"+ae[1]+"/shortLNURL/true"))&&D(Y,"href",$)},i(ae){k||(He(W.$$.fragment,ae),k=!0)},o(ae){Ye(W.$$.fragment,ae),k=!1},d(ae){ae&&re(s),bt(W),xe=!1,Pt(pe)}}}function h0(a,s,c){const{Buffer:f}=_r;let{params:h={i:"",o:""}}=s,d="",w="";const x=F=>{let W=F.split(/[:=]/);F=W.length===2?W[1]:F;let z=Lt.decode(F,1500),J=Lt.fromWords(z.words);return f.from(J).toString()},m=F=>{let W=Lt.toWords(f.from(F,"utf8"));return Lt.encode("lnurl",W,1500)},C=async()=>{const F=await(await fetch("https://gotiny.cc/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:x(d)})})).json();c(1,w=m(`https://gotiny.cc/${F[0].code}`)),_()},_=()=>{d?window.location.href=`/#/shorter/${encodeURIComponent(d)}/${encodeURIComponent(w)}`:window.location.href="/#/shorter"},B=async()=>{c(0,d=await navigator.clipboard.readText())};h.i&&(d=h.i.split("://")[1]?h.i.split("://")[1]:h.i),h.o&&(w=h.o.split("://")[1]?h.o.split("://")[1]:h.o);function v(){d=this.value,c(0,d)}function P(){w=this.value,c(1,w)}const M=()=>window.location.href="/#/home";return a.$$set=F=>{"params"in F&&c(5,h=F.params)},[d,w,C,_,B,h,v,P,M]}class d0 extends _t{constructor(s){super(),It(this,s,h0,f0,Et,{params:5})}}function g0(a){let s,c;return s=new sl({props:{routes:{"/":Ei,"/home/":Ei,"/home/":Ei,"/new/:where/:lnurl":Al,"/payment/:invoice/:sats/:record":u0,"/nfc/:save?":ca,"/nfcout/:record":t0,"/qr/:save?":r1,"/qrout/:record":Z1,"/manual/:record?/:title?/:shorted?":ga,"/manage/:record":Pa,"/keys":i0,"/lnurl/:io?/:text?":l0,"/shorter/:i?/:o?":d0,"*":fa}}}),{c(){Rt(s.$$.fragment)},m(f,h){Ct(s,f,h),c=!0},p:_e,i(f){c||(He(s.$$.fragment,f),c=!0)},o(f){Ye(s.$$.fragment,f),c=!1},d(f){bt(s,f)}}}class x0 extends _t{constructor(s){super(),It(this,s,null,g0,Et,{})}}new x0({target:document.getElementById("app")});
